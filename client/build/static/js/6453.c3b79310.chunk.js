"use strict";(self.webpackChunkSEEDs_v2_0_Client=self.webpackChunkSEEDs_v2_0_Client||[]).push([[6453],{2744:(p,h,b)=>{b.d(h,{v:()=>i});var L=b(37531);function i(p){(null===p||void 0===p?void 0:p.writtenProperties)&&p.writtenProperties.forEach((p=>{let{target:h,propName:b,newOrigin:S}=p;(0,L.H)(h)&&S&&h.originOf(b)!==S&&h.updateOrigin(b,S)}))}},37531:(p,h,b)=>{function i(p){return p&&"getAtOrigin"in p&&"originOf"in p}b.d(h,{H:()=>i})},56453:(p,h,b)=>{b.d(h,{save:()=>re,saveAs:()=>ne});var L=b(16842),S=(b(4180),b(58716)),g=b(26128),A=b(72284),T=b(74629),E=b(77247),x=b(67177);const q="Feature Service",W="feature-layer-utils",Q="".concat(W,"-save"),H="".concat(W,"-save-as");"".concat(W,"-saveall"),"".concat(W,"-saveall-as");function N(p){return{isValid:(0,T.W_)(p)&&("feature"!==p.type||!p.dynamicDataSource),errorMessage:"Feature layer should be a layer or table in a map or feature service"}}function O(p){const h=[],b=[];for(const{layer:L,layerJSON:S}of p)L.isTable?b.push(S):h.push(S);return{layers:h,tables:b}}function U(p){return O([p])}async function j(p,h){return/\/\d+\/?$/.test(p.url)?U(h[0]):F(h,p)}async function F(p,h){if(p.reverse(),!h)return O(p);const b=await async function J(p,h){let b=await p.fetchData("json");if(function M(p){return!!(p&&Array.isArray(p.layers)&&Array.isArray(p.tables))}(b))return b;b||(b={}),function R(p){p.layers||(p.layers=[]),p.tables||(p.tables=[])}(b);const{layer:{url:L,customParameters:S,apiKey:g}}=h[0];return await async function _(p,h,b){const{url:L,customParameters:S,apiKey:g}=h,{serviceJSON:T,layersJSON:x}=await(0,A.Q)(L,{customParameters:S,apiKey:g}),q=z(p.layers,T.layers,b),W=z(p.tables,T.tables,b);p.layers=q.itemResources,p.tables=W.itemResources;const Q=[...q.added,...W.added],H=x?[...x.layers,...x.tables]:[];await async function G(p,h,b,L){const S=await async function k(p){const h=[];p.forEach((p=>{let{type:b}=p;const L=function B(p){let h;switch(p){case"Feature Layer":case"Table":h="FeatureLayer";break;case"Oriented Imagery Layer":h="OrientedImageryLayer";break;case"Catalog Layer":h="CatalogLayer"}return h}(b),S=E.S[L];h.push(S())}));const b=await Promise.all(h),L=new Map;return p.forEach(((p,h)=>{let{type:S}=p;L.set(S,b[h])})),L}(h),g=h.map((p=>{let{id:h,type:g}=p;return new(S.get(g))({url:b,layerId:h,sourceJSON:L.find((p=>{let{id:b}=p;return b===h}))})}));await Promise.allSettled(g.map((p=>p.load()))),g.forEach((h=>{const{layerId:b,loaded:L,defaultPopupTemplate:S}=h;if(!L||null==S)return;const g={id:b,popupInfo:S.toJSON()};"ArcGISFeatureLayer"!==h.operationalLayerType&&(g.layerType=h.operationalLayerType),C(h,g,p)}))}(p,Q,L,H)}(b,{url:null!==L&&void 0!==L?L:"",customParameters:S,apiKey:g},h.map((p=>p.layer.layerId))),b}(h,p);for(const L of p)C(L.layer,L.layerJSON,b);return function D(p,h){const b=[],L=[];for(const{layer:S}of h){const{isTable:p,layerId:h}=S;p?L.push(h):b.push(h)}K(p.layers,b),K(p.tables,L)}(b,p),b}function K(p,h){if(p.length<2)return;const b=[];for(const{id:L}of p)b.push(L);(0,L.aI)(b.sort(Y),h.slice().sort(Y))&&p.sort(((p,b)=>{const L=h.indexOf(p.id),S=h.indexOf(b.id);return L<S?-1:L>S?1:0}))}function Y(p,h){return p<h?-1:p>h?1:0}function z(p,h,b){const S=(0,L.iv)(p,h,((p,h)=>p.id===h.id));p=p.filter((p=>!S.removed.some((h=>h.id===p.id))));const g=S.added;return g.forEach((h=>{let{id:b}=h;p.push({id:b})})),{itemResources:p,added:g.filter((p=>{let{id:h}=p;return!b.includes(h)}))}}function C(p,h,b){p.isTable?V(b.tables,h):V(b.layers,h)}function V(p,h){const b=p.findIndex((p=>{let{id:b}=p;return b===h.id}));-1===b?p.push(h):p[b]=h}async function X(p,h){const{url:b,layerId:L,title:S,fullExtent:A,isTable:T}=p,E=(0,g.qg)(b);h.url="FeatureServer"===(null===E||void 0===E?void 0:E.serverType)?b:"".concat(b,"/").concat(L),h.title||(h.title=S),h.extent=null,T||null==A||(h.extent=await(0,x.sQ)(A)),(0,x.OM)(h,x.mm.METADATA),(0,x.OM)(h,x.mm.MULTI_LAYER),(0,x.LG)(h,x.mm.SINGLE_LAYER),T&&(0,x.LG)(h,x.mm.TABLE)}async function re(p,h){return(0,S.UN)({layer:p,itemType:q,validateLayer:N,createItemData:(p,h)=>j(h,[p]),errorNamePrefix:Q},h)}async function ne(p,h,b){return(0,S.Uh)({layer:p,itemType:q,validateLayer:N,createItemData:(p,h)=>Promise.resolve(U(p)),errorNamePrefix:H,newItem:h,setItemProperties:X},b)}},58716:(p,h,b)=>{b.d(h,{UN:()=>$,Uh:()=>j});var L=b(4180),S=b(2744),g=b(91710),A=b(35799),T=b(67390),E=b(67177),x=b(79566),q=b(63539);async function m(p){const{layer:h,errorNamePrefix:b,validateLayer:S}=p;await h.load(),function l(p,h,b){const S=b(p);if(!S.isValid)throw new L.A("".concat(h,":invalid-parameters"),S.errorMessage,{layer:p})}(h,b,S)}function c(p,h){return"Layer (title: ".concat(p.title,", id: ").concat(p.id,") of type '").concat(p.declaredClass,"' ").concat(h)}function u(p){const{item:h,errorNamePrefix:b,layer:S,validateItem:g}=p;if((0,x.X)(h),function f(p){const{item:h,itemType:b,additionalItemType:S,errorNamePrefix:g,layer:A}=p,T=[b];if(S&&T.push(S),!T.includes(h.type)){const p=T.map((p=>"'".concat(p,"'"))).join(", ");throw new L.A("".concat(g,":portal-item-wrong-type"),'Portal item type should be one of: "'.concat(p,'"'),{item:h,layer:A})}}(p),g){const p=g(h);if(!p.isValid)throw new L.A("".concat(b,":invalid-parameters"),p.errorMessage,{layer:S})}}function d(p){const{layer:h,errorNamePrefix:b}=p,{portalItem:S}=h;if(!S)throw new L.A("".concat(b,":portal-item-not-set"),c(h,"requires the portalItem property to be set"));if(!S.loaded)throw new L.A("".concat(b,":portal-item-not-loaded"),c(h,"cannot be saved to a portal item that does not exist or is inaccessible"));u({...p,item:S})}function y(p){var h,b,L,S;const{newItem:T,itemType:E}=p;let x=A.default.from(T);return x.id&&(x=x.clone(),x.id=null),null!==(b=(h=x).type)&&void 0!==b||(h.type=E),null!==(S=(L=x).portal)&&void 0!==S||(L.portal=g.A.getDefault()),u({...p,item:x}),x}function w(p){return(0,T.m)(p,"portal-item")}async function I(p,h,b){var L,S;"beforeSave"in p&&"function"==typeof p.beforeSave&&await p.beforeSave();const g=p.write({},h);return await Promise.all(null!==(L=null===(S=h.resources)||void 0===S?void 0:S.pendingOperations)&&void 0!==L?L:[]),(0,q.c)(h,{errorName:"layer-write:unsupported"},b),g}function v(p){(0,E.LG)(p,E.mm.JSAPI),p.typeKeywords&&(p.typeKeywords=p.typeKeywords.filter(((p,h,b)=>b.indexOf(p)===h)))}async function $(p,h){const{layer:b,createItemData:L,createJSONContext:g,saveResources:A,supplementalUnsupportedErrors:T}=p;await m(p),d(p);const E=b.portalItem,x=g?g(E):w(E),q=await I(b,x,{...h,supplementalUnsupportedErrors:T}),W=await L({layer:b,layerJSON:q},E);return v(E),await E.update({data:W}),(0,S.v)(x),await(null===A||void 0===A?void 0:A(E,x)),E}async function j(p,h){const{layer:b,createItemData:L,createJSONContext:g,setItemProperties:A,saveResources:T,supplementalUnsupportedErrors:E}=p;await m(p);const x=y(p),q=g?g(x):w(x),W=await I(b,q,{...h,supplementalUnsupportedErrors:E}),Q=await L({layer:b,layerJSON:W},x);return await A(b,x),v(x),await async function P(p,h,b){var L;const S=p.portal;await S.signIn(),await(null===(L=S.user)||void 0===L?void 0:L.addItem({item:p,data:h,folder:null===b||void 0===b?void 0:b.folder}))}(x,Q,h),b.portalItem=x,(0,S.v)(q),await(null===T||void 0===T?void 0:T(x,q)),x}},72284:(p,h,b)=>{b.d(h,{Q:()=>t});var L=b(59741);async function t(p,h){var b;const{loadContext:S,...g}=h||{},A=S?await S.fetchServiceMetadata(p,g):await(0,L.V)(p,g);c(A),n(A);const T={serviceJSON:A};if((null!==(b=A.currentVersion)&&void 0!==b?b:0)<10.5)return T;const E="".concat(p,"/layers"),x=S?await S.fetchServiceMetadata(E,g):await(0,L.V)(E,g);return c(x),n(x),T.layersJSON={layers:x.layers,tables:x.tables},T}function a(p){return"Feature Layer"===p.type||"Oriented Imagery Layer"===p.type}function r(p){return"Table"===p.type}function n(p){var h,b;p.layers=null===(h=p.layers)||void 0===h?void 0:h.filter(a),p.tables=null===(b=p.tables)||void 0===b?void 0:b.filter(r)}function s(p){p.type||(p.type="Feature Layer")}function i(p){p.type||(p.type="Table")}function c(p){var h,b;null!==(h=p.layers)&&void 0!==h&&h.forEach(s),null===(b=p.tables)||void 0===b||b.forEach(i)}},77247:(p,h,b)=>{b.d(h,{S:()=>L});const L={BingMapsLayer:async()=>(await b.e(4502).then(b.bind(b,34502))).default,BuildingSceneLayer:async()=>(await Promise.all([b.e(5658),b.e(6572),b.e(9370),b.e(8910),b.e(1138),b.e(854),b.e(2015),b.e(8769),b.e(5209)]).then(b.bind(b,3005))).default,CatalogLayer:async()=>(await Promise.all([b.e(2050),b.e(4714),b.e(5658),b.e(6523),b.e(4963),b.e(6542),b.e(7373)]).then(b.bind(b,58059))).default,CSVLayer:async()=>(await Promise.all([b.e(5658),b.e(6572),b.e(9370),b.e(8600)]).then(b.bind(b,34239))).default,DimensionLayer:async()=>(await b.e(363).then(b.bind(b,90363))).default,ElevationLayer:async()=>(await b.e(7156).then(b.bind(b,77156))).default,FeatureLayer:async()=>(await Promise.all([b.e(5658),b.e(6572),b.e(9370),b.e(1230)]).then(b.bind(b,9370))).default,GeoJSONLayer:async()=>(await Promise.resolve().then(b.bind(b,23147))).default,GeoRSSLayer:async()=>(await b.e(6735).then(b.bind(b,6735))).default,GroupLayer:async()=>(await b.e(8908).then(b.bind(b,48908))).default,ImageryLayer:async()=>(await Promise.all([b.e(4714),b.e(398),b.e(47),b.e(7758),b.e(1241),b.e(1752)]).then(b.bind(b,19901))).default,ImageryTileLayer:async()=>(await Promise.all([b.e(398),b.e(3804),b.e(47),b.e(7758),b.e(1226),b.e(1241),b.e(3293)]).then(b.bind(b,73293))).default,IntegratedMeshLayer:async()=>(await Promise.all([b.e(854),b.e(9879)]).then(b.bind(b,99879))).default,KMLLayer:async()=>(await b.e(7917).then(b.bind(b,97917))).default,LineOfSightLayer:async()=>(await b.e(5216).then(b.bind(b,95216))).default,LinkChartLayer:async()=>(await Promise.all([b.e(2050),b.e(5004),b.e(2541),b.e(6523),b.e(2214),b.e(9422),b.e(7522)]).then(b.bind(b,49898))).default,MapImageLayer:async()=>(await Promise.all([b.e(2050),b.e(4714),b.e(4963),b.e(2035),b.e(6607)]).then(b.bind(b,66607))).default,MapNotesLayer:async()=>(await Promise.all([b.e(5658),b.e(6572),b.e(9370),b.e(2112)]).then(b.bind(b,77143))).default,MediaLayer:async()=>(await b.e(2662).then(b.bind(b,22662))).default,OGCFeatureLayer:async()=>(await Promise.all([b.e(2050),b.e(5543),b.e(1028)]).then(b.bind(b,91028))).default,OpenStreetMapLayer:async()=>(await b.e(1131).then(b.bind(b,61131))).default,OrientedImageryLayer:async()=>(await Promise.all([b.e(5658),b.e(6572),b.e(9370),b.e(4885)]).then(b.bind(b,1570))).default,PointCloudLayer:async()=>(await Promise.all([b.e(854),b.e(8289)]).then(b.bind(b,58289))).default,RouteLayer:async()=>(await Promise.all([b.e(727),b.e(2088)]).then(b.bind(b,62088))).default,SceneLayer:async()=>(await Promise.all([b.e(9278),b.e(8910),b.e(1138),b.e(854),b.e(148),b.e(2015),b.e(5017),b.e(2664),b.e(8769),b.e(2620)]).then(b.bind(b,82620))).default,StreamLayer:async()=>(await b.e(7619).then(b.bind(b,17619))).default,SubtypeGroupLayer:async()=>(await Promise.all([b.e(5658),b.e(6572),b.e(7036)]).then(b.bind(b,34009))).default,TileLayer:async()=>(await Promise.all([b.e(2050),b.e(4714),b.e(4963),b.e(2035),b.e(590)]).then(b.bind(b,30590))).default,IntegratedMesh3DTilesLayer:async()=>(await b.e(5534).then(b.bind(b,45534))).default,UnknownLayer:async()=>(await b.e(7240).then(b.bind(b,17240))).default,UnsupportedLayer:async()=>(await b.e(9683).then(b.bind(b,69683))).default,VectorTileLayer:async()=>(await Promise.all([b.e(6313),b.e(3299),b.e(358)]).then(b.bind(b,11018))).default,VoxelLayer:async()=>(await Promise.all([b.e(854),b.e(439)]).then(b.bind(b,30439))).default,WFSLayer:async()=>(await Promise.all([b.e(4860),b.e(2777)]).then(b.bind(b,32123))).default,WMSLayer:async()=>(await b.e(5471).then(b.bind(b,95471))).default,WMTSLayer:async()=>(await b.e(402).then(b.bind(b,90402))).default,WebTileLayer:async()=>(await b.e(6464).then(b.bind(b,56464))).default}},67390:(p,h,b)=>{b.d(h,{m:()=>o,v:()=>e});var L=b(4270),S=b(91710);function e(p,h){return{...l(p,h),readResourcePaths:[]}}function o(p,h,b){const S=(0,L.An)(p.itemUrl);return{...l(p,h),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:S?{rootPath:S.path,writtenUrls:[]}:null,resources:b?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function l(p,h){return{origin:h,url:(0,L.An)(p.itemUrl),portal:p.portal||S.A.getDefault(),portalItem:p}}},59741:(p,h,b)=>{b.d(h,{V:()=>t});var L=b(53705);async function t(p,h){const{data:b}=await(0,L.A)(p,{responseType:"json",query:{f:"json",...null===h||void 0===h?void 0:h.customParameters,token:null===h||void 0===h?void 0:h.apiKey}});return b}},79566:(p,h,b)=>{b.d(h,{X:()=>i});var L=b(61272),S=b(4180),g=b(56276);function i(p){if(L.A.apiKey&&(0,g.Q)(p.portal.url))throw new S.A("save-api-key-utils:api-key-not-supported","Saving is not supported on ".concat(p.portal.url," when using an api key"))}},63539:(p,h,b)=>{b.d(h,{c:()=>t,d:()=>r});var L=b(4180);async function r(p){const h=[];for(const b of p.allLayers)if("beforeSave"in b&&"function"==typeof b.beforeSave){const p=b.beforeSave();p&&h.push(p)}await Promise.allSettled(h)}const S=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function t(p,h,b){var g;let A=(null!==(g=p.messages)&&void 0!==g?g:[]).filter((p=>{let{type:h}=p;return"error"===h})).map((p=>{let{name:h,message:b,details:S}=p;return new L.A(h,b,S)}));if(p.blockedRelativeUrls&&(A=A.concat(p.blockedRelativeUrls.map((p=>new L.A("url:unsupported","Relative url '".concat(p,"' is not supported")))))),b){const{ignoreUnsupported:p,supplementalUnsupportedErrors:h=[],requiredPropertyChecksDisabled:L}=b;p&&(A=A.filter((p=>{let{name:b}=p;return!(S.has(b)||h.includes(b))}))),L&&(A=A.filter((p=>"web-document-write:property-required"!==p.name)))}if(A.length>0)throw new L.A(h.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:A})}}}]);
//# sourceMappingURL=6453.c3b79310.chunk.js.map