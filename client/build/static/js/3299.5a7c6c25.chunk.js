"use strict";(self.webpackChunkSEEDs_v2_0_Client=self.webpackChunkSEEDs_v2_0_Client||[]).push([[3299],{18971:(e,n,s)=>{s.d(n,{A:()=>t});class t{constructor(e){this._array=[],e<=0&&console.error("strideInBytes must be positive!"),this._stride=e}get array(){return this._array}get index(){return 4*this._array.length/this._stride}get itemSize(){return this._stride}get sizeInBytes(){return 4*this._array.length}reset(){this.array.length=0}toBuffer(){return new Uint32Array(this._array).buffer}static i1616to32(e,n){return 65535&e|n<<16}static i8888to32(e,n,s,o){return 255&e|(255&n)<<8|(255&s)<<16|o<<24}static i8816to32(e,n,s){return 255&e|(255&n)<<8|s<<16}}},89766:(e,n,s)=>{var o,u,p;s.d(n,{$q:()=>p,NP:()=>o,kh:()=>u}),function(e){e[e.FILL=1]="FILL",e[e.LINE=2]="LINE",e[e.SYMBOL=3]="SYMBOL",e[e.CIRCLE=4]="CIRCLE"}(o||(o={})),function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.FILL=1]="FILL",e[e.OUTLINE=2]="OUTLINE",e[e.LINE=3]="LINE",e[e.ICON=4]="ICON",e[e.CIRCLE=5]="CIRCLE",e[e.TEXT=6]="TEXT",e[e.TILEINFO=7]="TILEINFO"}(u||(u={})),function(e){e[e.PAINTER_CHANGED=0]="PAINTER_CHANGED",e[e.LAYOUT_CHANGED=1]="LAYOUT_CHANGED",e[e.LAYER_CHANGED=2]="LAYER_CHANGED",e[e.LAYER_REMOVED=3]="LAYER_REMOVED",e[e.SPRITES_CHANGED=4]="SPRITES_CHANGED"}(p||(p={}))},11278:(e,n,s)=>{s.d(n,{lf:()=>StyleLayer_V,L:()=>StyleLayer_A,A4:()=>StyleLayer_v,aR:()=>StyleLayer_U,e4:()=>StyleLayer_L,tU:()=>StyleLayer_x,V1:()=>StyleLayer_I,uU:()=>StyleLayer_O});var o,u,p=s(88965),y=s(89766),f=s(29457),g=s(18971);!function(e){e[e.R8_SIGNED=0]="R8_SIGNED",e[e.R8_UNSIGNED=1]="R8_UNSIGNED",e[e.R16_SIGNED=2]="R16_SIGNED",e[e.R16_UNSIGNED=3]="R16_UNSIGNED",e[e.R8G8_SIGNED=4]="R8G8_SIGNED",e[e.R8G8_UNSIGNED=5]="R8G8_UNSIGNED",e[e.R16G16_SIGNED=6]="R16G16_SIGNED",e[e.R16G16_UNSIGNED=7]="R16G16_UNSIGNED",e[e.R8G8B8A8_SIGNED=8]="R8G8B8A8_SIGNED",e[e.R8G8B8A8_UNSIGNED=9]="R8G8B8A8_UNSIGNED",e[e.R8G8B8A8_COLOR=10]="R8G8B8A8_COLOR",e[e.R16G16B16A16_DASHARRAY=11]="R16G16B16A16_DASHARRAY",e[e.R16G16B16A16_PATTERN=12]="R16G16B16A16_PATTERN"}(o||(o={})),function(e){e[e.UNIFORM=0]="UNIFORM",e[e.DATA_DRIVEN=1]="DATA_DRIVEN",e[e.INTERPOLATED_DATA_DRIVEN=2]="INTERPOLATED_DATA_DRIVEN",e[e.UNUSED=3]="UNUSED"}(u||(u={}));var m=s(60985),w=s(40332);class r{constructor(e){this._locations=new Map,this._key=e}get key(){return this._key}get type(){return 7&this._key}defines(){return[]}getStride(){return this._layoutInfo||this._buildAttributesInfo(),this._stride}getAttributeLocations(){return 0===this._locations.size&&this._buildAttributesInfo(),this._locations}getLayoutInfo(){return this._layoutInfo||this._buildAttributesInfo(),this._layoutInfo}getEncodingInfos(){return this._propertyEncodingInfo||this._buildAttributesInfo(),this._propertyEncodingInfo}getUniforms(){return this._uniforms||this._buildAttributesInfo(),this._uniforms}getShaderHeader(){return this._shaderHeader||this._buildAttributesInfo(),this._shaderHeader}getShaderMain(){return this._shaderMain||this._buildAttributesInfo(),this._shaderMain}setDataUniforms(e,n,s,o,u){const p=this.getUniforms();for(const y of p){const{name:p,type:f,getValue:g}=y,m=g(s,n,o,u);if(null!==m)switch(f){case"float":e.setUniform1f(p,m);break;case"vec2":e.setUniform2fv(p,m);break;case"vec4":e.setUniform4fv(p,m)}}}encodeAttributes(e,n,s,u){const p=this.attributesInfo(),y=this.getEncodingInfos(),f=[];let g=0,m=0;for(const R of Object.keys(y)){var w;const N=y[R],{type:yt,precisionFactor:_t,isLayout:ft}=p[R],dt=ft?s.getLayoutProperty(R):s.getPaintProperty(R),gt=null===(w=dt.interpolator)||void 0===w?void 0:w.getInterpolationRange(n);let mt=0;for(const s of N){const{offset:p,bufferElementsToAdd:y}=s;if(y>0){for(let e=0;e<y;e++)f.push(0);g+=m,m=s.bufferElementsToAdd}const w=null!==u&&void 0!==u?u:dt.getValue(gt?gt[mt]:n,e);switch(yt){case o.R8_SIGNED:case o.R8_UNSIGNED:f[g]|=this._encodeByte(w*(_t||1),8*p);break;case o.R16_SIGNED:case o.R16_UNSIGNED:f[g]|=this._encodeShort(w*(_t||1),8*p);break;case o.R8G8_SIGNED:case o.R8G8_UNSIGNED:f[g]|=this._encodeByte(w*(_t||1),8*p),f[g]|=this._encodeByte(w*(_t||1),8*p+8);break;case o.R16G16_SIGNED:case o.R16G16_UNSIGNED:f[g]|=this._encodeShort(w*(_t||1),8*p),f[g]|=this._encodeShort(w*(_t||1),8*p+16);break;case o.R8G8B8A8_SIGNED:case o.R8G8B8A8_UNSIGNED:f[g]|=this._encodeByte(w*(_t||1),8*p),f[g]|=this._encodeByte(w*(_t||1),8*p+8),f[g]|=this._encodeByte(w*(_t||1),8*p+16),f[g]|=this._encodeByte(w*(_t||1),8*p+24);break;case o.R8G8B8A8_COLOR:f[g]=this._encodeColor(w);break;case o.R16G16B16A16_DASHARRAY:case o.R16G16B16A16_PATTERN:this._encodePattern(g,f,w);break;default:throw new Error("Unsupported encoding type")}mt++}}return f}getAtributeState(e){let n=0;const s=3+2*e;return n|=this._bit(s),n|=this._bit(s+1)<<1,n}_buildAttributesInfo(){const e=[],n={},s={};let o=-1;const p=this.attributesInfo(),y=this.attributes();let f=-1;for(const m of y){f++;const y=this.getAtributeState(f);if(y===u.UNIFORM||y===u.UNUSED)continue;const g=p[m],w=[];n[m]=w;const R=g.type;for(let n=0;n<y;n++){const{dataType:n,bytesPerElement:u,count:p,normalized:y}=r._encodingInfo[R],f=u*p,g="".concat(n,"-").concat(!0===y);let m=s[g],N=0;if(!m||m.count+p>4)o++,m={dataIndex:o,count:0,offset:0},4!==p&&(s[g]=m),e.push({location:-1,name:"a_data_"+o,count:p,type:n,normalized:y}),N=Math.ceil(Math.max(f/4,1));else{const n=e[m.dataIndex];n.count+=p,N=Math.ceil(Math.max(n.count*u/4,1))-Math.ceil(Math.max(m.offset/4,1))}w.push({dataIndex:m.dataIndex,offset:m.offset,bufferElementsToAdd:N}),m.offset+=f,m.count+=p}}for(const u of e)switch(u.type){case m.pe.BYTE:case m.pe.UNSIGNED_BYTE:u.count=4;break;case m.pe.SHORT:case m.pe.UNSIGNED_SHORT:u.count+=u.count%2}this._buildVertexBufferLayout(e);let g=0;const w=this._layoutInfo.geometry;for(const u of w)this._locations.set(u.name,g++);const R=this._layoutInfo.opacity;if(R)for(const u of R)this._locations.set(u.name,g++);this._buildShaderInfo(e,n),this._propertyEncodingInfo=n}_buildVertexBufferLayout(e){const n={},s=this.geometryInfo();let o=s[0].stride;if(0===e.length)n.geometry=s;else{const u=[];let p=o;for(const n of e)o+=i(n.type)*n.count;for(const e of s)u.push(new w._(e.name,e.count,e.type,e.offset,o,e.normalized));for(const n of e)u.push(new w._(n.name,n.count,n.type,p,o,n.normalized)),p+=i(n.type)*n.count;n.geometry=u}this.opacityInfo()&&(n.opacity=this.opacityInfo()),this._layoutInfo=n,this._stride=o}_buildShaderInfo(e,n){let s="\n",p="\n";const y=[];for(const o of e)s+="attribute ".concat(this._getType(o.count)," ").concat(o.name,";\n");const f=this.attributes(),g=this.attributesInfo();let m=-1;for(const w of f){m++;const{name:e,type:f,precisionFactor:R,isLayout:N}=g[w],yt=R&&1!==R?" * "+1/R:"",{bytesPerElement:_t,count:ft}=r._encodingInfo[f],E=e=>"a_data_".concat(e.dataIndex).concat(a(ft,e.offset,_t));switch(this.getAtributeState(m)){case u.UNIFORM:{const n=this._getType(ft),u="u_".concat(e);y.push({name:u,type:n,getValue:(e,n,s,u)=>{const p=N?e.getLayoutValue(w,n):e.getPaintValue(w,n);if(f===o.R16G16B16A16_DASHARRAY){const s=e.getDashKey(p,e.getLayoutValue("line-cap",n)),o=u.getMosaicItemPosition(s,!1);if(null==o)return null;const{tl:y,br:f}=o;return[y[0],f[1],f[0],y[1]]}if(f===o.R16G16B16A16_PATTERN){const e=u.getMosaicItemPosition(p,!w.includes("line-"));if(null==e)return null;const{tl:n,br:s}=e;return[n[0],s[1],s[0],n[1]]}if(f===o.R8G8B8A8_COLOR){const e=p[3];return[e*p[0],e*p[1],e*p[2],e]}return p}}),s+="uniform ".concat(n," ").concat(u,";\n"),p+="".concat(n," ").concat(e," = ").concat(u,";\n")}break;case u.DATA_DRIVEN:{const s=E(n[w][0]);p+="".concat(this._getType(ft)," ").concat(e," = ").concat(s).concat(yt,";\n")}break;case u.INTERPOLATED_DATA_DRIVEN:{const o="u_t_".concat(e);y.push({name:o,type:"float",getValue:(e,n,s,o)=>(N?e.getLayoutProperty(w):e.getPaintProperty(w)).interpolator.interpolationUniformValue(s,n)}),s+="uniform float ".concat(o,";\n");const u=E(n[w][0]),f=E(n[w][1]);p+="".concat(this._getType(ft)," ").concat(e," = mix(").concat(u).concat(yt,", ").concat(f).concat(yt,", ").concat(o,");\n")}}}this._shaderHeader=s,this._shaderMain=p,this._uniforms=y}_bit(e){return(this._key&1<<e)>>e}_getType(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw new Error("Invalid count")}_encodeColor(e){const n=255*e[3];return g.A.i8888to32(e[0]*n,e[1]*n,e[2]*n,n)}_encodePattern(e,n,s){if(null===s||void 0===s||!s.rect)return;const o=s.rect,u=s.width,p=s.height;n[e]=this._encodeShort(o.x+2,0),n[e]|=this._encodeShort(o.y+2+p,16),n[e+1]=this._encodeShort(o.x+2+u,0),n[e+1]|=this._encodeShort(o.y+2,16)}_encodeByte(e,n){return(255&e)<<n}_encodeShort(e,n){return(65535&e)<<n}}r._encodingInfo={[o.R8_SIGNED]:{dataType:m.pe.BYTE,bytesPerElement:1,count:1,normalized:!1},[o.R8_UNSIGNED]:{dataType:m.pe.UNSIGNED_BYTE,bytesPerElement:1,count:1,normalized:!1},[o.R16_SIGNED]:{dataType:m.pe.SHORT,bytesPerElement:2,count:1,normalized:!1},[o.R16_UNSIGNED]:{dataType:m.pe.UNSIGNED_SHORT,bytesPerElement:2,count:1,normalized:!1},[o.R8G8_SIGNED]:{dataType:m.pe.BYTE,bytesPerElement:1,count:2,normalized:!1},[o.R8G8_UNSIGNED]:{dataType:m.pe.UNSIGNED_BYTE,bytesPerElement:1,count:2,normalized:!1},[o.R16G16_SIGNED]:{dataType:m.pe.SHORT,bytesPerElement:2,count:2,normalized:!1},[o.R16G16_UNSIGNED]:{dataType:m.pe.UNSIGNED_SHORT,bytesPerElement:2,count:2,normalized:!1},[o.R8G8B8A8_SIGNED]:{dataType:m.pe.BYTE,bytesPerElement:1,count:4,normalized:!1},[o.R8G8B8A8_UNSIGNED]:{dataType:m.pe.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!1},[o.R8G8B8A8_COLOR]:{dataType:m.pe.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!0},[o.R16G16B16A16_DASHARRAY]:{dataType:m.pe.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1},[o.R16G16B16A16_PATTERN]:{dataType:m.pe.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1}};const i=e=>{switch(e){case m.pe.FLOAT:case m.pe.INT:case m.pe.UNSIGNED_INT:return 4;case m.pe.SHORT:case m.pe.UNSIGNED_SHORT:return 2;case m.pe.BYTE:case m.pe.UNSIGNED_BYTE:return 1}},a=(e,n,s)=>{const o=n/s;if(1===e)switch(o){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===e)switch(o){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(3===e)switch(o){case 0:return".xyz";case 1:return".yzw"}return""};class T extends r{constructor(e){super(e)}geometryInfo(){return T.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return T.ATTRIBUTES}attributesInfo(){return T.ATTRIBUTES_INFO}}T.ATTRIBUTES=[],T.GEOMETRY_LAYOUT=[new w._("a_pos",2,m.pe.BYTE,0,2)],T.ATTRIBUTES_INFO={};class VTLCircleMaterial_t extends r{constructor(e){super(e)}geometryInfo(){return VTLCircleMaterial_t.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return VTLCircleMaterial_t.ATTRIBUTES}attributesInfo(){return VTLCircleMaterial_t.ATTRIBUTES_INFO}}VTLCircleMaterial_t.ATTRIBUTES=["circle-radius","circle-color","circle-opacity","circle-stroke-width","circle-stroke-color","circle-stroke-opacity","circle-blur"],VTLCircleMaterial_t.GEOMETRY_LAYOUT=[new w._("a_pos",2,m.pe.SHORT,0,4)],VTLCircleMaterial_t.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:o.R8_UNSIGNED},"circle-color":{name:"color",type:o.R8G8B8A8_COLOR},"circle-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:o.R8_UNSIGNED,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:o.R8G8B8A8_COLOR},"circle-stroke-opacity":{name:"stroke_opacity",type:o.R8_UNSIGNED,precisionFactor:100},"circle-blur":{name:"blur",type:o.R8_UNSIGNED,precisionFactor:32}};class l extends r{constructor(e){super(e)}geometryInfo(){return l.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return l.ATTRIBUTES}attributesInfo(){return l.ATTRIBUTES_INFO}}l.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"],l.GEOMETRY_LAYOUT=[new w._("a_pos",2,m.pe.SHORT,0,4)],l.ATTRIBUTES_INFO={"fill-color":{name:"color",type:o.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100},"fill-pattern":{name:"tlbr",type:o.R16G16B16A16_PATTERN,isOptional:!0}};class VTLFillMaterial_T extends r{constructor(e,n){super(e),this._usefillColor=n}geometryInfo(){return VTLFillMaterial_T.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return this._usefillColor?VTLFillMaterial_T.ATTRIBUTES_FILL:VTLFillMaterial_T.ATTRIBUTES_OUTLINE}attributesInfo(){return this._usefillColor?VTLFillMaterial_T.ATTRIBUTES_INFO_FILL:VTLFillMaterial_T.ATTRIBUTES_INFO_OUTLINE}}VTLFillMaterial_T.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"],VTLFillMaterial_T.ATTRIBUTES_FILL=["fill-color","fill-opacity"],VTLFillMaterial_T.GEOMETRY_LAYOUT=[new w._("a_pos",2,m.pe.SHORT,0,8),new w._("a_offset",2,m.pe.BYTE,4,8),new w._("a_xnormal",2,m.pe.BYTE,6,8)],VTLFillMaterial_T.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:o.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100}},VTLFillMaterial_T.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:o.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100}};class VTLLineMaterial_i extends r{constructor(e){super(e)}geometryInfo(){return VTLLineMaterial_i.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return VTLLineMaterial_i.ATTRIBUTES}attributesInfo(){return VTLLineMaterial_i.ATTRIBUTES_INFO}}VTLLineMaterial_i.ATTRIBUTES=["line-blur","line-color","line-gap-width","line-offset","line-opacity","line-width","line-pattern","line-dasharray"],VTLLineMaterial_i.GEOMETRY_LAYOUT=[new w._("a_pos",2,m.pe.SHORT,0,16),new w._("a_extrude_offset",4,m.pe.BYTE,4,16),new w._("a_dir_normal",4,m.pe.BYTE,8,16),new w._("a_accumulatedDistance",2,m.pe.UNSIGNED_SHORT,12,16)],VTLLineMaterial_i.ATTRIBUTES_INFO={"line-width":{name:"width",type:o.R8_UNSIGNED,precisionFactor:2},"line-gap-width":{name:"gap_width",type:o.R8_UNSIGNED,precisionFactor:2},"line-offset":{name:"offset",type:o.R8_SIGNED,precisionFactor:2},"line-color":{name:"color",type:o.R8G8B8A8_COLOR},"line-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100},"line-blur":{name:"blur",type:o.R8_UNSIGNED,precisionFactor:4},"line-pattern":{name:"tlbr",type:o.R16G16B16A16_PATTERN,isOptional:!0},"line-dasharray":{name:"tlbr",type:o.R16G16B16A16_DASHARRAY,isOptional:!0}};const R=[new w._("a_pos",2,m.pe.SHORT,0,16),new w._("a_vertexOffset",2,m.pe.SHORT,4,16),new w._("a_texAngleRange",4,m.pe.UNSIGNED_BYTE,8,16),new w._("a_levelInfo",4,m.pe.UNSIGNED_BYTE,12,16)],N=[new w._("a_opacityInfo",1,m.pe.UNSIGNED_BYTE,0,1)];class VTLSymbolMaterial_i extends r{constructor(e){super(e)}geometryInfo(){return R}opacityInfo(){return N}attributes(){return VTLSymbolMaterial_i.ATTRIBUTES}attributesInfo(){return VTLSymbolMaterial_i.ATTRIBUTES_INFO}}VTLSymbolMaterial_i.ATTRIBUTES=["icon-color","icon-opacity","icon-halo-blur","icon-halo-color","icon-halo-width","icon-size"],VTLSymbolMaterial_i.ATTRIBUTES_INFO={"icon-color":{name:"color",type:o.R8G8B8A8_COLOR},"icon-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:o.R8G8B8A8_COLOR},"icon-halo-width":{name:"halo_width",type:o.R8_UNSIGNED,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:o.R8_UNSIGNED,precisionFactor:4},"icon-size":{name:"size",type:o.R8_UNSIGNED,precisionFactor:32,isLayout:!0}};class c extends r{constructor(e){super(e)}geometryInfo(){return R}opacityInfo(){return N}attributes(){return c.ATTRIBUTES}attributesInfo(){return c.ATTRIBUTES_INFO}}c.ATTRIBUTES=["text-color","text-opacity","text-halo-blur","text-halo-color","text-halo-width","text-size"],c.ATTRIBUTES_INFO={"text-color":{name:"color",type:o.R8G8B8A8_COLOR},"text-opacity":{name:"opacity",type:o.R8_UNSIGNED,precisionFactor:100},"text-halo-color":{name:"halo_color",type:o.R8G8B8A8_COLOR},"text-halo-width":{name:"halo_width",type:o.R8_UNSIGNED,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:o.R8_UNSIGNED,precisionFactor:4},"text-size":{name:"size",type:o.R8_UNSIGNED,isLayout:!0}};var yt=s(22123),_t=s(50352),ft=s(5144),dt=s(49595);const gt={kind:"null"},mt={kind:"number"},vt={kind:"string"},Tt={kind:"boolean"},Et={kind:"color"},wt={kind:"object"},It={kind:"value"};function types_a(e,n){return{kind:"array",itemType:e,n:n}}const Dt=[gt,mt,vt,Tt,Et,wt,types_a(It)];function k(e){if("array"===e.kind){const n=k(e.itemType);return"number"==typeof e.n?"array<".concat(n,", ").concat(e.n,">"):"value"===e.itemType.kind?"array":"array<".concat(n,">")}return e.kind}function types_l(e){if(null===e)return gt;if("string"==typeof e)return vt;if("boolean"==typeof e)return Tt;if("number"==typeof e)return mt;if(e instanceof yt.A)return Et;if(Array.isArray(e)){let n;for(const s of e){const e=types_l(s);if(n){if(n!==e){n=It;break}}else n=e}return types_a(n||It,e.length)}return"object"==typeof e?wt:It}function types_c(e,n){if("array"===n.kind)return"array"===e.kind&&(0===e.n&&"value"===e.itemType.kind||types_c(e.itemType,n.itemType))&&("number"!=typeof n.n||n.n===e.n);if("value"===n.kind)for(const s of Dt)if(types_c(e,s))return!0;return n.kind===e.kind}function d(e){if(null===e)return"";const n=typeof e;return"string"===n?e:"number"===n||"boolean"===n?String(e):e instanceof yt.A?e.toString():JSON.stringify(e)}class _{constructor(e){this._parent=e,this._vars={}}add(e,n){this._vars[e]=n}get(e){return this._vars[e]?this._vars[e]:this._parent?this._parent.get(e):null}}class v{constructor(){this.type=It}static parse(e){if(e.length>1)throw new Error('"id" does not expect arguments');return new v}evaluate(e,n){return null===e||void 0===e?void 0:e.id}}class b{constructor(){this.type=vt}static parse(e){if(e.length>1)throw new Error('"geometry-type" does not expect arguments');return new b}evaluate(e,n){if(!e)return null;switch(e.type){case ft.dC.Point:return"Point";case ft.dC.LineString:return"LineString";case ft.dC.Polygon:return"Polygon";default:return null}}}class expression_d{constructor(){this.type=wt}static parse(e){if(e.length>1)throw new Error('"properties" does not expect arguments');return new expression_d}evaluate(e,n){return null===e||void 0===e?void 0:e.values}}class x{constructor(){this.type=mt}static parse(e){if(e.length>1)throw new Error('"zoom" does not expect arguments');return new x}evaluate(e,n){return n}}class E{constructor(e,n,s){this._lhs=e,this._rhs=n,this._compare=s,this.type=Tt}static parse(e,n,s){if(3!==e.length&&4!==e.length)throw new Error('"'.concat(e[0],'" expects 2 or 3 arguments'));if(4===e.length)throw new Error('"'.concat(e[0],'" collator not supported'));return new E(pt(e[1],n),pt(e[2],n),s)}evaluate(e,n){return this._compare(this._lhs.evaluate(e,n),this._rhs.evaluate(e,n))}}class expression_N{constructor(e){this._arg=e,this.type=Tt}static parse(e,n){if(2!==e.length)throw new Error('"!" expects 1 argument');return new expression_N(pt(e[1],n))}evaluate(e,n){return!this._arg.evaluate(e,n)}}class C{constructor(e){this._args=e,this.type=Tt}static parse(e,n){const s=[];for(let o=1;o<e.length;o++)s.push(pt(e[o],n));return new C(s)}evaluate(e,n){for(const s of this._args)if(!s.evaluate(e,n))return!1;return!0}}class expression_R{constructor(e){this._args=e,this.type=Tt}static parse(e,n){const s=[];for(let o=1;o<e.length;o++)s.push(pt(e[o],n));return new expression_R(s)}evaluate(e,n){for(const s of this._args)if(s.evaluate(e,n))return!0;return!1}}class z{constructor(e){this._args=e,this.type=Tt}static parse(e,n){const s=[];for(let o=1;o<e.length;o++)s.push(pt(e[o],n));return new z(s)}evaluate(e,n){for(const s of this._args)if(s.evaluate(e,n))return!1;return!0}}class I{constructor(e,n,s){this.type=e,this._args=n,this._fallback=s}static parse(e,n,s){if(e.length<4)throw new Error('"case" expects at least 3 arguments');if(e.length%2==1)throw new Error('"case" expects an odd number of arguments');let o;const u=[];for(let y=1;y<e.length-1;y+=2){const p=pt(e[y],n),f=pt(e[y+1],n,s);o||(o=f.type),u.push({condition:p,output:f})}const p=pt(e[e.length-1],n,s);return o||(o=p.type),new I(o,u,p)}evaluate(e,n){for(const s of this._args)if(s.condition.evaluate(e,n))return s.output.evaluate(e,n);return this._fallback.evaluate(e,n)}}class L{constructor(e,n){this.type=e,this._args=n}static parse(e,n){if(e.length<2)throw new Error('"coalesce" expects at least 1 argument');let s;const o=[];for(let u=1;u<e.length;u++){const p=pt(e[u],n);s||(s=p.type),o.push(p)}return new L(s,o)}evaluate(e,n){for(const s of this._args){const o=s.evaluate(e,n);if(null!==o)return o}return null}}class U{constructor(e,n,s,o,u){this.type=e,this._input=n,this._labels=s,this._outputs=o,this._fallback=u}static parse(e,n){if(e.length<3)throw new Error('"match" expects at least 3 arguments');if(e.length%2==0)throw new Error('"case" expects an even number of arguments');let s;const o=pt(e[1],n),u=[],p={};let y;for(let f=2;f<e.length-1;f+=2){let o=e[f];Array.isArray(o)||(o=[o]);for(const e of o){const n=typeof e;if("string"!==n&&"number"!==n)throw new Error('"match" requires string or number literal as labels');if(y){if(n!==y)throw new Error('"match" requires labels to have the same type')}else y=n;p[e]=u.length}const g=pt(e[f+1],n);s||(s=g.type),u.push(g)}return new U(s,o,p,u,pt(e[e.length-1],n))}evaluate(e,n){const s=this._input.evaluate(e,n);return(this._outputs[this._labels[s]]||this._fallback).evaluate(e,n)}}class P{constructor(e,n,s,o,u){this._operator=e,this.type=n,this.interpolation=s,this.input=o,this._stops=u}static parse(e,n,s){const o=e[0];if(e.length<5)throw new Error('"'.concat(o,'" expects at least 4 arguments'));const u=e[1];if(!Array.isArray(u)||0===u.length)throw new Error('"'.concat(u,'" is not a valid interpolation'));switch(u[0]){case"linear":if(1!==u.length)throw new Error("Linear interpolation cannot have parameters");break;case"exponential":if(2!==u.length||"number"!=typeof u[1])throw new Error("Exponential interpolation requires one numeric argument");break;case"cubic-bezier":if(5!==u.length)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(let e=1;e<5;e++){const n=u[e];if("number"!=typeof n||n<0||n>1)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1")}break;default:throw new Error('"'.concat(e[0],'" unknown interpolation type "').concat(u[0],'"'))}if(e.length%2!=1)throw new Error('"'.concat(o,'" expects an even number of arguments'));const p=pt(e[2],n,mt);let y;"interpolate-hcl"===o||"interpolate-lab"===o?y=Et:s&&"value"!==s.kind&&(y=s);const f=[];for(let g=3;g<e.length;g+=2){const s=e[g];if("number"!=typeof s)throw new Error('"'.concat(o,'" requires stop inputs as literal numbers'));if(f.length&&f[f.length-1][0]>=s)throw new Error('"'.concat(o,'" requires strictly ascending stop inputs'));const u=pt(e[g+1],n,y);y||(y=u.type),f.push([s,u])}if(y&&y!==Et&&y!==mt&&("array"!==y.kind||y.itemType!==mt))throw new Error('"'.concat(o,'" cannot interpolate type ').concat(k(y)));return new P(o,y,u,p,f)}evaluate(e,n){const s=this._stops;if(1===s.length)return s[0][1].evaluate(e,n);const o=this.input.evaluate(e,n);if(o<=s[0][0])return s[0][1].evaluate(e,n);if(o>=s[s.length-1][0])return s[s.length-1][1].evaluate(e,n);let u=0;for(;++u<s.length&&!(o<s[u][0]););const p=s[u-1][0],y=s[u][0],g=P.interpolationRatio(this.interpolation,o,p,y),m=s[u-1][1].evaluate(e,n),w=s[u][1].evaluate(e,n);if("interpolate"===this._operator){if("array"===this.type.kind&&Array.isArray(m)&&Array.isArray(w))return m.map(((e,n)=>(0,f.GW)(e,w[n],g)));if("color"===this.type.kind&&m instanceof yt.A&&w instanceof yt.A){const e=new yt.A(m),n=new yt.A(w);return new yt.A([(0,f.GW)(e.r,n.r,g),(0,f.GW)(e.g,n.g,g),(0,f.GW)(e.b,n.b,g),(0,f.GW)(e.a,n.a,g)])}if("number"===this.type.kind&&"number"==typeof m&&"number"==typeof w)return(0,f.GW)(m,w,g);throw new Error('"'.concat(this._operator,'" cannot interpolate type ').concat(k(this.type)))}if("interpolate-hcl"===this._operator){const e=(0,_t.RH)(m),n=(0,_t.RH)(w),s=n.h-e.h,o=(0,_t.$)({h:e.h+g*(s>180||s<-180?s-360*Math.round(s/360):s),c:(0,f.GW)(e.c,n.c,g),l:(0,f.GW)(e.l,n.l,g)});return new yt.A({a:(0,f.GW)(m.a,w.a,g),...o})}if("interpolate-lab"===this._operator){const e=(0,_t.ZD)(m),n=(0,_t.ZD)(w),s=(0,_t.$)({l:(0,f.GW)(e.l,n.l,g),a:(0,f.GW)(e.a,n.a,g),b:(0,f.GW)(e.b,n.b,g)});return new yt.A({a:(0,f.GW)(m.a,w.a,g),...s})}throw new Error('Unexpected operator "'.concat(this._operator,'"'))}interpolationUniformValue(e,n){const s=this._stops;if(1===s.length)return 0;if(e>=s[s.length-1][0])return 0;let o=0;for(;++o<s.length&&!(e<s[o][0]););const u=s[o-1][0],p=s[o][0];return P.interpolationRatio(this.interpolation,n,u,p)}getInterpolationRange(e){const n=this._stops;if(1===n.length){const e=n[0][0];return[e,e]}const s=n[n.length-1][0];if(e>=s)return[s,s];let o=0;for(;++o<n.length&&!(e<n[o][0]););return[n[o-1][0],n[o][0]]}static interpolationRatio(e,n,s,o){let u=0;return"linear"===e[0]?u=P._exponentialInterpolationRatio(n,1,s,o):"exponential"===e[0]?u=P._exponentialInterpolationRatio(n,e[1],s,o):"cubic-bezier"===e[0]&&(u=(0,dt.gb)(e[1],e[2],e[3],e[4])(P._exponentialInterpolationRatio(n,1,s,o),1e-5)),u<0?u=0:u>1&&(u=1),u}static _exponentialInterpolationRatio(e,n,s,o){const u=o-s;if(0===u)return 0;const p=e-s;return 1===n?p/u:(n**p-1)/(n**u-1)}}class S{constructor(e,n,s){this.type=e,this._input=n,this._stops=s}static parse(e,n){if(e.length<5)throw new Error('"step" expects at least 4 arguments');if(e.length%2!=1)throw new Error('"step" expects an even number of arguments');const s=pt(e[1],n,mt);let o;const u=[];u.push([-1/0,pt(e[2],n)]);for(let p=3;p<e.length;p+=2){const s=e[p];if("number"!=typeof s)throw new Error('"step" requires stop inputs as literal numbers');if(u.length&&u[u.length-1][0]>=s)throw new Error('"step" requires strictly ascending stop inputs');const y=pt(e[p+1],n);o||(o=y.type),u.push([s,y])}return new S(o,s,u)}evaluate(e,n){const s=this._stops;if(1===s.length)return s[0][1].evaluate(e,n);const o=this._input.evaluate(e,n);let u=0;for(;++u<s.length&&!(o<s[u][0]););return this._stops[u-1][1].evaluate(e,n)}}class B{constructor(e,n){this.type=e,this._output=n}static parse(e,n,s){if(e.length<4)throw new Error('"let" expects at least 3 arguments');if(e.length%2==1)throw new Error('"let" expects an odd number of arguments');const o=new _(n);for(let p=1;p<e.length-1;p+=2){const s=e[p];if("string"!=typeof s)throw new Error('"let" requires a string to define variable names - found '.concat(s));o.add(s,pt(e[p+1],n))}const u=pt(e[e.length-1],o,s);return new B(u.type,u)}evaluate(e,n){return this._output.evaluate(e,n)}}class expression_T{constructor(e,n){this.type=e,this.output=n}static parse(e,n,s){if(2!==e.length||"string"!=typeof e[1])throw new Error('"var" requires just one literal string argument');const o=n.get(e[1]);if(!o)throw new Error("".concat(e[1],' must be defined before being used in a "var" expression'));return new expression_T(s||It,o)}evaluate(e,n){return this.output.evaluate(e,n)}}class O{constructor(e,n,s){this.type=e,this._index=n,this._array=s}static parse(e,n){if(3!==e.length)throw new Error('"at" expects 2 arguments');const s=pt(e[1],n,mt),o=pt(e[2],n);return new O(o.type.itemType,s,o)}evaluate(e,n){const s=this._index.evaluate(e,n),o=this._array.evaluate(e,n);if(s<0||s>=o.length)throw new Error('"at" index out of bounds');if(s!==Math.floor(s))throw new Error('"at" index must be an integer');return o[s]}}class F{constructor(e,n){this._key=e,this._obj=n,this.type=It}static parse(e,n){let s,o;switch(e.length){case 2:return s=pt(e[1],n),new F(s);case 3:return s=pt(e[1],n),o=pt(e[2],n),new F(s,o);default:throw new Error('"get" expects 1 or 2 arguments')}}evaluate(e,n){const s=this._key.evaluate(e,n);return this._obj?this._obj.evaluate(e,n)[s]:null===e||void 0===e?void 0:e.values[s]}}class G{constructor(e,n){this._key=e,this._obj=n,this.type=Tt}static parse(e,n){let s,o;switch(e.length){case 2:return s=pt(e[1],n),new G(s);case 3:return s=pt(e[1],n),o=pt(e[2],n),new G(s,o);default:throw new Error('"has" expects 1 or 2 arguments')}}evaluate(e,n){const s=this._key.evaluate(e,n);return this._obj?s in this._obj.evaluate(e,n):!(null===e||void 0===e||!e.values[s])}}class V{constructor(e,n){this._key=e,this._vals=n,this.type=Tt}static parse(e,n){if(3!==e.length)throw new Error('"in" expects 2 arguments');return new V(pt(e[1],n),pt(e[2],n))}evaluate(e,n){const s=this._key.evaluate(e,n);return this._vals.evaluate(e,n).includes(s)}}class D{constructor(e,n,s){this._item=e,this._array=n,this._from=s,this.type=mt}static parse(e,n){if(e.length<3||e.length>4)throw new Error('"index-of" expects 3 or 4 arguments');const s=pt(e[1],n),o=pt(e[2],n);if(4===e.length){const u=pt(e[3],n,mt);return new D(s,o,u)}return new D(s,o)}evaluate(e,n){const s=this._item.evaluate(e,n),o=this._array.evaluate(e,n);if(this._from){const u=this._from.evaluate(e,n);if(u!==Math.floor(u))throw new Error('"index-of" index must be an integer');return o.indexOf(s,u)}return o.indexOf(s)}}class H{constructor(e){this._arg=e,this.type=mt}static parse(e,n){if(2!==e.length)throw new Error('"length" expects 2 arguments');const s=pt(e[1],n);return new H(s)}evaluate(e,n){const s=this._arg.evaluate(e,n);if("string"==typeof s)return s.length;if(Array.isArray(s))return s.length;throw new Error('"length" expects string or array')}}class J{constructor(e,n,s,o){this.type=e,this._array=n,this._from=s,this._to=o}static parse(e,n){if(e.length<3||e.length>4)throw new Error('"slice" expects 2 or 3 arguments');const s=pt(e[1],n),o=pt(e[2],n,mt);if(o.type!==mt)throw new Error('"slice" index must return a number');if(4===e.length){const u=pt(e[3],n,mt);if(u.type!==mt)throw new Error('"slice" index must return a number');return new J(s.type,s,o,u)}return new J(s.type,s,o)}evaluate(e,n){const s=this._array.evaluate(e,n);if(!Array.isArray(s)&&"string"!=typeof s)throw new Error('"slice" input must be an array or a string');const o=this._from.evaluate(e,n);if(o<0||o>=s.length)throw new Error('"slice" index out of bounds');if(o!==Math.floor(o))throw new Error('"slice" index must be an integer');if(this._to){const u=this._to.evaluate(e,n);if(u<0||u>=s.length)throw new Error('"slice" index out of bounds');if(u!==Math.floor(u))throw new Error('"slice" index must be an integer');return s.slice(o,u)}return s.slice(o)}}class K{constructor(){this.type=Tt}static parse(e){if(1!==e.length)throw new Error('"has-id" expects no arguments');return new K}evaluate(e,n){return void 0!==(null===e||void 0===e?void 0:e.id)}}class Q{constructor(e,n){this._args=e,this._calculate=n,this.type=mt}static parse(e,n,s){const o=e.slice(1).map((e=>pt(e,n)));return new Q(o,s)}evaluate(e,n){let s;return this._args&&(s=this._args.map((s=>s.evaluate(e,n)))),this._calculate(s)}}class rt{constructor(e,n){this._args=e,this._calculate=n,this.type=mt}static parse(e,n){const s=e.slice(1).map((e=>pt(e,n)));return new rt(s,rt.ops[e[0]])}evaluate(e,n){let s;return this._args&&(s=this._args.map((s=>s.evaluate(e,n)))),this._calculate(s)}}rt.ops={abs:e=>Math.abs(e[0]),acos:e=>Math.acos(e[0]),asin:e=>Math.asin(e[0]),atan:e=>Math.atan(e[0]),ceil:e=>Math.ceil(e[0]),cos:e=>Math.cos(e[0]),e:()=>Math.E,floor:e=>Math.floor(e[0]),ln:e=>Math.log(e[0]),ln2:()=>Math.LN2,log10:e=>Math.log(e[0])/Math.LN10,log2:e=>Math.log(e[0])/Math.LN2,max:e=>Math.max(...e),min:e=>Math.min(...e),pi:()=>Math.PI,round:e=>Math.round(e[0]),sin:e=>Math.sin(e[0]),sqrt:e=>Math.sqrt(e[0]),tan:e=>Math.tan(e[0])};class st{constructor(e){this._args=e,this.type=vt}static parse(e,n){return new st(e.slice(1).map((e=>pt(e,n))))}evaluate(e,n){return this._args.map((s=>s.evaluate(e,n))).join("")}}class nt{constructor(e,n){this._arg=e,this._calculate=n,this.type=vt}static parse(e,n){if(2!==e.length)throw new Error("".concat(e[0]," expects 1 argument"));const s=pt(e[1],n);return new nt(s,nt.ops[e[0]])}evaluate(e,n){return this._calculate(this._arg.evaluate(e,n))}}nt.ops={downcase:e=>e.toLowerCase(),upcase:e=>e.toUpperCase()};class at{constructor(e){this._args=e,this.type=Et}static parse(e,n){if(4!==e.length)throw new Error('"rgb" expects 3 arguments');const s=e.slice(1).map((e=>pt(e,n)));return new at(s)}evaluate(e,n){const s=this._validate(this._args[0].evaluate(e,n)),o=this._validate(this._args[1].evaluate(e,n)),u=this._validate(this._args[2].evaluate(e,n));return new yt.A({r:s,g:o,b:u})}_validate(e){if("number"!=typeof e||e<0||e>255)throw new Error("".concat(e,": invalid color component"));return Math.round(e)}}class ot{constructor(e){this._args=e,this.type=Et}static parse(e,n){if(5!==e.length)throw new Error('"rgba" expects 4 arguments');const s=e.slice(1).map((e=>pt(e,n)));return new ot(s)}evaluate(e,n){const s=this._validate(this._args[0].evaluate(e,n)),o=this._validate(this._args[1].evaluate(e,n)),u=this._validate(this._args[2].evaluate(e,n)),p=this._validateAlpha(this._args[3].evaluate(e,n));return new yt.A({r:s,g:o,b:u,a:p})}_validate(e){if("number"!=typeof e||e<0||e>255)throw new Error("".concat(e,": invalid color component"));return Math.round(e)}_validateAlpha(e){if("number"!=typeof e||e<0||e>1)throw new Error("".concat(e,": invalid alpha color component"));return e}}class it{constructor(e){this._color=e,this.type=types_a(mt,4)}static parse(e,n){if(2!==e.length)throw new Error('"to-rgba" expects 1 argument');const s=pt(e[1],n);return new it(s)}evaluate(e,n){return new yt.A(this._color.evaluate(e,n)).toRgba()}}class lt{constructor(e,n){this.type=e,this._args=n}static parse(e,n){const s=e[0];if(e.length<2)throw new Error("".concat(s," expects at least one argument"));let o,u=1;if("array"===s){if(e.length>2){switch(e[1]){case"string":o=vt;break;case"number":o=mt;break;case"boolean":o=Tt;break;default:throw new Error('"array" type argument must be string, number or boolean')}u++}else o=It;let n;if(e.length>3){if(n=e[2],null!==n&&("number"!=typeof n||n<0||n!==Math.floor(n)))throw new Error('"array" length argument must be a positive integer literal');u++}o=types_a(o,n)}else switch(s){case"string":o=vt;break;case"number":o=mt;break;case"boolean":o=Tt;break;case"object":o=wt}const p=[];for(;u<e.length;u++){const s=pt(e[u],n);p.push(s)}return new lt(o,p)}evaluate(e,n){let s;for(const o of this._args){const u=o.evaluate(e,n);if(s=types_l(u),types_c(s,this.type))return u}throw new Error("Expected ".concat(k(this.type)," but got ").concat(k(s)))}}class ut{constructor(e,n){this.type=e,this._args=n}static parse(e,n){const s=e[0],o=ut.types[s];if(o===Tt||o===vt){if(2!==e.length)throw new Error("".concat(s," expects one argument"))}else if(e.length<2)throw new Error("".concat(s," expects at least one argument"));const u=[];for(let p=1;p<e.length;p++){const s=pt(e[p],n);u.push(s)}return new ut(o,u)}evaluate(e,n){if(this.type===Tt)return Boolean(this._args[0].evaluate(e,n));if(this.type===vt)return d(this._args[0].evaluate(e,n));if(this.type===mt){for(const s of this._args){const o=Number(s.evaluate(e,n));if(!isNaN(o))return o}return null}if(this.type===Et){for(const s of this._args)try{const o=ut.toColor(s.evaluate(e,n));if(o instanceof yt.A)return o}catch{}return null}}static toBoolean(e){return Boolean(e)}static toString(e){return d(e)}static toNumber(e){const n=Number(e);if(isNaN(n))throw new Error('"'.concat(e,'" is not a number'));return n}static toColor(e){if(e instanceof yt.A)return e;if("string"==typeof e){const n=yt.A.fromString(e);if(n)return n;throw new Error('"'.concat(e,'" is not a color'))}if(Array.isArray(e))return yt.A.fromArray(e);throw new Error('"'.concat(e,'" is not a color'))}}ut.types={"to-boolean":Tt,"to-color":Et,"to-number":mt,"to-string":vt};class ct{constructor(e){this._val=e,this.type=types_l(e)}static parse(e){if(2!==e.length)throw new Error('"literal" expects 1 argument');return new ct(e[1])}evaluate(e,n){return this._val}}class ht{constructor(e){this._arg=e,this.type=vt}static parse(e,n){if(2!==e.length)throw new Error('"typeof" expects 1 argument');return new ht(pt(e[1],n))}evaluate(e,n){return k(types_l(this._arg.evaluate(e,n)))}}function pt(e,n,s){const o=typeof e;if("string"===o||"boolean"===o||"number"===o||null===e){if(s)switch(s.kind){case"string":"string"!==o&&(e=ut.toString(e));break;case"number":"number"!==o&&(e=ut.toNumber(e));break;case"color":e=ut.toColor(e)}e=["literal",e]}if(!Array.isArray(e)||0===e.length)throw new Error("Expression must be a non empty array");const u=e[0];if("string"!=typeof u)throw new Error("First element of expression must be a string");const p=bt[u];if(void 0===p)throw new Error('Invalid expression operator "'.concat(u,'"'));if(!p)throw new Error('Unimplemented expression operator "'.concat(u,'"'));return p.parse(e,n,s)}const bt={array:lt,boolean:lt,collator:null,format:null,image:null,literal:ct,number:lt,"number-format":null,object:lt,string:lt,"to-boolean":ut,"to-color":ut,"to-number":ut,"to-string":ut,typeof:ht,accumulated:null,"feature-state":null,"geometry-type":b,id:v,"line-progress":null,properties:expression_d,at:O,get:F,has:G,in:V,"index-of":D,length:H,slice:J,"!":expression_N,"!=":class M extends E{static parse(e,n){return E.parse(e,n,((e,n)=>e!==n))}},"<":class expression_k extends E{static parse(e,n){return E.parse(e,n,((e,n)=>e<n))}},"<=":class A extends E{static parse(e,n){return E.parse(e,n,((e,n)=>e<=n))}},"==":class $ extends E{static parse(e,n){return E.parse(e,n,((e,n)=>e===n))}},">":class j extends E{static parse(e,n){return E.parse(e,n,((e,n)=>e>n))}},">=":class q extends E{static parse(e,n){return E.parse(e,n,((e,n)=>e>=n))}},all:C,any:expression_R,case:I,coalesce:L,match:U,within:null,interpolate:P,"interpolate-hcl":P,"interpolate-lab":P,step:S,let:B,var:expression_T,concat:st,downcase:nt,"is-supported-script":null,"resolved-locale":null,upcase:nt,rgb:at,rgba:ot,"to-rgba":it,"-":class W extends Q{static parse(e,n){switch(e.length){case 2:return Q.parse(e,n,(e=>-e[0]));case 3:return Q.parse(e,n,(e=>e[0]-e[1]));default:throw new Error('"-" expects 1 or 2 arguments')}}},"*":class X extends Q{static parse(e,n){return Q.parse(e,n,(e=>{let n=1;for(const s of e)n*=s;return n}))}},"/":class Y extends Q{static parse(e,n){if(3===e.length)return Q.parse(e,n,(e=>e[0]/e[1]));throw new Error('"/" expects 2 arguments')}},"%":class Z extends Q{static parse(e,n){if(3===e.length)return Q.parse(e,n,(e=>e[0]%e[1]));throw new Error('"%" expects 2 arguments')}},"^":class tt extends Q{static parse(e,n){if(3===e.length)return Q.parse(e,n,(e=>e[0]**e[1]));throw new Error('"^" expects 1 or 2 arguments')}},"+":class et extends Q{static parse(e,n){return Q.parse(e,n,(e=>{let n=0;for(const s of e)n+=s;return n}))}},abs:rt,acos:rt,asin:rt,atan:rt,ceil:rt,cos:rt,e:rt,floor:rt,ln:rt,ln2:rt,log10:rt,log2:rt,max:rt,min:rt,pi:rt,round:rt,sin:rt,sqrt:rt,tan:rt,zoom:x,"heatmap-density":null,"has-id":K,none:z};class t{constructor(e){this._expression=e}filter(e,n){if(!this._expression)return!0;try{return this._expression.evaluate(e,n)}catch(t){return console.log(t.message),!0}}static createFilter(e){if(!e)return null;this.isLegacyFilter(e)&&(e=this.convertLegacyFilter(e));try{const n=pt(e,null,Tt);return new t(n)}catch(n){return console.log(n.message),null}}static isLegacyFilter(e){if(!Array.isArray(e))return!0;if(0===e.length)return!0;switch(e[0]){case"==":case"!=":case">":case"<":case">=":case"<=":return 3===e.length&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"in":return e.length>=3&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"!in":case"none":case"!has":return!0;case"any":case"all":for(let n=1;n<e.length;n++)if(this.isLegacyFilter(e[n]))return!0;return!1;case"has":return 2===e.length&&("$id"===e[1]||"$type"===e[1]);default:return!1}}static convertLegacyFilter(e){if(!Array.isArray(e)||0===e.length)return!0;const n=e[0];if(1===e.length)return"any"!==n;switch(n){case"==":return t.convertComparison("==",e[1],e[2]);case"!=":return t.negate(t.convertComparison("==",e[1],e[2]));case">":case"<":case">=":case"<=":return t.convertComparison(n,e[1],e[2]);case"in":return t.convertIn(e[1],e.slice(2));case"!in":return t.negate(t.convertIn(e[1],e.slice(2)));case"any":case"all":case"none":return t.convertCombining(n,e.slice(1));case"has":return t.convertHas(e[1]);case"!has":return t.negate(t.convertHas(e[1]));default:throw new Error("Unexpected legacy filter.")}}static convertComparison(e,n,s){switch(n){case"$type":return[e,["geometry-type"],s];case"$id":return[e,["id"],s];default:return[e,["get",n],s]}}static convertIn(e,n){switch(e){case"$type":return["in",["geometry-type"],["literal",n]];case"$id":return["in",["id"],["literal",n]];default:return["in",["get",e],["literal",n]]}}static convertHas(e){switch(e){case"$type":return!0;case"$id":return["has-id"];default:return["has",e]}}static convertCombining(e,n){return[e].concat(n.map(this.convertLegacyFilter))}static negate(e){return["!",e]}}var Lt=s(4250);class h{constructor(e,n){var s;let o;switch(this.isDataDriven=!1,this.interpolator=null,e.type){case"number":case"color":o=!0;break;case"array":o="number"===e.value;break;default:o=!1}if(null==n&&(n=e.default),Array.isArray(n)&&n.length>0&&bt[n[0]]){const s={number:mt,color:Et,string:vt,boolean:Tt,enum:vt};try{const o=pt(n,null,"array"===e.type?types_a(s[e.value]||It,e.length):s[e.type]);this.getValue=this._buildExpression(o,e),this.isDataDriven=!0,o instanceof P&&o.input instanceof x&&(this.interpolator=o)}catch(p){console.log(p.message),this.getValue=this._buildSimple(e.default)}return}o&&"interval"===n.type&&(o=!1);const u=(null===(s=n)||void 0===s?void 0:s.stops)&&n.stops.length>0;if(u)for(const y of n.stops)y[1]=this._validate(y[1],e);if(this.isDataDriven=!!n&&!!n.property,this.isDataDriven)if(void 0!==n.default&&(n.default=this._validate(n.default,e)),u)switch(n.type){case"identity":this.getValue=this._buildIdentity(n,e);break;case"categorical":this.getValue=this._buildCategorical(n,e);break;default:this.getValue=o?this._buildInterpolate(n,e):this._buildInterval(n,e)}else this.getValue=this._buildIdentity(n,e);else u?this.getValue=o?this._buildZoomInterpolate(n):this._buildZoomInterval(n):(n=this._validate(n,e),this.getValue=this._buildSimple(n))}_validate(e,n){if("number"===n.type){if(null!=n.minimum&&e<n.minimum)return n.minimum;if(null!=n.maximum&&e>n.maximum)return n.maximum}else"color"===n.type?e=h._parseColor(e):"enum"===n.type?"string"==typeof e&&(e=n.values.indexOf(e)):"array"===n.type&&"enum"===n.value?e=e.map((e=>"string"==typeof e?n.values.indexOf(e):e)):"string"===n.type&&(e=d(e));return e}_buildSimple(e){return()=>e}_buildExpression(e,n){return(s,o)=>{try{const u=e.evaluate(o,s);return void 0===u?n.default:this._validate(u,n)}catch(l){return console.log(l.message),n.default}}}_buildIdentity(e,n){return(s,o)=>{let u;return o&&(u=o.values[e.property]),void 0!==u&&(u=this._validate(u,n)),null!=u?u:void 0!==e.default?e.default:n.default}}_buildCategorical(e,n){return(s,o)=>{let u;return o&&(u=o.values[e.property]),u=this._categorical(u,e.stops),void 0!==u?u:void 0!==e.default?e.default:n.default}}_buildInterval(e,n){return(s,o)=>{let u;return o&&(u=o.values[e.property]),"number"==typeof u?this._interval(u,e.stops):void 0!==e.default?e.default:n.default}}_buildInterpolate(e,n){return(s,o)=>{let u;return o&&(u=o.values[e.property]),"number"==typeof u?this._interpolate(u,e.stops,e.base||1):void 0!==e.default?e.default:n.default}}_buildZoomInterpolate(e){return n=>this._interpolate(n,e.stops,e.base||1)}_buildZoomInterval(e){return n=>this._interval(n,e.stops)}_categorical(e,n){const s=n.length;for(let o=0;o<s;o++)if(n[o][0]===e)return n[o][1]}_interval(e,n){const s=n.length;let o=0;for(let u=0;u<s&&n[u][0]<=e;u++)o=u;return n[o][1]}_interpolate(e,n,s){let o,u;const p=n.length;for(let y=0;y<p;y++){const s=n[y];if(!(s[0]<=e)){u=s;break}o=s}if(o&&u){const n=u[0]-o[0],p=e-o[0],y=1===s?p/n:(s**p-1)/(s**n-1);if(Array.isArray(o[1])){const e=o[1],n=u[1],s=[];for(let o=0;o<e.length;o++)s.push((0,f.GW)(e[o],n[o],y));return s}return(0,f.GW)(o[1],u[1],y)}return o?o[1]:u?u[1]:void 0}static _isEmpty(e){for(const n in e)if(e.hasOwnProperty(n))return!1;return!0}static _parseColor(e){return Array.isArray(e)?e:("string"==typeof e&&(e=new yt.A(e)),e instanceof yt.A&&!this._isEmpty(e)?yt.A.toUnitRGBA(e):void 0)}}var Rt=s(80271);var Nt;!function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"}(Nt||(Nt={}));class StyleLayer_L{constructor(e,n,s,o,u,p){this.layer=e,this.feature=n,this.bounds=s,this.normalizationRatio=o,this.normalizationOffsetX=u,this.normalizationOffsetY=p}}class StyleLayer_T{constructor(e,n,s,o){switch(this.type=e,this.typeName=n.type,this.id=n.id,this.source=n.source,this.sourceLayer=n["source-layer"],this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,this.filter=n.filter,this.layout=n.layout,this.paint=n.paint,this.z=s,this.uid=o,e){case Lt.Dc.BACKGROUND:this._layoutDefinition=Lt.$u.backgroundLayoutDefinition,this._paintDefinition=Lt.$u.backgroundPaintDefinition;break;case Lt.Dc.FILL:this._layoutDefinition=Lt.$u.fillLayoutDefinition,this._paintDefinition=Lt.$u.fillPaintDefinition;break;case Lt.Dc.LINE:this._layoutDefinition=Lt.$u.lineLayoutDefinition,this._paintDefinition=Lt.$u.linePaintDefinition;break;case Lt.Dc.SYMBOL:this._layoutDefinition=Lt.$u.symbolLayoutDefinition,this._paintDefinition=Lt.$u.symbolPaintDefinition;break;case Lt.Dc.CIRCLE:this._layoutDefinition=Lt.$u.circleLayoutDefinition,this._paintDefinition=Lt.$u.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}getFeatureFilter(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=t.createFilter(this.filter)}getLayoutProperty(e){return this._layoutProperties[e]}getPaintProperty(e){return this._paintProperties[e]}getLayoutValue(e,n,s){let o;const u=this._layoutProperties[e];return u&&(o=u.getValue(n,s)),void 0===o&&(o=this._layoutDefinition[e].default),o}getPaintValue(e,n,s){let o;const u=this._paintProperties[e];return u&&(o=u.getValue(n,s)),void 0===o&&(o=this._paintDefinition[e].default),o}isPainterDataDriven(){const e=this._paintProperties;if(e)for(const n in e)if(e[n].isDataDriven)return!0;return!1}isIntersectingFeature(e,n,s,o,u,p,y){return!1}getFeatureInflatedBounds(e,n,s,o){return null}_parseLayout(e){const n={};for(const s in e){const o=this._layoutDefinition[s];o&&(n[s]=new h(o,e[s]))}return n}_parsePaint(e){const n={};for(const s in e){const o=this._paintDefinition[s];o&&(n[s]=new h(o,e[s]))}return n}computeAttributesKey(e,n,s,o){let u=0,p=0;for(const y of n){let e=3;if(!y||y!==o){const n=s[y],{isLayout:o,isOptional:u}=n,p=o?this.getLayoutProperty(y):this.getPaintProperty(y);e=null!==p&&void 0!==p&&p.interpolator?2:null!==p&&void 0!==p&&p.isDataDriven?1:u&&!p?3:0}p|=e<<u,u+=2}return p<<3|e}}class StyleLayer_V extends StyleLayer_T{constructor(e,n,s,o){super(e,n,s,o),this.backgroundMaterial=new T(this.computeAttributesKey(y.kh.BACKGROUND,T.ATTRIBUTES,T.ATTRIBUTES_INFO))}}class StyleLayer_v extends StyleLayer_T{constructor(e,n,s,o){super(e,n,s,o);const u=this.getPaintProperty("fill-color"),p=this.getPaintProperty("fill-opacity"),f=this.getPaintProperty("fill-pattern");this.hasDataDrivenColor=null===u||void 0===u?void 0:u.isDataDriven,this.hasDataDrivenOpacity=null===p||void 0===p?void 0:p.isDataDriven,this.hasDataDrivenFill=this.hasDataDrivenColor||this.hasDataDrivenOpacity||(null===f||void 0===f?void 0:f.isDataDriven);const g=this.getPaintProperty("fill-outline-color");this.outlineUsesFillColor=!g,this.hasDataDrivenOutlineColor=null===g||void 0===g?void 0:g.isDataDriven,this.hasDataDrivenOutline=g?g.isDataDriven:!!u&&u.isDataDriven,this.hasDataDrivenOutline=(g?this.hasDataDrivenOutlineColor:this.hasDataDrivenColor)||this.hasDataDrivenOpacity,this.fillMaterial=new l(this.computeAttributesKey(y.kh.FILL,l.ATTRIBUTES,l.ATTRIBUTES_INFO)),this.outlineMaterial=new VTLFillMaterial_T(this.computeAttributesKey(y.kh.OUTLINE,this.outlineUsesFillColor?VTLFillMaterial_T.ATTRIBUTES_FILL:VTLFillMaterial_T.ATTRIBUTES_OUTLINE,this.outlineUsesFillColor?VTLFillMaterial_T.ATTRIBUTES_INFO_FILL:VTLFillMaterial_T.ATTRIBUTES_INFO_OUTLINE),this.outlineUsesFillColor)}getFeatureInflatedBounds(e,n,s,o){const u=StyleLayer_R(e);if(!u)return null;const p=this.getPaintValue("fill-translate",n,e),y=o*Math.max(p[0],p[1]);return u[0]-=y,u[2]-=y,u[1]+=y,u[3]+=y,u}isIntersectingFeature(e,n,s,o,u,p,y){const g=o.getGeometry();if(!g)return!1;const m=8/y.normalizationRatio;e=e/y.normalizationRatio+y.normalizationOffsetX,n=n/y.normalizationRatio+y.normalizationOffsetY;const w=(0,f.yM)(this.getPaintValue("fill-translate",u,o),this.getPaintValue("fill-translate-anchor",u,o),p,8);return e-=m*w.x,n-=m*w.y,!!(0,f.s3)(e,n,g)||(0,f.ru)(e,n,g,m*s)}}class StyleLayer_x extends StyleLayer_T{constructor(e,n,s,o){var u,p,f,g,m,w,R,N,yt;super(e,n,s,o);const _t=this.getPaintProperty("line-pattern");if(this.lineMaterial=new VTLLineMaterial_i(this.computeAttributesKey(y.kh.LINE,VTLLineMaterial_i.ATTRIBUTES,VTLLineMaterial_i.ATTRIBUTES_INFO,_t?"line-dasharray":"")),this.hasDataDrivenLine=(null===(u=this.getPaintProperty("line-blur"))||void 0===u?void 0:u.isDataDriven)||(null===(p=this.getPaintProperty("line-color"))||void 0===p?void 0:p.isDataDriven)||(null===(f=this.getPaintProperty("line-gap-width"))||void 0===f?void 0:f.isDataDriven)||(null===(g=this.getPaintProperty("line-offset"))||void 0===g?void 0:g.isDataDriven)||(null===(m=this.getPaintProperty("line-opacity"))||void 0===m?void 0:m.isDataDriven)||(null===(w=this.getPaintProperty("line-pattern"))||void 0===w?void 0:w.isDataDriven)||(null===(R=this.getPaintProperty("line-dasharray"))||void 0===R?void 0:R.isDataDriven)||(null===(N=this.getLayoutProperty("line-cap"))||void 0===N?void 0:N.isDataDriven)||(null===(yt=this.getPaintProperty("line-width"))||void 0===yt?void 0:yt.isDataDriven),this.canUseThinTessellation=!1,!this.hasDataDrivenLine){const e=this.getPaintProperty("line-width");if(!e||"number"==typeof e&&.5*e<Rt.Gh){const e=this.getPaintProperty("line-offset");(!e||"number"==typeof e&&0===e)&&(this.canUseThinTessellation=!0)}}}getDashKey(e,n){let s;switch(n){case Nt.BUTT:s="Butt";break;case Nt.ROUND:s="Round";break;case Nt.SQUARE:s="Square";break;default:s="Butt"}return"dasharray-[".concat(e.toString(),"]-").concat(s)}getFeatureInflatedBounds(e,n,s,o){const u=StyleLayer_R(e);if(!u)return null;const p=this.getPaintValue("line-translate",n,e),y=o*Math.max(p[0],p[1]);u[0]-=y,u[2]-=y,u[1]+=y,u[3]+=y;const f=o*Math.abs(this.getPaintValue("line-offset",n,e)||0),g=o*(this.getPaintValue("line-width",n,e)/2);return u[0]-=f+g,u[1]-=f+g,u[2]+=f+g,u[3]+=f+g,u}isIntersectingFeature(e,n,s,o,u,p,y){let g=o.getGeometry();if(!g)return!1;const m=8/y.normalizationRatio;e=e/y.normalizationRatio+y.normalizationOffsetX,n=n/y.normalizationRatio+y.normalizationOffsetY;const w=(0,f.yM)(this.getPaintValue("line-translate",u,o),this.getPaintValue("line-translate-anchor",u,o),p,8);e-=m*w.x,n-=m*w.y;const R=m*this.getPaintValue("line-offset",u,o)||0;0!==R&&(g=(0,f.cP)(g,-R));const N=this.getPaintValue("line-width",u,o);return(0,f.ru)(e,n,g,m*(s+N/2))}}class StyleLayer_I extends StyleLayer_T{constructor(e,n,s,o){var u,p,f,g,m,w,R,N,yt,_t,ft,dt;super(e,n,s,o),this.iconMaterial=new VTLSymbolMaterial_i(this.computeAttributesKey(y.kh.ICON,VTLSymbolMaterial_i.ATTRIBUTES,VTLSymbolMaterial_i.ATTRIBUTES_INFO)),this.textMaterial=new c(this.computeAttributesKey(y.kh.TEXT,c.ATTRIBUTES,c.ATTRIBUTES_INFO)),this.hasDataDrivenIcon=(null===(u=this.getPaintProperty("icon-color"))||void 0===u?void 0:u.isDataDriven)||(null===(p=this.getPaintProperty("icon-halo-blur"))||void 0===p?void 0:p.isDataDriven)||(null===(f=this.getPaintProperty("icon-halo-color"))||void 0===f?void 0:f.isDataDriven)||(null===(g=this.getPaintProperty("icon-halo-width"))||void 0===g?void 0:g.isDataDriven)||(null===(m=this.getPaintProperty("icon-opacity"))||void 0===m?void 0:m.isDataDriven)||(null===(w=this.getLayoutProperty("icon-size"))||void 0===w?void 0:w.isDataDriven),this.hasDataDrivenText=(null===(R=this.getPaintProperty("text-color"))||void 0===R?void 0:R.isDataDriven)||(null===(N=this.getPaintProperty("text-halo-blur"))||void 0===N?void 0:N.isDataDriven)||(null===(yt=this.getPaintProperty("text-halo-color"))||void 0===yt?void 0:yt.isDataDriven)||(null===(_t=this.getPaintProperty("text-halo-width"))||void 0===_t?void 0:_t.isDataDriven)||(null===(ft=this.getPaintProperty("text-opacity"))||void 0===ft?void 0:ft.isDataDriven)||(null===(dt=this.getLayoutProperty("text-size"))||void 0===dt?void 0:dt.isDataDriven)}}class StyleLayer_A extends StyleLayer_T{constructor(e,n,s,o){super(e,n,s,o),this.circleMaterial=new VTLCircleMaterial_t(this.computeAttributesKey(y.kh.CIRCLE,VTLCircleMaterial_t.ATTRIBUTES,VTLCircleMaterial_t.ATTRIBUTES_INFO))}getFeatureInflatedBounds(e,n,s,o){const u=StyleLayer_R(e);if(!u)return null;const p=this.getPaintValue("circle-translate",n,e),y=Math.max(p[0],p[1]);u[0]-=y,u[2]-=y,u[1]+=y,u[3]+=y;const f=o*(8*(this.getPaintValue("circle-radius",n,e)+this.getPaintValue("circle-stroke-width",n,e))/2);return u[0]-=f,u[1]-=f,u[2]+=f,u[3]+=f,u}isIntersectingFeature(e,n,s,o,u,p,y){const g=o.getGeometry();if(!g)return!1;const m=8/y.normalizationRatio;e=e/y.normalizationRatio+y.normalizationOffsetX,n=n/y.normalizationRatio+y.normalizationOffsetY,s*=m;const w=(0,f.yM)(this.getPaintValue("circle-translate",u,o),this.getPaintValue("circle-translate-anchor",u,o),p,m),R=m*(this.getPaintValue("circle-radius",u,o)+this.getPaintValue("circle-stroke-width",u,o));let N,yt;for(const f of g)if(f)for(const o of f)if(N=o.x+w.x,yt=o.y+w.y,Math.sqrt((e-N)*(e-N)+(n-yt)*(n-yt))-s<=R)return!0;return!1}}class StyleLayer_U{constructor(e,n,s){var o,u,p,y,f;let g;this.allowOverlap=e.getLayoutValue("icon-allow-overlap",n),this.ignorePlacement=e.getLayoutValue("icon-ignore-placement",n),this.keepUpright=e.getLayoutValue("icon-keep-upright",n),this.optional=e.getLayoutValue("icon-optional",n),this.rotationAlignment=e.getLayoutValue("icon-rotation-alignment",n),this.rotationAlignment===Lt.I5.AUTO&&(this.rotationAlignment=s?Lt.I5.MAP:Lt.I5.VIEWPORT),g=e.getLayoutProperty("icon-anchor"),null!==(o=g)&&void 0!==o&&o.isDataDriven?this._anchorProp=g:this.anchor=e.getLayoutValue("icon-anchor",n),g=e.getLayoutProperty("icon-offset"),null!==(u=g)&&void 0!==u&&u.isDataDriven?this._offsetProp=g:this.offset=e.getLayoutValue("icon-offset",n),g=e.getLayoutProperty("icon-padding"),null!==(p=g)&&void 0!==p&&p.isDataDriven?this._paddingProp=g:this.padding=e.getLayoutValue("icon-padding",n),g=e.getLayoutProperty("icon-rotate"),null!==(y=g)&&void 0!==y&&y.isDataDriven?this._rotateProp=g:this.rotate=e.getLayoutValue("icon-rotate",n),g=e.getLayoutProperty("icon-size"),null!==(f=g)&&void 0!==f&&f.isDataDriven?this._sizeProp=g:this.size=e.getLayoutValue("icon-size",n)}update(e,n){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,n)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,n)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,n)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,n)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,n))}}class StyleLayer_O{constructor(e,n,s){var o,u,p,y,f,g,m,w,R,N,yt;let _t;this.allowOverlap=e.getLayoutValue("text-allow-overlap",n),this.ignorePlacement=e.getLayoutValue("text-ignore-placement",n),this.keepUpright=e.getLayoutValue("text-keep-upright",n),this.optional=e.getLayoutValue("text-optional",n),this.rotationAlignment=e.getLayoutValue("text-rotation-alignment",n),this.rotationAlignment===Lt.I5.AUTO&&(this.rotationAlignment=s?Lt.I5.MAP:Lt.I5.VIEWPORT),_t=e.getLayoutProperty("text-anchor"),null!==(o=_t)&&void 0!==o&&o.isDataDriven?this._anchorProp=_t:this.anchor=e.getLayoutValue("text-anchor",n),_t=e.getLayoutProperty("text-justify"),null!==(u=_t)&&void 0!==u&&u.isDataDriven?this._justifyProp=_t:this.justify=e.getLayoutValue("text-justify",n),_t=e.getLayoutProperty("text-letter-spacing"),null!==(p=_t)&&void 0!==p&&p.isDataDriven?this._letterSpacingProp=_t:this.letterSpacing=e.getLayoutValue("text-letter-spacing",n),_t=e.getLayoutProperty("text-line-height"),null!==(y=_t)&&void 0!==y&&y.isDataDriven?this._lineHeightProp=_t:this.lineHeight=e.getLayoutValue("text-line-height",n),_t=e.getLayoutProperty("text-max-angle"),null!==(f=_t)&&void 0!==f&&f.isDataDriven?this._maxAngleProp=_t:this.maxAngle=e.getLayoutValue("text-max-angle",n),_t=e.getLayoutProperty("text-max-width"),null!==(g=_t)&&void 0!==g&&g.isDataDriven?this._maxWidthProp=_t:this.maxWidth=e.getLayoutValue("text-max-width",n),_t=e.getLayoutProperty("text-offset"),null!==(m=_t)&&void 0!==m&&m.isDataDriven?this._offsetProp=_t:this.offset=e.getLayoutValue("text-offset",n),_t=e.getLayoutProperty("text-padding"),null!==(w=_t)&&void 0!==w&&w.isDataDriven?this._paddingProp=_t:this.padding=e.getLayoutValue("text-padding",n),_t=e.getLayoutProperty("text-rotate"),null!==(R=_t)&&void 0!==R&&R.isDataDriven?this._rotateProp=_t:this.rotate=e.getLayoutValue("text-rotate",n),_t=e.getLayoutProperty("text-size"),null!==(N=_t)&&void 0!==N&&N.isDataDriven?this._sizeProp=_t:this.size=e.getLayoutValue("text-size",n),_t=e.getLayoutProperty("text-writing-mode"),null!==(yt=_t)&&void 0!==yt&&yt.isDataDriven?this._writingModeProp=_t:this.writingMode=e.getLayoutValue("text-writing-mode",n)}update(e,n){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,n)),this._justifyProp&&(this.justify=this._justifyProp.getValue(e,n)),this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(e,n)),this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(e,n)),this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(e,n)),this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(e,n)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,n)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,n)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,n)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,n)),this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(e,n))}}function StyleLayer_R(e){const n=null===e||void 0===e?void 0:e.getGeometry();if(null==n)return null;let s=1/0,o=1/0,u=-1/0,y=-1/0;for(const p of n)if(p)for(const e of p)s=Math.min(s,e.x),o=Math.min(o,e.y),u=Math.max(u,e.x),y=Math.max(y,e.y);return(0,p.fA)(s,o,u,y)}},83299:(e,n,s)=>{s.d(n,{A:()=>l});var o=s(4250),u=s(11278);class l{constructor(e){if(this._style=e,this.backgroundBucketIds=[],this._uidToLayer=new Map,this._layerByName={},this._runningId=0,e.layers||(e.layers=[]),this.version=parseFloat(e.version),this.layers=e.layers.map(((e,n,s)=>this._create(e,n,s))).filter((e=>!!e)),this.layers)for(let n=0;n<this.layers.length;n++){const e=this.layers[n];this._layerByName[e.id]=e,this._uidToLayer.set(e.uid,e),e.type===o.Dc.BACKGROUND&&this.backgroundBucketIds.push(e.id)}this._identifyRefLayers()}isPainterDataDriven(e){const n=this._layerByName[e];return!!n&&n.isPainterDataDriven()}getStyleLayerId(e){return e>=this.layers.length?null:this.layers[e].id}getStyleLayerByUID(e){var n;return null!==(n=this._uidToLayer.get(e))&&void 0!==n?n:null}getStyleLayerIndex(e){const n=this._layerByName[e];return n?this.layers.indexOf(n):-1}setStyleLayer(e,n){if(null===e||void 0===e||!e.id)return;const s=this._style;null!=n&&n>=this.layers.length&&(n=this.layers.length-1);let o,u=!0;const p=this._layerByName[e.id];if(p){const y=this.layers.indexOf(p);n||(n=y),n===y?(u=!1,o=l._recreateLayer(e,p),this.layers[n]=o,s.layers[n]=e):(this.layers.splice(y,1),s.layers.splice(y,1),o=this._create(e,n,this.layers),this.layers.splice(n,0,o),s.layers.splice(n,0,e))}else o=this._create(e,n,this.layers),!n||n>=this.layers.length?(this.layers.push(o),s.layers.push(e)):(this.layers.splice(n,0,o),s.layers.splice(n,0,e));this._layerByName[e.id]=o,this._uidToLayer.set(o.uid,o),u&&this._recomputeZValues(),this._identifyRefLayers()}getStyleLayer(e){const n=this._layerByName[e];return n?{type:n.typeName,id:n.id,source:n.source,"source-layer":n.sourceLayer,minzoom:n.minzoom,maxzoom:n.maxzoom,filter:n.filter,layout:n.layout,paint:n.paint}:null}deleteStyleLayer(e){const n=this._layerByName[e];if(n){delete this._layerByName[e],this._uidToLayer.delete(n.uid);const s=this.layers.indexOf(n);this.layers.splice(s,1),this._style.layers.splice(s,1),this._recomputeZValues(),this._identifyRefLayers()}}getLayerById(e){return this._layerByName[e]}getLayoutProperties(e){const n=this._layerByName[e];return n?n.layout:null}getPaintProperties(e){const n=this._layerByName[e];return n?n.paint:null}setPaintProperties(e,n){const s=this._layerByName[e];if(!s)return;const o={type:s.typeName,id:s.id,source:s.source,"source-layer":s.sourceLayer,minzoom:s.minzoom,maxzoom:s.maxzoom,filter:s.filter,layout:s.layout,paint:n},u=l._recreateLayer(o,s),p=this.layers.indexOf(s);this.layers[p]=u,this._style.layers[p].paint=n,this._layerByName[s.id]=u,this._uidToLayer.set(s.uid,u)}setLayoutProperties(e,n){const s=this._layerByName[e];if(!s)return;const o={type:s.typeName,id:s.id,source:s.source,"source-layer":s.sourceLayer,minzoom:s.minzoom,maxzoom:s.maxzoom,filter:s.filter,layout:n,paint:s.paint},u=l._recreateLayer(o,s),p=this.layers.indexOf(s);this.layers[p]=u,this._style.layers[p].layout=n,this._layerByName[s.id]=u,this._uidToLayer.set(s.uid,u)}setStyleLayerVisibility(e,n){const s=this._layerByName[e];if(!s)return;const o=s.layout||{};o.visibility=n;const u={type:s.typeName,id:s.id,source:s.source,"source-layer":s.sourceLayer,minzoom:s.minzoom,maxzoom:s.maxzoom,filter:s.filter,layout:o,paint:s.paint},p=l._recreateLayer(u,s),y=this.layers.indexOf(s);this.layers[y]=p,this._style.layers[y].layout=o,this._layerByName[s.id]=p,this._uidToLayer.set(s.uid,p)}getStyleLayerVisibility(e){var n;const s=this._layerByName[e];if(!s)return"none";const o=s.layout;return null!==(n=null===o||void 0===o?void 0:o.visibility)&&void 0!==n?n:"visible"}_recomputeZValues(){const e=this.layers,n=1/(e.length+1);for(let s=0;s<e.length;s++)e[s].z=1-(1+s)*n}_identifyRefLayers(){const e=[],n=[];let s=0;for(const y of this.layers){const f=y.layout;if(y.type===o.Dc.FILL){var u;const n=y;let o=y.source+"|"+y.sourceLayer;o+="|"+(null!==(u=null===f||void 0===f?void 0:f.visibility)&&void 0!==u?u:""),o+="|"+y.minzoom,o+="|"+y.maxzoom,o+="|"+JSON.stringify(y.filter),(n.hasDataDrivenFill||n.hasDataDrivenOutline)&&(o+="|"+s),e.push({key:o,layer:y})}else if(y.type===o.Dc.LINE){var p;const e=y,o=y.paint,u=null!=o&&(null!=o["line-pattern"]||null!=o["line-dasharray"]);let g=y.source+"|"+y.sourceLayer;g+="|"+(null!==(p=null===f||void 0===f?void 0:f.visibility)&&void 0!==p?p:""),g+="|"+y.minzoom,g+="|"+y.maxzoom,g+="|"+JSON.stringify(y.filter),g+="|"+(void 0!==f?f["line-cap"]:""),g+="|"+(void 0!==f?f["line-join"]:""),(e.hasDataDrivenLine||u)&&(g+="|"+s),n.push({key:g,layer:y})}++s}this._assignRefLayers(e),this._assignRefLayers(n)}_assignRefLayers(e){let n,s;e.sort(((e,n)=>e.key<n.key?-1:e.key>n.key?1:0));const u=e.length;for(let p=0;p<u;p++){const y=e[p];if(y.key===n)y.layer.refLayerId=s;else if(n=y.key,s=y.layer.id,y.layer.type===o.Dc.FILL){if(!y.layer.getPaintProperty("fill-outline-color"))for(let o=p+1;o<u;o++){const u=e[o];if(u.key!==n)break;if(u.layer.getPaintProperty("fill-outline-color")){e[p]=u,e[o]=y,s=u.layer.id;break}}}else if(y.layer.type===o.Dc.LINE){let o=y.layer;for(let f=p+1;f<u;f++){const u=e[f];if(u.key!==n)break;const g=u.layer;(o.canUseThinTessellation&&!g.canUseThinTessellation||!o.canUseThinTessellation&&(g.getPaintProperty("line-pattern")||g.getPaintProperty("line-dasharray")))&&(o=g,e[p]=u,e[f]=y,s=u.layer.id)}}}}_create(e,n,s){const p=1-(1+n)*(1/(s.length+1)),y=this._runningId++;switch(e.type){case"background":return new u.lf(o.Dc.BACKGROUND,e,p,y);case"fill":return new u.A4(o.Dc.FILL,e,p,y);case"line":return new u.tU(o.Dc.LINE,e,p,y);case"symbol":return new u.V1(o.Dc.SYMBOL,e,p,y);case"raster":return console.warn("Unsupported vector tile raster layer ".concat(e.id)),null;case"circle":return new u.L(o.Dc.CIRCLE,e,p,y)}return null}static _recreateLayer(e,n){switch(e.type){case"background":return new u.lf(o.Dc.BACKGROUND,e,n.z,n.uid);case"fill":return new u.A4(o.Dc.FILL,e,n.z,n.uid);case"line":return new u.tU(o.Dc.LINE,e,n.z,n.uid);case"symbol":return new u.V1(o.Dc.SYMBOL,e,n.z,n.uid);case"raster":return console.warn("Unsupported vector tile raster layer ".concat(e.id)),null;case"circle":return new u.L(o.Dc.CIRCLE,e,n.z,n.uid)}return null}}}}]);
//# sourceMappingURL=3299.5a7c6c25.chunk.js.map