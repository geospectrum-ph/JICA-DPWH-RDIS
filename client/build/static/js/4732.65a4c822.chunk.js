"use strict";(self.webpackChunkSEEDs_v2_0_Client=self.webpackChunkSEEDs_v2_0_Client||[]).push([[4732],{2744:(a,n,s)=>{s.d(n,{v:()=>i});var h=s(37531);function i(a){(null===a||void 0===a?void 0:a.writtenProperties)&&a.writtenProperties.forEach((a=>{let{target:n,propName:s,newOrigin:A}=a;(0,h.H)(n)&&A&&n.originOf(s)!==A&&n.updateOrigin(s,A)}))}},37531:(a,n,s)=>{function i(a){return a&&"getAtOrigin"in a&&"originOf"in a}s.d(n,{H:()=>i})},24732:(a,n,s)=>{s.d(n,{save:()=>g,saveAs:()=>v});var h=s(58716),A=s(67177);const b="Image Service",S="imagery-layer-save",U="imagery-layer-save-as",N="imagery-tile-layer-save",O="imagery-tile-layer-save-as";function c(a){var n;if("imagery"===a.type)return{isValid:!0};const{raster:s}=a,h="Function"===(null===s||void 0===s?void 0:s.datasetFormat)?null===(n=s.primaryRasters)||void 0===n?void 0:n.rasters[0]:s;return{isValid:"RasterTileServer"===(null===h||void 0===h?void 0:h.datasetFormat)&&("Raster"===h.tileType||"Map"===h.tileType),errorMessage:"imagery tile layer should be created from a tiled image service."}}function p(a){const n=a.layerJSON;return Promise.resolve(n&&Object.keys(n).length?n:null)}async function u(a,n){const{parsedUrl:s,title:h,fullExtent:b}=a;n.url=s.path,n.title||(n.title=h);try{n.extent=await(0,A.sQ)(b)}catch{n.extent=void 0}(0,A.OM)(n,A.mm.METADATA),"imagery-tile"===a.type&&(0,A.LG)(n,A.mm.TILED_IMAGERY)}async function g(a,n){const s="imagery"===a.type?S:N;return(0,h.UN)({layer:a,itemType:b,validateLayer:c,createItemData:p,errorNamePrefix:s},n)}async function v(a,n,s){const A="imagery"===a.type?U:O;return(0,h.Uh)({layer:a,itemType:b,validateLayer:c,createItemData:p,errorNamePrefix:A,newItem:n,setItemProperties:u},s)}},58716:(a,n,s)=>{s.d(n,{UN:()=>$,Uh:()=>j});var h=s(4180),A=s(2744),b=s(91710),S=s(35799),U=s(67390),N=s(67177),O=s(79566),E=s(63539);async function m(a){const{layer:n,errorNamePrefix:s,validateLayer:A}=a;await n.load(),function l(a,n,s){const A=s(a);if(!A.isValid)throw new h.A("".concat(n,":invalid-parameters"),A.errorMessage,{layer:a})}(n,s,A)}function c(a,n){return"Layer (title: ".concat(a.title,", id: ").concat(a.id,") of type '").concat(a.declaredClass,"' ").concat(n)}function u(a){const{item:n,errorNamePrefix:s,layer:A,validateItem:b}=a;if((0,O.X)(n),function f(a){const{item:n,itemType:s,additionalItemType:A,errorNamePrefix:b,layer:S}=a,U=[s];if(A&&U.push(A),!U.includes(n.type)){const a=U.map((a=>"'".concat(a,"'"))).join(", ");throw new h.A("".concat(b,":portal-item-wrong-type"),'Portal item type should be one of: "'.concat(a,'"'),{item:n,layer:S})}}(a),b){const a=b(n);if(!a.isValid)throw new h.A("".concat(s,":invalid-parameters"),a.errorMessage,{layer:A})}}function d(a){const{layer:n,errorNamePrefix:s}=a,{portalItem:A}=n;if(!A)throw new h.A("".concat(s,":portal-item-not-set"),c(n,"requires the portalItem property to be set"));if(!A.loaded)throw new h.A("".concat(s,":portal-item-not-loaded"),c(n,"cannot be saved to a portal item that does not exist or is inaccessible"));u({...a,item:A})}function y(a){var n,s,h,A;const{newItem:U,itemType:N}=a;let O=S.default.from(U);return O.id&&(O=O.clone(),O.id=null),null!==(s=(n=O).type)&&void 0!==s||(n.type=N),null!==(A=(h=O).portal)&&void 0!==A||(h.portal=b.A.getDefault()),u({...a,item:O}),O}function w(a){return(0,U.m)(a,"portal-item")}async function I(a,n,s){var h,A;"beforeSave"in a&&"function"==typeof a.beforeSave&&await a.beforeSave();const b=a.write({},n);return await Promise.all(null!==(h=null===(A=n.resources)||void 0===A?void 0:A.pendingOperations)&&void 0!==h?h:[]),(0,E.c)(n,{errorName:"layer-write:unsupported"},s),b}function v(a){(0,N.LG)(a,N.mm.JSAPI),a.typeKeywords&&(a.typeKeywords=a.typeKeywords.filter(((a,n,s)=>s.indexOf(a)===n)))}async function $(a,n){const{layer:s,createItemData:h,createJSONContext:b,saveResources:S,supplementalUnsupportedErrors:U}=a;await m(a),d(a);const N=s.portalItem,O=b?b(N):w(N),E=await I(s,O,{...n,supplementalUnsupportedErrors:U}),x=await h({layer:s,layerJSON:E},N);return v(N),await N.update({data:x}),(0,A.v)(O),await(null===S||void 0===S?void 0:S(N,O)),N}async function j(a,n){const{layer:s,createItemData:h,createJSONContext:b,setItemProperties:S,saveResources:U,supplementalUnsupportedErrors:N}=a;await m(a);const O=y(a),E=b?b(O):w(O),x=await I(s,E,{...n,supplementalUnsupportedErrors:N}),k=await h({layer:s,layerJSON:x},O);return await S(s,O),v(O),await async function P(a,n,s){var h;const A=a.portal;await A.signIn(),await(null===(h=A.user)||void 0===h?void 0:h.addItem({item:a,data:n,folder:null===s||void 0===s?void 0:s.folder}))}(O,k,n),s.portalItem=O,(0,A.v)(E),await(null===U||void 0===U?void 0:U(O,E)),O}},67390:(a,n,s)=>{s.d(n,{m:()=>o,v:()=>e});var h=s(4270),A=s(91710);function e(a,n){return{...l(a,n),readResourcePaths:[]}}function o(a,n,s){const A=(0,h.An)(a.itemUrl);return{...l(a,n),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:A?{rootPath:A.path,writtenUrls:[]}:null,resources:s?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function l(a,n){return{origin:n,url:(0,h.An)(a.itemUrl),portal:a.portal||A.A.getDefault(),portalItem:a}}},79566:(a,n,s)=>{s.d(n,{X:()=>i});var h=s(61272),A=s(4180),b=s(56276);function i(a){if(h.A.apiKey&&(0,b.Q)(a.portal.url))throw new A.A("save-api-key-utils:api-key-not-supported","Saving is not supported on ".concat(a.portal.url," when using an api key"))}},63539:(a,n,s)=>{s.d(n,{c:()=>t,d:()=>r});var h=s(4180);async function r(a){const n=[];for(const s of a.allLayers)if("beforeSave"in s&&"function"==typeof s.beforeSave){const a=s.beforeSave();a&&n.push(a)}await Promise.allSettled(n)}const A=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function t(a,n,s){var b;let S=(null!==(b=a.messages)&&void 0!==b?b:[]).filter((a=>{let{type:n}=a;return"error"===n})).map((a=>{let{name:n,message:s,details:A}=a;return new h.A(n,s,A)}));if(a.blockedRelativeUrls&&(S=S.concat(a.blockedRelativeUrls.map((a=>new h.A("url:unsupported","Relative url '".concat(a,"' is not supported")))))),s){const{ignoreUnsupported:a,supplementalUnsupportedErrors:n=[],requiredPropertyChecksDisabled:h}=s;a&&(S=S.filter((a=>{let{name:s}=a;return!(A.has(s)||n.includes(s))}))),h&&(S=S.filter((a=>"web-document-write:property-required"!==a.name)))}if(S.length>0)throw new h.A(n.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:S})}}}]);
//# sourceMappingURL=4732.65a4c822.chunk.js.map