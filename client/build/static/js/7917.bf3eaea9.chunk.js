"use strict";(self.webpackChunkSEEDs_v2_0_Client=self.webpackChunkSEEDs_v2_0_Client||[]).push([[7917],{97917:(e,s,o)=>{o.r(s),o.d(s,{default:()=>z});var i,l=o(80671),n=(o(30174),o(39652)),a=o(76779),u=o(13132),y=o(81618),p=o(63390),f=o(4270),c=o(57453),v=(o(50886),o(89412),o(76761),o(59299)),m=o(68682),_=o(51715),w=o(98664),M=o(78658),k=o(53200),E=o(1921),x=o(32465),O=o(68777),Z=o(38362),L=o(32277),A=o(73067),F=o(83375),I=o(3616),J=o(4389),C=o(6493),R=o(83810),T=o(84661);let N=i=class extends(A.A.EventedMixin((0,F.Te)(I.A))){constructor(){super(...arguments),this.description=null,this.fullExtent=null,this.id=null,this.networkLink=null,this.parent=null,this.sublayers=null,this.title=null,this.sourceJSON=null,this.layer=null,this.addHandles([(0,p.on)((()=>this.sublayers),"after-add",(e=>{let{item:s}=e;s.parent=this,s.layer=this.layer}),p.OH),(0,p.on)((()=>this.sublayers),"after-remove",(e=>{let{item:s}=e;s.layer=s.parent=null}),p.OH),(0,p.wB)((()=>this.sublayers),((e,s)=>{if(s)for(const o of s)o.layer=o.parent=null;if(e)for(const o of e)o.parent=this,o.layer=this.layer}),p.OH),(0,p.wB)((()=>this.layer),(e=>{if(this.sublayers)for(const s of this.sublayers)s.layer=e}),p.OH)])}initialize(){(0,p.C_)((()=>this.networkLink)).then((()=>(0,p.C_)((()=>!0===this.visible)))).then((()=>this.load()))}load(e){var s,o;if(!this.networkLink)return;if(this.networkLink.viewFormat)return;const l=null!=e?e.signal:null,a=this._fetchService(null!==(s=null===(o=this._get("networkLink"))||void 0===o?void 0:o.href)&&void 0!==s?s:"",l).then((e=>{var s;const o=(0,R.Qm)(e.sublayers);this.fullExtent=T.A.fromJSON(o),this.sourceJSON=e;const l=(0,C.dp)(n.A.ofType(i),(0,R.Jy)(i,e));this.sublayers?this.sublayers.addMany(l):this.sublayers=l,null!==(s=this.layer)&&void 0!==s&&s.emit("sublayer-update"),this.layer&&this.layer.notifyChange("visibleSublayers")}));return this.addResolvingPromise(a),Promise.resolve(this)}get visible(){return this._get("visible")}set visible(e){this._get("visible")!==e&&(this._set("visible",e),this.layer&&this.layer.notifyChange("visibleSublayers"))}readVisible(e,s){return!!s.visibility}_fetchService(e,s){return(0,R.Ox)(e,this.layer.outSpatialReference,this.layer.refreshInterval,s).then((e=>(0,R._4)(e.data)))}};(0,l._)([(0,c.MZ)()],N.prototype,"description",void 0),(0,l._)([(0,c.MZ)({type:T.A})],N.prototype,"fullExtent",void 0),(0,l._)([(0,c.MZ)()],N.prototype,"id",void 0),(0,l._)([(0,c.MZ)({readOnly:!0,value:null})],N.prototype,"networkLink",void 0),(0,l._)([(0,c.MZ)({json:{write:{allowNull:!0}}})],N.prototype,"parent",void 0),(0,l._)([(0,c.MZ)({type:n.A.ofType(N),json:{write:{allowNull:!0}}})],N.prototype,"sublayers",void 0),(0,l._)([(0,c.MZ)({value:null,json:{read:{source:"name",reader:e=>(0,J._e)(e)}}})],N.prototype,"title",void 0),(0,l._)([(0,c.MZ)({value:!0})],N.prototype,"visible",null),(0,l._)([(0,v.w)("visible",["visibility"])],N.prototype,"readVisible",null),(0,l._)([(0,c.MZ)()],N.prototype,"sourceJSON",void 0),(0,l._)([(0,c.MZ)()],N.prototype,"layer",void 0),N=i=(0,l._)([(0,m.$)("esri.layers.support.KMLSublayer")],N);const H=N,K=["kml","xml"];let q=class extends((0,k.d)((0,O.J)((0,Z.j)((0,E.q)((0,x.A)((0,u.P)(M.A))))))){constructor(){super(...arguments),this._visibleFolders=[],this.allSublayers=new a.A({getCollections:()=>[this.sublayers],getChildrenFunction:e=>e.sublayers}),this.outSpatialReference=w.A.WGS84,this.path=null,this.legendEnabled=!1,this.operationalLayerType="KML",this.sublayers=null,this.type="kml",this.url=null}initialize(){this.addHandles([(0,p.wB)((()=>this.sublayers),((e,s)=>{s&&s.forEach((e=>{e.parent=null,e.layer=null})),e&&e.forEach((e=>{e.parent=this,e.layer=this}))}),p.OH),this.on("sublayer-update",(()=>this.notifyChange("fullExtent")))])}normalizeCtorArgs(e,s){return"string"==typeof e?{url:e,...s}:e}readSublayersFromItemOrWebMap(e,s){this._visibleFolders=s.visibleFolders}readSublayers(e,s,o){return(0,R.Jy)(H,s,o,this._visibleFolders)}writeSublayers(e,s){const o=[],i=e.toArray();for(;i.length;){const e=i[0];e.networkLink||(e.visible&&o.push(e.id),e.sublayers&&i.push(...e.sublayers.toArray())),i.shift()}s.visibleFolders=o}get title(){const e=this._get("title");return e&&"defaults"!==this.originOf("title")?e:this.url?(0,f.e7)(this.url,K)||"KML":e||""}set title(e){this._set("title",e)}get visibleSublayers(){const e=this.sublayers,s=[],t=e=>{e.visible&&(s.push(e),e.sublayers&&e.sublayers.forEach(t))};return e&&e.forEach(t),s}get fullExtent(){return this._recomputeFullExtent()}load(e){const s=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["KML"],supportsData:!1},e).catch(y.QP).then((()=>this._fetchService(s)))),Promise.resolve(this)}destroy(){super.destroy(),this.allSublayers.destroy()}async _fetchService(e){const s=await Promise.resolve().then((()=>{var s;return this.resourceInfo?{ssl:!1,data:this.resourceInfo}:(0,R.Ox)(null!==(s=this.url)&&void 0!==s?s:"",this.outSpatialReference,this.refreshInterval,e)})),o=(0,R._4)(s.data);o&&this.read(o,{origin:"service"})}_recomputeFullExtent(){let e=null;null!=this.extent&&(e=this.extent.clone());const r=s=>{if(s.sublayers)for(const o of s.sublayers.items)r(o),o.visible&&o.fullExtent&&(null!=e?e.union(o.fullExtent):e=o.fullExtent.clone())};return r(this),e}};(0,l._)([(0,c.MZ)({readOnly:!0})],q.prototype,"allSublayers",void 0),(0,l._)([(0,c.MZ)({type:w.A})],q.prototype,"outSpatialReference",void 0),(0,l._)([(0,c.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],q.prototype,"path",void 0),(0,l._)([(0,c.MZ)({readOnly:!0,json:{read:!1,write:!1}})],q.prototype,"legendEnabled",void 0),(0,l._)([(0,c.MZ)({type:["show","hide","hide-children"]})],q.prototype,"listMode",void 0),(0,l._)([(0,c.MZ)({type:["KML"]})],q.prototype,"operationalLayerType",void 0),(0,l._)([(0,c.MZ)({})],q.prototype,"resourceInfo",void 0),(0,l._)([(0,c.MZ)({type:n.A.ofType(H),json:{write:{ignoreOrigin:!0}}})],q.prototype,"sublayers",void 0),(0,l._)([(0,v.w)(["web-map","portal-item"],"sublayers",["visibleFolders"])],q.prototype,"readSublayersFromItemOrWebMap",null),(0,l._)([(0,v.w)("service","sublayers",["sublayers"])],q.prototype,"readSublayers",null),(0,l._)([(0,_.K)("sublayers")],q.prototype,"writeSublayers",null),(0,l._)([(0,c.MZ)({readOnly:!0,json:{read:!1}})],q.prototype,"type",void 0),(0,l._)([(0,c.MZ)({json:{origins:{"web-map":{read:{source:"title"}}},write:{ignoreOrigin:!0}}})],q.prototype,"title",null),(0,l._)([(0,c.MZ)(L.OZ)],q.prototype,"url",void 0),(0,l._)([(0,c.MZ)({readOnly:!0})],q.prototype,"visibleSublayers",null),(0,l._)([(0,c.MZ)({type:T.A})],q.prototype,"extent",void 0),(0,l._)([(0,c.MZ)()],q.prototype,"fullExtent",null),q=(0,l._)([(0,m.$)("esri.layers.KMLLayer")],q);const z=q},83810:(e,s,o)=>{o.d(s,{Jy:()=>S,Ox:()=>g,Qm:()=>j,Sp:()=>b,_4:()=>d});var i=o(61272),l=o(50075),n=o(21365),a=o(53705),u=o(66004),y=o(4270),p=o(98664),f=o(21374),c=o(12439),v=o(53440),m=o(94309);const _={esriGeometryPoint:"points",esriGeometryPolyline:"polylines",esriGeometryPolygon:"polygons"};function d(e){var s;const o=e.folders||[],i=o.slice(),l=new Map,n=new Map,a=new Map,y=new Map,p=new Map,f={esriGeometryPoint:n,esriGeometryPolyline:a,esriGeometryPolygon:y};((null===(s=e.featureCollection)||void 0===s?void 0:s.layers)||[]).forEach((e=>{const s=(0,u.o8)(e);s.featureSet.features=[];const o=e.featureSet.geometryType;l.set(o,s);const i=e.layerDefinition.objectIdField;"esriGeometryPoint"===o?h(n,i,e.featureSet.features):"esriGeometryPolyline"===o?h(a,i,e.featureSet.features):"esriGeometryPolygon"===o&&h(y,i,e.featureSet.features)})),e.groundOverlays&&e.groundOverlays.forEach((e=>{p.set(e.id,e)})),o.forEach((s=>{s.networkLinkIds.forEach((o=>{const l=function P(e,s,o){const i=function G(e,s){let o;return s.some((s=>s.id===e&&(o=s,!0))),o}(e,o);return i&&(i.parentFolderId=s,i.networkLink=i),i}(o,s.id,e.networkLinks);l&&i.push(l)}))})),i.forEach((e=>{if(e.featureInfos){e.points=(0,u.o8)(l.get("esriGeometryPoint")),e.polylines=(0,u.o8)(l.get("esriGeometryPolyline")),e.polygons=(0,u.o8)(l.get("esriGeometryPolygon")),e.mapImages=[];for(const o of e.featureInfos)switch(o.type){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryPolygon":{var s;const i=f[o.type].get(o.id);i&&(null===(s=e[_[o.type]])||void 0===s||s.featureSet.features.push(i));break}case"GroundOverlay":{const s=p.get(o.id);s&&e.mapImages.push(s);break}}e.fullExtent=j([e])}}));const c=j(i);return{folders:o,sublayers:i,extent:c}}function g(e,s,o,n){const u=null===l.id||void 0===l.id?void 0:l.id.findCredential(e);e=(0,y.a6)(e,{token:null===u||void 0===u?void 0:u.token});const p=i.A.kmlServiceUrl;return(0,a.A)(p,{query:{url:e,model:"simple",folders:"",refresh:0!==o||void 0,outSR:JSON.stringify(s)},responseType:"json",signal:n})}function S(e,s){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const l=[],n={},a=s.sublayers,u=new Set(s.folders.map((e=>e.id)));return a.forEach((s=>{const a=new e;if(o?a.read(s,o):a.read(s),i.length&&u.has(a.id)&&(a.visible=i.includes(a.id)),n[s.id]=a,null!=s.parentFolderId&&-1!==s.parentFolderId){var y;const e=n[s.parentFolderId];e.sublayers||(e.sublayers=[]),null===(y=e.sublayers)||void 0===y||y.unshift(a)}else l.unshift(a)})),l}function h(e,s,o){o.forEach((o=>{e.set(o.attributes[s],o)}))}async function b(e){const s=m.A.fromJSON(e.featureSet).features,o=e.layerDefinition,i=(0,v.r)(o.drawingInfo.renderer),l=n.A.fromJSON(e.popupInfo),a=[];for(const n of s){const e=await i.getSymbolAsync(n);n.symbol=e,n.popupTemplate=l,n.visible=!0,a.push(n)}return a}function j(e){const s=(0,f.vt)(f.qv),o=(0,f.vt)(f.qv);for(const a of e){var i,l,n;if(null!==(i=a.polygons)&&void 0!==i&&null!==(i=i.featureSet)&&void 0!==i&&i.features)for(const e of a.polygons.featureSet.features)(0,c.LJ)(s,e.geometry),(0,f.RF)(o,s);if(null!==(l=a.polylines)&&void 0!==l&&null!==(l=l.featureSet)&&void 0!==l&&l.features)for(const e of a.polylines.featureSet.features)(0,c.LJ)(s,e.geometry),(0,f.RF)(o,s);if(null!==(n=a.points)&&void 0!==n&&null!==(n=n.featureSet)&&void 0!==n&&n.features)for(const e of a.points.featureSet.features)(0,c.LJ)(s,e.geometry),(0,f.RF)(o,s);if(a.mapImages)for(const e of a.mapImages)(0,c.LJ)(s,e.extent),(0,f.RF)(o,s)}return(0,f.aI)(o,f.qv)?void 0:{xmin:o[0],ymin:o[1],zmin:o[2],xmax:o[3],ymax:o[4],zmax:o[5],spatialReference:p.A.WGS84}}}}]);
//# sourceMappingURL=7917.bf3eaea9.chunk.js.map