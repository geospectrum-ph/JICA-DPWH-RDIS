"use strict";(self.webpackChunkSEEDs_v2_0_Client=self.webpackChunkSEEDs_v2_0_Client||[]).push([[3279],{2744:(a,n,s)=>{s.d(n,{v:()=>i});var h=s(37531);function i(a){(null===a||void 0===a?void 0:a.writtenProperties)&&a.writtenProperties.forEach((a=>{let{target:n,propName:s,newOrigin:g}=a;(0,h.H)(n)&&g&&n.originOf(s)!==g&&n.updateOrigin(s,g)}))}},37531:(a,n,s)=>{function i(a){return a&&"getAtOrigin"in a&&"originOf"in a}s.d(n,{H:()=>i})},93279:(a,n,s)=>{s.d(n,{save:()=>p,saveAs:()=>f});var h=s(58716),g=s(67177);const S="Stream Service",b="Feed",A="stream-layer-save",U="stream-layer-save-as";function u(a){return{isValid:"stream"===a.type&&!!a.url&&!a.webSocketUrl,errorMessage:"Stream layer should be created using a url to a stream service"}}function c(a){const n=a.layerJSON;return Promise.resolve(n&&Object.keys(n).length?n:null)}async function y(a,n){const{parsedUrl:s,title:h,fullExtent:S}=a;n.url=s.path,n.title||(n.title=h),n.extent=null,null!=S&&(n.extent=await(0,g.sQ)(S)),(0,g.OM)(n,g.mm.METADATA),(0,g.LG)(n,g.mm.SINGLE_LAYER)}async function p(a,n){return(0,h.UN)({layer:a,itemType:S,additionalItemType:b,validateLayer:u,createItemData:c,errorNamePrefix:A},n)}async function f(a,n,s){return(0,h.Uh)({layer:a,itemType:S,validateLayer:u,createItemData:c,errorNamePrefix:U,newItem:n,setItemProperties:y},s)}},58716:(a,n,s)=>{s.d(n,{UN:()=>$,Uh:()=>j});var h=s(4180),g=s(2744),S=s(91710),b=s(35799),A=s(67390),U=s(67177),N=s(79566),O=s(63539);async function m(a){const{layer:n,errorNamePrefix:s,validateLayer:g}=a;await n.load(),function l(a,n,s){const g=s(a);if(!g.isValid)throw new h.A("".concat(n,":invalid-parameters"),g.errorMessage,{layer:a})}(n,s,g)}function c(a,n){return"Layer (title: ".concat(a.title,", id: ").concat(a.id,") of type '").concat(a.declaredClass,"' ").concat(n)}function u(a){const{item:n,errorNamePrefix:s,layer:g,validateItem:S}=a;if((0,N.X)(n),function f(a){const{item:n,itemType:s,additionalItemType:g,errorNamePrefix:S,layer:b}=a,A=[s];if(g&&A.push(g),!A.includes(n.type)){const a=A.map((a=>"'".concat(a,"'"))).join(", ");throw new h.A("".concat(S,":portal-item-wrong-type"),'Portal item type should be one of: "'.concat(a,'"'),{item:n,layer:b})}}(a),S){const a=S(n);if(!a.isValid)throw new h.A("".concat(s,":invalid-parameters"),a.errorMessage,{layer:g})}}function d(a){const{layer:n,errorNamePrefix:s}=a,{portalItem:g}=n;if(!g)throw new h.A("".concat(s,":portal-item-not-set"),c(n,"requires the portalItem property to be set"));if(!g.loaded)throw new h.A("".concat(s,":portal-item-not-loaded"),c(n,"cannot be saved to a portal item that does not exist or is inaccessible"));u({...a,item:g})}function y(a){var n,s,h,g;const{newItem:A,itemType:U}=a;let N=b.default.from(A);return N.id&&(N=N.clone(),N.id=null),null!==(s=(n=N).type)&&void 0!==s||(n.type=U),null!==(g=(h=N).portal)&&void 0!==g||(h.portal=S.A.getDefault()),u({...a,item:N}),N}function w(a){return(0,A.m)(a,"portal-item")}async function I(a,n,s){var h,g;"beforeSave"in a&&"function"==typeof a.beforeSave&&await a.beforeSave();const S=a.write({},n);return await Promise.all(null!==(h=null===(g=n.resources)||void 0===g?void 0:g.pendingOperations)&&void 0!==h?h:[]),(0,O.c)(n,{errorName:"layer-write:unsupported"},s),S}function v(a){(0,U.LG)(a,U.mm.JSAPI),a.typeKeywords&&(a.typeKeywords=a.typeKeywords.filter(((a,n,s)=>s.indexOf(a)===n)))}async function $(a,n){const{layer:s,createItemData:h,createJSONContext:S,saveResources:b,supplementalUnsupportedErrors:A}=a;await m(a),d(a);const U=s.portalItem,N=S?S(U):w(U),O=await I(s,N,{...n,supplementalUnsupportedErrors:A}),E=await h({layer:s,layerJSON:O},U);return v(U),await U.update({data:E}),(0,g.v)(N),await(null===b||void 0===b?void 0:b(U,N)),U}async function j(a,n){const{layer:s,createItemData:h,createJSONContext:S,setItemProperties:b,saveResources:A,supplementalUnsupportedErrors:U}=a;await m(a);const N=y(a),O=S?S(N):w(N),E=await I(s,O,{...n,supplementalUnsupportedErrors:U}),k=await h({layer:s,layerJSON:E},N);return await b(s,N),v(N),await async function P(a,n,s){var h;const g=a.portal;await g.signIn(),await(null===(h=g.user)||void 0===h?void 0:h.addItem({item:a,data:n,folder:null===s||void 0===s?void 0:s.folder}))}(N,k,n),s.portalItem=N,(0,g.v)(O),await(null===A||void 0===A?void 0:A(N,O)),N}},67390:(a,n,s)=>{s.d(n,{m:()=>o,v:()=>e});var h=s(4270),g=s(91710);function e(a,n){return{...l(a,n),readResourcePaths:[]}}function o(a,n,s){const g=(0,h.An)(a.itemUrl);return{...l(a,n),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:g?{rootPath:g.path,writtenUrls:[]}:null,resources:s?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function l(a,n){return{origin:n,url:(0,h.An)(a.itemUrl),portal:a.portal||g.A.getDefault(),portalItem:a}}},79566:(a,n,s)=>{s.d(n,{X:()=>i});var h=s(61272),g=s(4180),S=s(56276);function i(a){if(h.A.apiKey&&(0,S.Q)(a.portal.url))throw new g.A("save-api-key-utils:api-key-not-supported","Saving is not supported on ".concat(a.portal.url," when using an api key"))}},63539:(a,n,s)=>{s.d(n,{c:()=>t,d:()=>r});var h=s(4180);async function r(a){const n=[];for(const s of a.allLayers)if("beforeSave"in s&&"function"==typeof s.beforeSave){const a=s.beforeSave();a&&n.push(a)}await Promise.allSettled(n)}const g=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function t(a,n,s){var S;let b=(null!==(S=a.messages)&&void 0!==S?S:[]).filter((a=>{let{type:n}=a;return"error"===n})).map((a=>{let{name:n,message:s,details:g}=a;return new h.A(n,s,g)}));if(a.blockedRelativeUrls&&(b=b.concat(a.blockedRelativeUrls.map((a=>new h.A("url:unsupported","Relative url '".concat(a,"' is not supported")))))),s){const{ignoreUnsupported:a,supplementalUnsupportedErrors:n=[],requiredPropertyChecksDisabled:h}=s;a&&(b=b.filter((a=>{let{name:s}=a;return!(g.has(s)||n.includes(s))}))),h&&(b=b.filter((a=>"web-document-write:property-required"!==a.name)))}if(b.length>0)throw new h.A(n.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:b})}}}]);
//# sourceMappingURL=3279.d23a4c40.chunk.js.map