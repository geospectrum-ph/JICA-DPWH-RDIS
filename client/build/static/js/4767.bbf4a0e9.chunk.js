"use strict";(self.webpackChunkSEEDs_v2_0_Client=self.webpackChunkSEEDs_v2_0_Client||[]).push([[4767,9946],{2744:(s,g,b)=>{b.d(g,{v:()=>i});var A=b(37531);function i(s){(null===s||void 0===s?void 0:s.writtenProperties)&&s.writtenProperties.forEach((s=>{let{target:g,propName:b,newOrigin:S}=s;(0,A.H)(g)&&S&&g.originOf(b)!==S&&g.updateOrigin(b,S)}))}},37531:(s,g,b)=>{function i(s){return s&&"getAtOrigin"in s&&"originOf"in s}b.d(g,{H:()=>i})},24767:(s,g,b)=>{b.d(g,{save:()=>d,saveAs:()=>v});var A=b(58716),S=b(67390),U=b(67177),R=b(17280);const O="Media Layer",x="media-layer-save",N="media-layer-save-as",E=["media-layer:unsupported-source"];function m(s){return{isValid:"media"===s.type,errorMessage:"Layer.type should be 'media'"}}function c(s){return(0,S.m)(s,"portal-item",!0)}function y(s){return s.layerJSON}async function f(s,g){const{title:b,fullExtent:A}=s;g.title||(g.title=b),g.extent=A?await(0,U.sQ)(A):null,(0,U.OM)(g,U.mm.METADATA)}async function d(s,g){return(0,A.UN)({layer:s,itemType:O,validateLayer:m,createJSONContext:s=>c(s),createItemData:y,errorNamePrefix:x,supplementalUnsupportedErrors:E,saveResources:(g,b)=>(0,R.r)(s.resourceReferences,b)},g)}async function v(s,g,b){return(0,A.Uh)({layer:s,itemType:O,validateLayer:m,createJSONContext:s=>c(s),createItemData:y,errorNamePrefix:N,supplementalUnsupportedErrors:E,newItem:g,setItemProperties:f,saveResources:(g,b)=>(0,R.r)(s.resourceReferences,b)},b)}},58716:(s,g,b)=>{b.d(g,{UN:()=>$,Uh:()=>j});var A=b(4180),S=b(2744),U=b(91710),R=b(35799),O=b(67390),x=b(67177),N=b(79566),E=b(63539);async function m(s){const{layer:g,errorNamePrefix:b,validateLayer:S}=s;await g.load(),function l(s,g,b){const S=b(s);if(!S.isValid)throw new A.A("".concat(g,":invalid-parameters"),S.errorMessage,{layer:s})}(g,b,S)}function c(s,g){return"Layer (title: ".concat(s.title,", id: ").concat(s.id,") of type '").concat(s.declaredClass,"' ").concat(g)}function u(s){const{item:g,errorNamePrefix:b,layer:S,validateItem:U}=s;if((0,N.X)(g),function f(s){const{item:g,itemType:b,additionalItemType:S,errorNamePrefix:U,layer:R}=s,O=[b];if(S&&O.push(S),!O.includes(g.type)){const s=O.map((s=>"'".concat(s,"'"))).join(", ");throw new A.A("".concat(U,":portal-item-wrong-type"),'Portal item type should be one of: "'.concat(s,'"'),{item:g,layer:R})}}(s),U){const s=U(g);if(!s.isValid)throw new A.A("".concat(b,":invalid-parameters"),s.errorMessage,{layer:S})}}function d(s){const{layer:g,errorNamePrefix:b}=s,{portalItem:S}=g;if(!S)throw new A.A("".concat(b,":portal-item-not-set"),c(g,"requires the portalItem property to be set"));if(!S.loaded)throw new A.A("".concat(b,":portal-item-not-loaded"),c(g,"cannot be saved to a portal item that does not exist or is inaccessible"));u({...s,item:S})}function y(s){var g,b,A,S;const{newItem:O,itemType:x}=s;let N=R.default.from(O);return N.id&&(N=N.clone(),N.id=null),null!==(b=(g=N).type)&&void 0!==b||(g.type=x),null!==(S=(A=N).portal)&&void 0!==S||(A.portal=U.A.getDefault()),u({...s,item:N}),N}function w(s){return(0,O.m)(s,"portal-item")}async function I(s,g,b){var A,S;"beforeSave"in s&&"function"==typeof s.beforeSave&&await s.beforeSave();const U=s.write({},g);return await Promise.all(null!==(A=null===(S=g.resources)||void 0===S?void 0:S.pendingOperations)&&void 0!==A?A:[]),(0,E.c)(g,{errorName:"layer-write:unsupported"},b),U}function v(s){(0,x.LG)(s,x.mm.JSAPI),s.typeKeywords&&(s.typeKeywords=s.typeKeywords.filter(((s,g,b)=>b.indexOf(s)===g)))}async function $(s,g){const{layer:b,createItemData:A,createJSONContext:U,saveResources:R,supplementalUnsupportedErrors:O}=s;await m(s),d(s);const x=b.portalItem,N=U?U(x):w(x),E=await I(b,N,{...g,supplementalUnsupportedErrors:O}),k=await A({layer:b,layerJSON:E},x);return v(x),await x.update({data:k}),(0,S.v)(N),await(null===R||void 0===R?void 0:R(x,N)),x}async function j(s,g){const{layer:b,createItemData:A,createJSONContext:U,setItemProperties:R,saveResources:O,supplementalUnsupportedErrors:x}=s;await m(s);const N=y(s),E=U?U(N):w(N),k=await I(b,E,{...g,supplementalUnsupportedErrors:x}),L=await A({layer:b,layerJSON:k},N);return await R(b,N),v(N),await async function P(s,g,b){var A;const S=s.portal;await S.signIn(),await(null===(A=S.user)||void 0===A?void 0:A.addItem({item:s,data:g,folder:null===b||void 0===b?void 0:b.folder}))}(N,L,g),b.portalItem=N,(0,S.v)(E),await(null===O||void 0===O?void 0:O(N,E)),N}},67390:(s,g,b)=>{b.d(g,{m:()=>o,v:()=>e});var A=b(4270),S=b(91710);function e(s,g){return{...l(s,g),readResourcePaths:[]}}function o(s,g,b){const S=(0,A.An)(s.itemUrl);return{...l(s,g),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:S?{rootPath:S.path,writtenUrls:[]}:null,resources:b?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function l(s,g){return{origin:g,url:(0,A.An)(s.itemUrl),portal:s.portal||S.A.getDefault(),portalItem:s}}},49946:(s,g,b)=>{b.d(g,{addOrUpdateResources:()=>a,bg:()=>m,cL:()=>p,fetchResources:()=>o,removeAllResources:()=>c,removeResource:()=>n});var A=b(53705),S=b(4180),U=b(4270);async function o(s){let g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},b=arguments.length>2?arguments[2]:void 0;await s.load(b);const A=(0,U.fj)(s.itemUrl,"resources"),{start:S=1,num:R=10,sortOrder:O="asc",sortField:x="resource"}=g,N={query:{start:S,num:R,sortOrder:O,sortField:x,token:s.apiKey},signal:null===b||void 0===b?void 0:b.signal},E=await s.portal.request(A,N);return{total:E.total,nextStart:E.nextStart,resources:E.resources.map((g=>{let{created:b,size:A,resource:S}=g;return{created:new Date(b),size:A,resource:s.resourceFromPath(S)}}))}}async function a(s,g,b,A){const R=new Map;for(const{resource:U,content:x,compress:N,access:E}of g){if(!U.hasPath())throw new S.A("portal-item-resource-".concat(b,":invalid-path"),"Resource does not have a valid path");const[s,g]=l(U.path),A="".concat(s,"/").concat(null!==N&&void 0!==N?N:"","/").concat(null!==E&&void 0!==E?E:"");R.has(A)||R.set(A,{prefix:s,compress:N,access:E,files:[]}),R.get(A).files.push({fileName:g,content:x})}await s.load(A);const O=(0,U.fj)(s.userItemUrl,"add"===b?"addResources":"updateResources");for(const{prefix:S,compress:U,access:x,files:N}of R.values()){const g=25;for(let b=0;b<N.length;b+=g){const R=N.slice(b,b+g),E=new FormData;S&&"."!==S&&E.append("resourcesPrefix",S),U&&E.append("compress","true"),x&&E.append("access",x);let k=0;for(const{fileName:s,content:g}of R)E.append("file"+ ++k,g,s);E.append("f","json"),await s.portal.request(O,{method:"post",body:E,signal:null===A||void 0===A?void 0:A.signal})}}}async function n(s,g,b){if(!g.hasPath())throw new S.A("portal-item-resources-remove:invalid-path","Resource does not have a valid path");await s.load(b);const A=(0,U.fj)(s.userItemUrl,"removeResources");await s.portal.request(A,{method:"post",query:{resource:g.path},signal:null===b||void 0===b?void 0:b.signal}),g.portalItem=null}async function c(s,g){await s.load(g);const b=(0,U.fj)(s.userItemUrl,"removeResources");return s.portal.request(b,{method:"post",query:{deleteAll:!0},signal:null===g||void 0===g?void 0:g.signal})}function l(s){const g=s.lastIndexOf("/");return-1===g?[".",s]:[s.slice(0,g),s.slice(g+1)]}function i(s){const[g,b]=function u(s){const g=(0,U.Zo)(s);return null==g?[s,""]:[s.slice(0,s.length-g.length-1),".".concat(g)]}(s),[A,S]=l(g);return[A,S,b]}async function p(s){return"blob"===s.type?s.blob:"json"===s.type?new Blob([s.jsonString],{type:"application/json"}):(await(0,A.A)(s.url,{responseType:"blob"})).data}function m(s,g){if(!s.hasPath())return null;const[b,,A]=i(s.path);return s.portalItem.resourceFromPath((0,U.fj)(b,g+A))}},17280:(s,g,b)=>{b.d(g,{S:()=>n,r:()=>p});var A=b(4180),S=b(81618),U=b(51523),R=b(49946);async function p(s,g,b){const A=await u(s,g,b);await h(A,g,b)}async function n(s,g,b,A,S){const U=await u(b,A,S);await s.update({data:g}),await h(U,A,S)}async function u(s,g,O){if(null===g||void 0===g||!g.resources)return;const x=g.portalItem===s.portalItem?new Set(s.paths):new Set;s.paths.length=0,s.portalItem=g.portalItem;const N=new Set(g.resources.toKeep.map((s=>s.resource.path))),E=new Set,k=[];N.forEach((g=>{x.delete(g),s.paths.push(g)}));const L=[],D=[],q=[];for(const b of g.resources.toUpdate)if(x.delete(b.resource.path),N.has(b.resource.path)||E.has(b.resource.path)){const{resource:g,content:A,finish:S}=b,O=(0,R.bg)(g,(0,U.lk)());s.paths.push(O.path),L.push({resource:O,content:await(0,R.cL)(A),compress:b.compress}),S&&q.push((()=>S(O)))}else{s.paths.push(b.resource.path),D.push({resource:b.resource,content:await(0,R.cL)(b.content),compress:b.compress});const g=b.finish;g&&q.push((()=>g(b.resource))),E.add(b.resource.path)}for(const b of g.resources.toAdd)if(s.paths.push(b.resource.path),x.has(b.resource.path))x.delete(b.resource.path);else{L.push({resource:b.resource,content:await(0,R.cL)(b.content),compress:b.compress});const s=b.finish;s&&q.push((()=>s(b.resource)))}if(L.length||D.length){const{addOrUpdateResources:s}=await Promise.resolve().then(b.bind(b,49946));await s(g.portalItem,L,"add",O),await s(g.portalItem,D,"update",O)}if(q.forEach((s=>s())),0===k.length)return x;const C=await(0,S.Ol)(k);if((0,S.Te)(O),C.length>0)throw new A.A("save:resources","Failed to save one or more resources",{errors:C});return x}async function h(s,g,b){if(!s||!g.portalItem)return;const A=[];for(const S of s){const s=g.portalItem.resourceFromPath(S);A.push(s.portalItem.removeResource(s,b))}await(0,S.Lx)(A)}},79566:(s,g,b)=>{b.d(g,{X:()=>i});var A=b(61272),S=b(4180),U=b(56276);function i(s){if(A.A.apiKey&&(0,U.Q)(s.portal.url))throw new S.A("save-api-key-utils:api-key-not-supported","Saving is not supported on ".concat(s.portal.url," when using an api key"))}},63539:(s,g,b)=>{b.d(g,{c:()=>t,d:()=>r});var A=b(4180);async function r(s){const g=[];for(const b of s.allLayers)if("beforeSave"in b&&"function"==typeof b.beforeSave){const s=b.beforeSave();s&&g.push(s)}await Promise.allSettled(g)}const S=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function t(s,g,b){var U;let R=(null!==(U=s.messages)&&void 0!==U?U:[]).filter((s=>{let{type:g}=s;return"error"===g})).map((s=>{let{name:g,message:b,details:S}=s;return new A.A(g,b,S)}));if(s.blockedRelativeUrls&&(R=R.concat(s.blockedRelativeUrls.map((s=>new A.A("url:unsupported","Relative url '".concat(s,"' is not supported")))))),b){const{ignoreUnsupported:s,supplementalUnsupportedErrors:g=[],requiredPropertyChecksDisabled:A}=b;s&&(R=R.filter((s=>{let{name:b}=s;return!(S.has(b)||g.includes(b))}))),A&&(R=R.filter((s=>"web-document-write:property-required"!==s.name)))}if(R.length>0)throw new A.A(g.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:R})}}}]);
//# sourceMappingURL=4767.bbf4a0e9.chunk.js.map