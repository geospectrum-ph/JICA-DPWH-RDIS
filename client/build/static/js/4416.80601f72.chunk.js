"use strict";(self.webpackChunkSEEDs_v2_0_Client=self.webpackChunkSEEDs_v2_0_Client||[]).push([[4416],{85914:(e,t,s)=>{s.d(t,{A:()=>i});var r=s(77480),n=s(49178);class i{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){var t;return null!==(t=this._resourceMap.get(e))&&void 0!==t?t:null}async fetchResource(e,t){const s=this._resourceMap.get(e);if(s)return{width:s.width,height:s.height};let r=this._inFlightResourceMap.get(e);return r?r.then((e=>({width:e.width,height:e.height}))):(r=(0,n.M5)(e,t),this._inFlightResourceMap.set(e,r),r.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(e){return(0,r.Al)(e)}}},74416:(e,t,s)=>{s.r(t),s.d(t,{CIMSymbolRasterizer:()=>o});var r=s(85914),n=s(80887),a=s(8809),l=s(85060),c=s(3067);class o{constructor(e){this._spatialReference=e,this._imageDataCanvas=null,this._cimResourceManager=new r.A}get _canvas(){return this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas")),this._imageDataCanvas}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,t,s,r,n,g,u,d,y){if(!e)return null;const{data:w}=e;if(!w||"CIMSymbolReference"!==w.type||!w.symbol)return null;const{symbol:m}=w;g||(g=(0,c.n5)(m));const p=await l.$.resolveSymbolOverrides(w,t,this._spatialReference,n,g,u,d),M=this._cimResourceManager,_=[];a.wp.fetchResources(p,M,_),a.wp.fetchFonts(p,M,_),_.length>0&&await Promise.all(_);const{width:R,height:b}=s,v=h(g,R,b,r),C=a.wp.getEnvelope(p,v,M);if(!C)return null;let f=1,S=0,I=0;switch(m.type){case"CIMPointSymbol":case"CIMTextSymbol":{let e=1;C.width>R&&(e=R/C.width);let t=1;C.height>b&&(t=b/C.height),"preview"===r&&(C.width<R&&(e=R/C.width),C.height<b&&(t=b/C.height)),f=Math.min(e,t),S=C.x+C.width/2,I=C.y+C.height/2}break;case"CIMLineSymbol":{(y||C.height>b)&&(f=b/C.height),I=C.y+C.height/2;const e=C.x*f+R/2,t=(C.x+C.width)*f+R/2,{paths:s}=v;s[0][0][0]-=e/f,s[0][2][0]-=(t-R)/f}break;case"CIMPolygonSymbol":{S=C.x+C.width/2,I=C.y+C.height/2;const e=C.x*f+R/2,t=(C.x+C.width)*f+R/2,s=C.y*f+b/2,r=(C.y+C.height)*f+b/2,{rings:n}=v;e<0&&(n[0][0][0]-=e,n[0][3][0]-=e,n[0][4][0]-=e),s<0&&(n[0][0][1]+=s,n[0][1][1]+=s,n[0][4][1]+=s),t>R&&(n[0][1][0]-=t-R,n[0][2][0]-=t-R),r>b&&(n[0][2][1]+=r-b,n[0][3][1]+=r-b)}}const x={type:"cim",data:{type:"CIMSymbolReference",symbol:p}};return this.rasterize(x,R,b,S,I,f,g,1,v)}rasterize(e,t,s,r,a,l,g){let u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;const{data:y}=e;if(!y||"CIMSymbolReference"!==y.type||!y.symbol)return null;const{symbol:w}=y,m=this._canvas,p=1.3333333333333333*(window.devicePixelRatio||1);m.width=t*p,m.height=s*p,g||(g=(0,c.n5)(w)),d||(d=h(g,t,s,"legend")),m.width+=2*u,m.height+=2*u;const M=m.getContext("2d",{willReadFrequently:!0}),_=n.IT.createIdentity();return _.translate(-r,-a),_.scale(l*p,-l*p),_.translate(t*p/2+u,s*p/2+u),M.clearRect(0,0,m.width,m.height),new n.Rj(M,this._cimResourceManager,_,!0).drawSymbol(w,d),M.getImageData(0,0,m.width,m.height)}}function h(e,t,s,r){const n=-t/2+1,a=t/2-1,l=s/2-1,c=-s/2+1;switch(e){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[n,0],[0,0],[a,0]]]};default:return"legend"===r?{rings:[[[n,l],[a,0],[a,c],[n,c],[n,l]]]}:{rings:[[[n,l],[a,l],[a,c],[n,c],[n,l]]]}}}}}]);
//# sourceMappingURL=4416.80601f72.chunk.js.map