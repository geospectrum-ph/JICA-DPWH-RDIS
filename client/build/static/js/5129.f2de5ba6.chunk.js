"use strict";(self.webpackChunkSEEDs_v2_0_Client=self.webpackChunkSEEDs_v2_0_Client||[]).push([[5129],{31714:(e,t,s)=>{s.d(t,{T:()=>r,U:()=>o});var f=s(48237);function o(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const h=(0,f.qE)(e,0,y);for(let f=0;f<4;f++)t[s+f]=Math.floor(256*l(h*c[f]))}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=0;for(let f=0;f<4;f++)s+=e[t+f]*h[f];return s}const c=[1,256,65536,16777216],h=[1/256,1/65536,1/16777216,1/4294967296],y=r(new Uint8ClampedArray([255,255,255,255]));function l(e){return e-Math.floor(e)}},16906:(e,t,s)=>{s.d(t,{X_:()=>i,i1:()=>o,zx:()=>d});var f=s(48237),c=s(49049);const h=96;function i(e,t){const s=t||e.extent,f=e.width,y=(0,c.GA)(null===s||void 0===s?void 0:s.spatialReference);return s&&f?s.width/f*y*c.dy*h:0}function o(e,t){return e/((0,c.GA)(t)*c.dy*h)}function d(e,t,s){return function a(e,t){return 0===t||(0,f.Sp)(e,t)||e<t}(e,t)&&function p(e,t){return 0===t||(0,f.Sp)(e,t)||e>t}(e,s)}},84058:(e,t,s)=>{function o(e){var t;const s=e.layer;return"floorInfo"in s&&null!==(t=s.floorInfo)&&void 0!==t&&t.floorField&&"floors"in e.view?l(e.view.floors,s.floorInfo.floorField):null}function n(e,t){var s;return"floorInfo"in t&&null!==(s=t.floorInfo)&&void 0!==s&&s.floorField?l(e,t.floorInfo.floorField):null}function l(e,t){if(null===e||void 0===e||!e.length)return null;const s=e.filter((e=>""!==e)).map((e=>"'".concat(e,"'")));return s.push("''"),"".concat(t," IN (").concat(s.join(","),") OR ").concat(t," IS NULL")}s.d(t,{E:()=>o,f:()=>n})},67612:(e,t,s)=>{s.d(t,{A:()=>j});var f=s(80671),c=s(4180),h=s(89412),y=s(81618),v=s(63390),m=s(57453),g=(s(50886),s(76761),s(68682)),F=s(32277),w=s(81124),_=s(71843),I=s(57022),b=s(84058),E=s(49096),x=s(39368),R=s(54217);const j=e=>{let t=class extends e{constructor(){super(...arguments),this._updatingRequiredFieldsPromise=null,this.dataUpdating=!1,this.filter=null,this.timeExtent=null,this.layer=null,this.requiredFields=[],this.view=null}initialize(){this.addHandles([(0,v.wB)((()=>{var e;const t=this.layer;return[t&&"elevationInfo"in t?null===(e=t.elevationInfo)||void 0===e?void 0:e.featureExpressionInfo:null,t&&"displayField"in t?t.displayField:null,t&&"timeInfo"in t&&t.timeInfo,t&&"renderer"in t&&t.renderer,t&&"labelingInfo"in t&&t.labelingInfo,t&&"floorInfo"in t&&t.floorInfo,this.filter,this.featureEffect,this.timeExtent]}),(()=>this._handleRequiredFieldsChange()),v.pc),(0,v.on)((()=>{var e;return null===(e=this.view)||void 0===e?void 0:e.floors}),"change",(()=>this._handleRequiredFieldsChange())),(0,v.on)((()=>{const e=this.layer;return e&&"sublayers"in e?e.sublayers:null}),"change",(()=>this._handleRequiredFieldsChange()))])}get availableFields(){if(!this.layer)return[];const{layer:e,layer:{fieldsIndex:t},requiredFields:s}=this;return"outFields"in e&&e.outFields?(0,I.DB)(t,[...(0,I.hL)(t,e.outFields),...s]):(0,I.DB)(t,s)}get featureEffect(){return this.layer&&"featureEffect"in this.layer?this.layer.featureEffect:null}set featureEffect(e){this._override("featureEffect",e)}get maximumNumberOfFeatures(){return 0}set maximumNumberOfFeatures(e){h.A.getLogger(this).error("#maximumNumberOfFeatures=","Setting maximum number of features is not supported")}get maximumNumberOfFeaturesExceeded(){return!1}highlight(e){throw new Error("missing implementation")}createQuery(){const e={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},t=null!=this.filter?this.filter.createQuery(e):new E.A(e);if("floorInfo"in this.layer&&this.layer.floorInfo){const e=(0,b.E)(this);null!=e&&(t.where=t.where?"(".concat(t.where,") AND (").concat(e,")"):e)}return null!=this.timeExtent&&(t.timeExtent=null!=t.timeExtent?t.timeExtent.intersection(this.timeExtent):this.timeExtent.clone()),t}createAggregateQuery(){const e={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference};return new E.A(e)}queryFeatures(e,t){throw new Error("missing implementation")}queryObjectIds(e,t){throw new Error("missing implementation")}queryFeatureCount(e,t){throw new Error("missing implementation")}queryExtent(e,t){throw new Error("missing implementation")}async fetchPopupFeaturesFromGraphics(e,t){return this._validateFetchPopupFeatures(e,t),this._fetchPopupFeatures(e,t)}_loadArcadeModules(e){var t;return null!==(t=e.expressionInfos)&&void 0!==t&&t.length||Array.isArray(e.content)&&e.content.some((e=>"expression"===e.type))?(0,x.lw)():Promise.resolve()}_handleRequiredFieldsChange(){const e=this._updateRequiredFields();this._set("_updatingRequiredFieldsPromise",e),e.then((()=>{this._updatingRequiredFieldsPromise===e&&this._set("_updatingRequiredFieldsPromise",null)}))}async _updateRequiredFields(){if(!this.layer||!this.view)return;const e="3d"===this.view.type,{layer:t,layer:{fieldsIndex:s,objectIdField:f}}=this,c="renderer"in t&&t.renderer,y="orderBy"in t&&t.orderBy,v="featureReduction"in t?t.featureReduction:null,m=new Set,g=await Promise.allSettled([c?c.collectRequiredFields(m,s):null,(0,I.Im)(m,t),e&&"elevationInfo"in t?(0,I.NO)(m,t):null,null!=this.filter?(0,I.o)(m,t,this.filter):null,e||null==this.featureEffect?null:(0,I.o)(m,t,this.featureEffect.filter),!e&&v?(0,I.RP)(m,t,v):null,!e&&y?(0,I.f)(m,t,y):null]);if("timeInfo"in t&&t.timeInfo&&this.timeExtent&&(0,I._w)(m,t.fieldsIndex,[t.timeInfo.startField,t.timeInfo.endField]),"floorInfo"in t&&t.floorInfo&&(0,I._w)(m,t.fieldsIndex,[t.floorInfo.floorField]),"feature"===t.type&&e&&null!=t.infoFor3D&&(null==t.globalIdField&&h.A.getLogger(this).error("globalIdField missing on 3DObjectFeatureLayer"),(0,I._w)(m,t.fieldsIndex,[t.globalIdField])),"subtype-group"===t.type){(0,I.rq)(m,s,t.subtypeField);const e=t.sublayers.map((e=>{var t;return Promise.all([null===(t=e.renderer)||void 0===t?void 0:t.collectRequiredFields(m,s),(0,I.Im)(m,e)])}));await Promise.allSettled(e)}"catalog-footprint"===t.type&&(0,I._w)(m,s,[t.parent.itemSourceField,t.parent.itemTypeField]);for(const w of g)"rejected"===w.status&&h.A.getLogger(this).error(w.reason);(0,I.rq)(m,s,f),e&&"displayField"in t&&t.displayField&&(0,I.rq)(m,s,t.displayField);const F=Array.from(m).sort();this._set("requiredFields",F)}_validateFetchPopupFeatures(e,t){if(null!=t)for(const s of e){const e=s.origin&&"layer"in s.origin?s.origin.layer:s.layer;if("popupEnabled"in e&&!e.popupEnabled)throw new c.A("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:e});if(s.isAggregate){const t="featureReduction"in e?e.featureReduction:null;if(!(t&&"popupTemplate"in t&&t.popupEnabled&&t.popupTemplate))throw new c.A("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:e})}else if("popupTemplate"in e&&!(0,R.D8)(e,t))throw new c.A("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:e})}}_popupFeatureHasRequiredFields(e,t){return(0,I.Kl)(t,e)}async _fetchPopupFeatures(e,t){const s=new Array(e.length),f=new Map,c=await this._createPopupQuery(e.map((e=>{var t,s;return null!==(t=null===(s=e.origin)||void 0===s?void 0:s.layer)&&void 0!==t?t:e.layer})),t);for(let m=0;m<e.length;m++){var h,v;const g=e[m];if(g.isAggregate){s[m]=g;continue}const F=null!==(h=null===(v=g.origin)||void 0===v?void 0:v.layer)&&void 0!==h?h:g.layer;if(!F||!("popupEnabled"in F))continue;const w=(0,I.hL)(this.layer.fieldsIndex,c.outFields),_=(0,R.D8)(F,t);if(null==_)continue;const b=await this._loadArcadeModules(_);(0,y.Te)(t),b&&b.arcadeUtils.hasGeometryOperations(_)||!this._popupFeatureHasRequiredFields(g,w)?f.set(g.getObjectId(),{graphic:g,index:m}):s[m]=g}if("stream"===this.layer.type||0===f.size)return s.filter(Boolean);c.objectIds=Array.from(f.keys());try{const e=await this.layer.queryFeatures(c,t);for(const t of e.features){const{graphic:{geometry:e,origin:c},index:h}=f.get(t.getObjectId());t.geometry||(t.geometry=e),t.origin=c,s[h]=t}}catch{}return s.filter(Boolean)}async _createPopupQuery(e,t){const s=this.layer.createQuery(),f=new Set;let c=!1;const h=null!==e&&void 0!==e?e:[this.layer];for(const v of h){if(!("popupEnabled"in v))continue;const e=(0,R.D8)(v,t);if(null==e)continue;const s=await this._loadArcadeModules(e);(0,y.Te)(t);const h=s&&s.arcadeUtils.hasGeometryOperations(e);c=!("point"!==this.layer.geometryType&&!h);const m=await(0,R.TO)(this.layer,e);(0,y.Te)(t);for(const t of m)f.add(t)}if(s.returnGeometry=c,s.returnZ=c,s.returnM=c,s.outFields=Array.from(f),s.outSpatialReference=this.view.spatialReference,"floorInfo"in this.layer&&this.layer.floorInfo){const e=(0,b.E)(this);null!=e&&(s.where=s.where?"(".concat(s.where,") AND (").concat(e,")"):e)}return s}canResume(){return!!super.canResume()&&(null==this.timeExtent||!this.timeExtent.isEmpty)}getTest(){return{createPopupQuery:e=>this._createPopupQuery(void 0,e)}}get test(){return this.getTest()}};return(0,f._)([(0,m.MZ)()],t.prototype,"_updatingRequiredFieldsPromise",void 0),(0,f._)([(0,m.MZ)({readOnly:!0})],t.prototype,"availableFields",null),(0,f._)([(0,m.MZ)({readOnly:!0})],t.prototype,"dataUpdating",void 0),(0,f._)([(0,m.MZ)({type:w.A})],t.prototype,"featureEffect",null),(0,f._)([(0,m.MZ)({type:_.A})],t.prototype,"filter",void 0),(0,f._)([(0,m.MZ)(F.ui)],t.prototype,"timeExtent",void 0),(0,f._)([(0,m.MZ)()],t.prototype,"layer",void 0),(0,f._)([(0,m.MZ)({type:Number})],t.prototype,"maximumNumberOfFeatures",null),(0,f._)([(0,m.MZ)({readOnly:!0,type:Boolean})],t.prototype,"maximumNumberOfFeaturesExceeded",null),(0,f._)([(0,m.MZ)({readOnly:!0})],t.prototype,"requiredFields",void 0),(0,f._)([(0,m.MZ)()],t.prototype,"suspended",void 0),(0,f._)([(0,m.MZ)()],t.prototype,"view",void 0),t=(0,f._)([(0,g.$)("esri.views.layers.FeatureLayerView")],t),t}},27012:(e,t,s)=>{s.d(t,{A:()=>b});var f=s(80671),c=s(18763),h=s(73067),y=s(16904),v=s(89412),m=s(35598),g=s(5203),F=s(57453),w=(s(50886),s(76761),s(68682)),_=s(31059);let I=class extends((0,y.sA)((0,g.g)(h.A.EventedMixin(c.A)))){constructor(e){super(e),this._updatingHandles=new _.U,this.layer=null,this.parent=null}initialize(){this.when().catch((e=>{if("layerview:create-error"!==e.name){var t;const s=this.layer&&this.layer.id||"no id",f=(null===(t=this.layer)||void 0===t?void 0:t.title)||"no title";v.A.getLogger(this).error("#resolve()","Failed to resolve layer view (layer title: '".concat(f,"', id: '").concat(s,"')"),e)}}))}destroy(){this._updatingHandles=(0,m.pR)(this._updatingHandles)}get fullOpacity(){var e,t,s,f;return(null!==(e=null===(t=this.layer)||void 0===t?void 0:t.opacity)&&void 0!==e?e:1)*(null!==(s=null===(f=this.parent)||void 0===f?void 0:f.fullOpacity)&&void 0!==s?s:1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){var e;return!this.suspended&&!0===(null===(e=this.layer)||void 0===e?void 0:e.legendEnabled)}get updating(){var e;return!((null===(e=this._updatingHandles)||void 0===e||!e.updating)&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var e;return!0===(null===(e=this.layer)||void 0===e?void 0:e.visible)}set visible(e){this._overrideIfSome("visible",e)}canResume(){var e,t,s;return this.visible&&(null===(e=this.layer)||void 0===e?void 0:e.loaded)&&!(null!==(t=this.parent)&&void 0!==t&&t.suspended)&&(null===(s=this.view)||void 0===s?void 0:s.ready)||!1}getSuspendInfo(){var e,t;const s=null!==(e=this.parent)&&void 0!==e&&e.suspended?this.parent.suspendInfo:{};return null!==(t=this.view)&&void 0!==t&&t.ready||(s.viewNotReady=!0),this.layer&&this.layer.loaded||(s.layerNotLoaded=!0),this.visible||(s.layerInvisible=!0),s}isUpdating(){return!1}};(0,f._)([(0,F.MZ)()],I.prototype,"fullOpacity",null),(0,f._)([(0,F.MZ)()],I.prototype,"layer",void 0),(0,f._)([(0,F.MZ)()],I.prototype,"parent",void 0),(0,f._)([(0,F.MZ)({readOnly:!0})],I.prototype,"suspended",null),(0,f._)([(0,F.MZ)({readOnly:!0})],I.prototype,"suspendInfo",null),(0,f._)([(0,F.MZ)({readOnly:!0})],I.prototype,"legendEnabled",null),(0,f._)([(0,F.MZ)({type:Boolean,readOnly:!0})],I.prototype,"updating",null),(0,f._)([(0,F.MZ)({readOnly:!0})],I.prototype,"updatingProgress",null),(0,f._)([(0,F.MZ)()],I.prototype,"visible",null),(0,f._)([(0,F.MZ)()],I.prototype,"view",void 0),I=(0,f._)([(0,w.$)("esri.views.layers.LayerView")],I);const b=I},59995:(e,t,s)=>{s.d(t,{A:()=>i});var f=s(80671),c=s(89412),h=s(81618),y=s(63390),v=(s(50886),s(76761),s(4180),s(68682));const i=e=>{let t=class extends e{initialize(){this.addHandles((0,y.on)((()=>this.layer),"refresh",(e=>{this.doRefresh(e.dataChanged).catch((e=>{(0,h.zf)(e)||c.A.getLogger(this).error(e)}))})),"RefreshableLayerView")}};return t=(0,f._)([(0,v.$)("esri.layers.mixins.RefreshableLayerView")],t),t}},54217:(e,t,s)=>{s.d(t,{D8:()=>p,TO:()=>n,d0:()=>u});var f=s(57022);async function n(e){var t,s;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.popupTemplate;if(null==c)return[];const h=await c.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:y}=c,{objectIdField:v,typeIdField:m,globalIdField:g,relationships:F}=e;if(h.includes("*"))return["*"];const w=y?(0,f.eX)(e):[],_=(0,f.DB)(e.fieldsIndex,[...h,...w]);return m&&_.push(m),_&&v&&null!==(t=e.fieldsIndex)&&void 0!==t&&t.has(v)&&!_.includes(v)&&_.push(v),_&&g&&null!==(s=e.fieldsIndex)&&void 0!==s&&s.has(g)&&!_.includes(g)&&_.push(g),F&&F.forEach((t=>{var s;const{keyField:f}=t;_&&f&&(null===(s=e.fieldsIndex)||void 0===s?void 0:s.has(f))&&!_.includes(f)&&_.push(f)})),_}function p(e,t){return e.popupTemplate?e.popupTemplate:null!=t&&t.defaultPopupTemplateEnabled&&null!=e.defaultPopupTemplate?e.defaultPopupTemplate:null}function u(e,t){return null!=p(e,{defaultPopupTemplateEnabled:t})}}}]);
//# sourceMappingURL=5129.f2de5ba6.chunk.js.map