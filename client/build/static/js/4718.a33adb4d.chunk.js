"use strict";(self.webpackChunkSEEDs_v2_0_Client=self.webpackChunkSEEDs_v2_0_Client||[]).push([[4718],{14718:(e,a,r)=>{r.r(a),r.d(a,{createArcadeExecutor:()=>A,createArcadeProfile:()=>C});var n=r(13812),o=r(46381),c=r(19856),s=r(4180),l=r(66004),i=r(99343),u=r(23342),p=r(9370),h=r(91710),w=r(94309),$=r(39368);let k=null;function f(e,a,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=a.elementType,s="value",l="array"===o.type?[{name:s,type:o.type,elementType:o.elementType}]:"dictionary"===o.type?[{name:s,type:o.type,properties:o.properties}]:[{name:s,type:o.type}];return new c.A(e.map((e=>{const a={};return b(a,l,{[s]:e},r,n),a[s]})))}function m(e,a){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=e instanceof w.A?new p.default({source:e.features,geometryType:e.geometryType,fields:e.fields,spatialReference:e.spatialReference}):e;return a.constructFeatureSet(n,r.spatialReference,null,!0,r.lruCache,r.interceptor)}function y(e,a){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{spatialReference:n,interceptor:o,lruCache:c}=r;return"string"==typeof e?a.createFeatureSetCollectionFromService(e,n,c,o):a.createFeatureSetCollectionFromMap(e,n,c,o)}function d(e,a,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o={};return b(o,a.properties,e,r,n),new k.Dictionary(o)}function b(e,a,r,n){let c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s={};for(const o of Object.keys(r))s[o.toLowerCase()]=r[o];for(const l of a){const a=l.name.toLowerCase();if(c.variablesPreProcessed)e[a]=s[a];else switch(l.type){case"array":{const r=s[a];e[a]=null==r?null:f(r,l,n,c);break}case"feature":{const r=s[a];e[a]=null==r?null:k.Feature.createFromGraphic(r,null===c||void 0===c?void 0:c.timeZone);break}case"featureSet":{const r=s[a];e[a]=null==r?null:n?m(r,n,c):null;break}case"featureSetCollection":{const r=s[a];e[a]=null==r?null:n?y(r,n,c):null;break}case"dictionary":{const r=s[a];e[a]=null==r?null:d(r,l,n,c);break}case"date":{const r=s[a];e[a]=r?r instanceof o.lY?r:null!==c&&void 0!==c&&c.timeZone?o.lY.dateJSAndZoneToArcadeDate(r,null===c||void 0===c?void 0:c.timeZone):o.lY.dateJSToArcadeDate(r):null;break}case"dateOnly":{const r=s[a];e[a]=r?r instanceof i.n?r:i.n.fromReader(r):null;break}case"time":{const r=s[a];e[a]=r?r instanceof u.k?r:u.k.fromReader(r):null;break}case"knowledgeGraph":case"geometry":case"boolean":case"text":case"number":e[a]=s[a]}}}function S(e,a){for(const r of e)a.push(r),"dictionary"===r.type&&S(r.properties,a);return a}function v(e,a,r,n,o){const{spatialReference:c,interceptor:s,lruCache:l,console:i,abortSignal:u,timeZone:p,services:w={portal:h.A.getDefault()}}=r,$={vars:{},spatialReference:c,interceptor:s,timeZone:p,lrucache:l,useAsync:o,services:w,console:i,abortSignal:u};return a?(b($.vars,e.variables,a,n,r),$):$}function g(e,a){switch(a.getArcadeType(e)){case"number":case"text":case"boolean":case"point":case"polygon":case"polyline":case"multipoint":case"extent":return e;case"date":return e.toJSDate();case"time":case"dateOnly":return e.toString();case"feature":{const a=(e.type,e),r="geometry"in a?a.geometry():null,o="readAttributes"in a?a.readAttributes():a.attributes;return new n.A({geometry:r,attributes:o})}case"dictionary":{const r=e,n=r.attributes,o={};for(const e of Object.keys(n))o[e]=g(r.field(e),a);return o}case"array":return("toArray"in e?e.toArray():e).map((e=>g(e,a)))}return e}const x={variables:[{name:"$feature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},{name:"$userInput",type:"geometry"},{name:"$graph",type:"knowledgeGraph"}]},T={variables:[{name:"$feature",type:"feature"},{name:"$aggregatedFeatures",type:"featureSet"}]},F=new Map([["form-constraint",{variables:[{name:"$feature",type:"feature"}]}],["feature-z",{variables:[{name:"$feature",type:"feature"}]}],["field-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$datastore",type:"featureSetCollection"}]}],["form-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$originalFeature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$featureSet",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},{name:"$editContext",type:"dictionary",properties:[{name:"editType",type:"text"}]}]}],["labeling",{variables:[{name:"$feature",type:"feature"}]}],["popup",x],["popup-element",x],["feature-reduction-popup",T],["feature-reduction-popup-element",T],["visualization",{variables:[{name:"$feature",type:"feature"},{name:"$view",type:"dictionary",properties:[{name:"scale",type:"number"}]}]}]]);function C(e){const a=F.get(e);if(!a){const a=Array.from(F.keys()).map((e=>"'".concat(e,"'"))).join(", ");throw new s.A("createArcadeProfile:invalid-profile-name","Invalid profile name '".concat(e,"'. You must specify one of the following values: ").concat(a))}return(0,l.o8)(a)}async function A(e,a){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};k||(k=await(0,$.lw)());const{arcade:n,arcadeUtils:o}=k,{loadScriptDependencies:c,referencesMember:l,scriptIsAsync:i}=n,u=S(a.variables,[]),p=u.filter((e=>"featureSet"===e.type||"featureSetCollection"===e.type)).map((e=>e.name.toLowerCase())),h=n.parseScript(e,p);if(!h)throw new s.A("arcade:invalid-script","Unable to create SyntaxTree");const w=o.extractFieldNames(h),x=n.scriptTouchesGeometry(h),T=u.map((e=>e.name.toLowerCase())).filter((e=>l(h,e))),F=i(h,p);await c(h,F,p);const R={vars:{},spatialReference:null,useAsync:F};for(const s of T)R.vars[s]="any";const{lruCache:_}=r,D=n.compileScript(h,R),O=n.featureSetUtils(),{services:U}=r;return{execute:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(F)throw new s.A("arcade:invalid-execution-mode","Cannot execute the script in synchronous mode");const n=D(v(a,e,{lruCache:_,...r},O,F));return r.rawOutput?n:g(n,o)},executeAsync:async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await D(v(a,e,{lruCache:_,services:U,...r},O,F));return r.rawOutput?n:g(n,o)},isAsync:F,variablesUsed:T,fieldsUsed:w,geometryUsed:x,syntaxTree:h}}},19856:(e,a,r)=>{r.d(a,{A:()=>t});class t{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._elements=e}length(){return this._elements.length}get(e){return this._elements[e]}toArray(){const e=[];for(let a=0;a<this.length();a++)e.push(this.get(a));return e}}}}]);
//# sourceMappingURL=4718.a33adb4d.chunk.js.map