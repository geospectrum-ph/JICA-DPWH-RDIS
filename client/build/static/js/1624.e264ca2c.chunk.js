"use strict";(self.webpackChunkSEEDs_v2_0_Client=self.webpackChunkSEEDs_v2_0_Client||[]).push([[1624],{32095:(U,V,L)=>{L.d(V,{F:()=>i,l:()=>a});var X=L(14795),Q=L(50886);const $=128e3;let J=null,et=null;async function i(){return J||(J=async function r(){const U=(0,Q.A)("esri-csp-restrictions")?await L.e(9247).then(L.bind(L,19247)).then((U=>U.l)):await L.e(4973).then(L.bind(L,94973)).then((U=>U.l));et=await U.default({locateFile:U=>(0,X.s)("esri/core/libs/libtess/".concat(U))})}()),J}function a(U,V){const L=Math.max(U.length,$);return et.triangulate(U,V,L)}},28155:(U,V,L)=>{L.d(V,{$:()=>X,s:()=>Q});const X=15.5,Q=1024},17865:(U,V,L)=>{L.d(V,{V:()=>l});var X=L(33303),Q=L(46164),$=L(73619),J=L(60072),et=L(8809);class l{static executeEffects(U,V,L,X){const Q=(0,et.ll)(U);let st=new $.k(V);for(const $ of U){const U=(0,J.A)($);U&&(st=U.execute(st,$,1.3333333333333333,L,X,Q))}return st}static applyEffects(U,V,L){if(!U)return V;const st=(0,et.ll)(U);let ht,_t=new $.k(X.z.fromJSONCIM(V));for(const X of U){const U=(0,J.A)(X);U&&(_t=U.execute(_t,X,1,null,L,st))}const vt=[];let Pt=null;for(;ht=_t.next();)vt.push(...(0,Q.x)(ht)),Pt=ht.geometryType;return 0===vt.length||null===Pt?null:"esriGeometryPolygon"===Pt?{rings:vt}:{paths:vt}}}},60950:(U,V,L)=>{L.d(V,{KQ:()=>X,Q4:()=>f,Ss:()=>s});const X=8388607,Q=8388608,f=U=>U&X;function s(U,V){return((V?Q:0)|U)>>>0}},11635:(U,V,L)=>{L.d(V,{i:()=>c});var X=L(64032),Q=L(80271);function x(U,V){return U.x===V.x&&U.y===V.y}function r(U){if(!U)return;const V=U.length;if(V<=1)return;let L=0;for(let X=1;X<V;X++)x(U[X],U[L])||++L===X||(U[L]=U[X]);U.length=L+1}function n(U,V){return U.x=V.y,U.y=-V.x,U}function s(U,V){return U.x=-V.y,U.y=V.x,U}function y(U,V){return U.x=V.x,U.y=V.y,U}function o(U,V){return U.x=-V.x,U.y=-V.y,U}function h(U){return Math.sqrt(U.x*U.x+U.y*U.y)}function l(U,V){return U.x*V.y-U.y*V.x}function _(U,V){return U.x*V.x+U.y*V.y}function a(U,V,L,X){return U.x=V.x*L+V.y*X,U.y=V.x*X-V.y*L,U}class c{constructor(U,V,L){this._writeVertex=U,this._writeTriangle=V,this._canUseThinTessellation=L,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(U,V){let L=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._canUseThinTessellation;r(U),L&&V.halfWidth<Q.Gh&&!V.offset?this._tessellateThin(U,V):this._tessellate(U,V)}_tessellateThin(U,V){if(U.length<2)return;const L=V.wrapDistance||65535;let X=V.initialDistance||0,Q=!1,$=U[0].x,J=U[0].y;const et=U.length;for(let st=1;st<et;++st){Q&&(Q=!1,X=0);let V=U[st].x,et=U[st].y,ht=V-$,_t=et-J,vt=Math.sqrt(ht*ht+_t*_t);if(ht/=vt,_t/=vt,X+vt>L){Q=!0;const U=(L-X)/vt;vt=L-X,V=(1-U)*$+U*V,et=(1-U)*J+U*et,--st}const Pt=this._writeVertex($,J,0,0,ht,_t,_t,-ht,0,-1,X),zt=this._writeVertex($,J,0,0,ht,_t,-_t,ht,0,1,X);X+=vt;const Et=this._writeVertex(V,et,0,0,ht,_t,_t,-ht,0,-1,X),Ut=this._writeVertex(V,et,0,0,ht,_t,-_t,ht,0,1,X);this._writeTriangle(Pt,zt,Et),this._writeTriangle(zt,Et,Ut),$=V,J=et}}_tessellate(U,V){const L=U[0],Q=U[U.length-1],$=x(L,Q),J=$?3:2;if(U.length<J)return;const et=V.pixelCoordRatio,st=null!=V.capType?V.capType:X.xR.BUTT,ht=null!=V.joinType?V.joinType:X.JO.MITER,_t=null!=V.miterLimit?Math.min(V.miterLimit,4):2,vt=null!=V.roundLimit?Math.min(V.roundLimit,1.05):1.05,Pt=null!=V.halfWidth?V.halfWidth:2,zt=!!V.textured;let Et,Ut,Vt,Lt=null;const Ot=this._prevNormal,Yt=this._nextNormal;let qt=-1,Qt=-1;const re=this._joinNormal;let ne,ie;const oe=this._textureNormalLeft,ae=this._textureNormalRight,ce=this._textureNormal;let le=-1,ue=-1;const he=V.wrapDistance||65535;let de=V.initialDistance||0;const pe=this._writeVertex,fe=this._writeTriangle,C=(U,V,L,X,Q,$)=>{const J=pe(Ut,Vt,ne,ie,L,X,U,V,Q,$,de);return le>=0&&ue>=0&&J>=0&&fe(le,ue,J),le=ue,ue=J,J};$&&(Et=U[U.length-2],Yt.x=Q.x-Et.x,Yt.y=Q.y-Et.y,Qt=h(Yt),Yt.x/=Qt,Yt.y/=Qt);let ye=!1;for(let me=0;me<U.length;++me){if(ye&&(ye=!1,de=0),Et&&(Ot.x=-Yt.x,Ot.y=-Yt.y,qt=Qt,de+qt>he&&(ye=!0)),ye){const V=(he-de)/qt;qt=he-de,Et={x:(1-V)*Et.x+V*U[me].x,y:(1-V)*Et.y+V*U[me].y},--me}else Et=U[me];Ut=Et.x,Vt=Et.y;const V=me<=0&&!ye,L=me===U.length-1;if(V||(de+=qt),Lt=L?$?U[1]:null:U[me+1],Lt?(Yt.x=Lt.x-Ut,Yt.y=Lt.y-Vt,Qt=h(Yt),Yt.x/=Qt,Yt.y/=Qt):(Yt.x=void 0,Yt.y=void 0),!$){if(V){s(re,Yt),ne=re.x,ie=re.y,st===X.xR.SQUARE&&(C(-Yt.y-Yt.x,Yt.x-Yt.y,Yt.x,Yt.y,0,-1),C(Yt.y-Yt.x,-Yt.x-Yt.y,Yt.x,Yt.y,0,1)),st===X.xR.ROUND&&(C(-Yt.y-Yt.x,Yt.x-Yt.y,Yt.x,Yt.y,-1,-1),C(Yt.y-Yt.x,-Yt.x-Yt.y,Yt.x,Yt.y,-1,1)),st!==X.xR.ROUND&&st!==X.xR.BUTT||(C(-Yt.y,Yt.x,Yt.x,Yt.y,0,-1),C(Yt.y,-Yt.x,Yt.x,Yt.y,0,1));continue}if(L){n(re,Ot),ne=re.x,ie=re.y,st!==X.xR.ROUND&&st!==X.xR.BUTT||(C(Ot.y,-Ot.x,-Ot.x,-Ot.y,0,-1),C(-Ot.y,Ot.x,-Ot.x,-Ot.y,0,1)),st===X.xR.SQUARE&&(C(Ot.y-Ot.x,-Ot.x-Ot.y,-Ot.x,-Ot.y,0,-1),C(-Ot.y-Ot.x,Ot.x-Ot.y,-Ot.x,-Ot.y,0,1)),st===X.xR.ROUND&&(C(Ot.y-Ot.x,-Ot.x-Ot.y,-Ot.x,-Ot.y,1,-1),C(-Ot.y-Ot.x,Ot.x-Ot.y,-Ot.x,-Ot.y,1,1));continue}}let Q,J,pe=-l(Ot,Yt);if(Math.abs(pe)<.01)_(Ot,Yt)>0?(re.x=Ot.x,re.y=Ot.y,pe=1,Q=Number.MAX_VALUE,J=!0):(s(re,Yt),pe=1,Q=1,J=!1);else{re.x=(Ot.x+Yt.x)/pe,re.y=(Ot.y+Yt.y)/pe,Q=h(re);const U=(Q-1)*Pt*et;J=Q>4||U>qt&&U>Qt}ne=re.x,ie=re.y;let fe=ht;switch(ht){case X.JO.BEVEL:Q<1.05&&(fe=X.JO.MITER);break;case X.JO.ROUND:Q<vt&&(fe=X.JO.MITER);break;case X.JO.MITER:Q>_t&&(fe=X.JO.BEVEL)}switch(fe){case X.JO.MITER:if(C(re.x,re.y,-Ot.x,-Ot.y,0,-1),C(-re.x,-re.y,-Ot.x,-Ot.y,0,1),L)break;if(zt){const U=ye?0:de;le=this._writeVertex(Ut,Vt,ne,ie,Yt.x,Yt.y,re.x,re.y,0,-1,U),ue=this._writeVertex(Ut,Vt,ne,ie,Yt.x,Yt.y,-re.x,-re.y,0,1,U)}break;case X.JO.BEVEL:{const U=pe<0;let V,X,Q,$;if(U){const U=le;le=ue,ue=U,V=oe,X=ae}else V=ae,X=oe;if(J)Q=U?s(this._innerPrev,Ot):n(this._innerPrev,Ot),$=U?n(this._innerNext,Yt):s(this._innerNext,Yt);else{const V=U?o(this._inner,re):y(this._inner,re);Q=V,$=V}const et=U?n(this._bevelStart,Ot):s(this._bevelStart,Ot);C(Q.x,Q.y,-Ot.x,-Ot.y,V.x,V.y);const st=C(et.x,et.y,-Ot.x,-Ot.y,X.x,X.y);if(L)break;const ht=U?s(this._bevelEnd,Yt):n(this._bevelEnd,Yt);if(J){const U=this._writeVertex(Ut,Vt,ne,ie,-Ot.x,-Ot.y,0,0,0,0,de);le=this._writeVertex(Ut,Vt,ne,ie,Yt.x,Yt.y,$.x,$.y,V.x,V.y,de),ue=this._writeVertex(Ut,Vt,ne,ie,Yt.x,Yt.y,ht.x,ht.y,X.x,X.y,de),this._writeTriangle(st,U,ue)}else{if(zt){const U=this._bevelMiddle;U.x=(et.x+ht.x)/2,U.y=(et.y+ht.y)/2,a(ce,U,-Ot.x,-Ot.y),C(U.x,U.y,-Ot.x,-Ot.y,ce.x,ce.y),a(ce,U,Yt.x,Yt.y),le=this._writeVertex(Ut,Vt,ne,ie,Yt.x,Yt.y,U.x,U.y,ce.x,ce.y,de),ue=this._writeVertex(Ut,Vt,ne,ie,Yt.x,Yt.y,$.x,$.y,V.x,V.y,de)}else{const U=le;le=ue,ue=U}C(ht.x,ht.y,Yt.x,Yt.y,X.x,X.y)}if(U){const U=le;le=ue,ue=U}break}case X.JO.ROUND:{const U=pe<0;let V,X;if(U){const U=le;le=ue,ue=U,V=oe,X=ae}else V=ae,X=oe;const $=U?o(this._inner,re):y(this._inner,re);let et,st;J?(et=U?s(this._innerPrev,Ot):n(this._innerPrev,Ot),st=U?n(this._innerNext,Yt):s(this._innerNext,Yt)):(et=$,st=$);const ht=U?n(this._roundStart,Ot):s(this._roundStart,Ot),_t=U?s(this._roundEnd,Yt):n(this._roundEnd,Yt),vt=C(et.x,et.y,-Ot.x,-Ot.y,V.x,V.y),Pt=C(ht.x,ht.y,-Ot.x,-Ot.y,X.x,X.y);if(L)break;const Et=this._writeVertex(Ut,Vt,ne,ie,-Ot.x,-Ot.y,0,0,0,0,de);J||this._writeTriangle(le,ue,Et);const Lt=o(this._outer,$),qt=this._writeVertex(Ut,Vt,ne,ie,Yt.x,Yt.y,_t.x,_t.y,X.x,X.y,de);let Qt,he;const fe=Q>2;if(fe){let V;Q!==Number.MAX_VALUE?(Lt.x/=Q,Lt.y/=Q,V=_(Ot,Lt),V=(Q*(V*V-1)+1)/V):V=-1,Qt=U?n(this._startBreak,Ot):s(this._startBreak,Ot),Qt.x+=Ot.x*V,Qt.y+=Ot.y*V,he=U?s(this._endBreak,Yt):n(this._endBreak,Yt),he.x+=Yt.x*V,he.y+=Yt.y*V}a(ce,Lt,-Ot.x,-Ot.y);const ye=this._writeVertex(Ut,Vt,ne,ie,-Ot.x,-Ot.y,Lt.x,Lt.y,ce.x,ce.y,de);a(ce,Lt,Yt.x,Yt.y);const me=zt?this._writeVertex(Ut,Vt,ne,ie,Yt.x,Yt.y,Lt.x,Lt.y,ce.x,ce.y,de):ye,xe=Et,_e=zt?this._writeVertex(Ut,Vt,ne,ie,Yt.x,Yt.y,0,0,0,0,de):Et;let ge=-1,ve=-1;if(fe&&(a(ce,Qt,-Ot.x,-Ot.y),ge=this._writeVertex(Ut,Vt,ne,ie,-Ot.x,-Ot.y,Qt.x,Qt.y,ce.x,ce.y,de),a(ce,he,Yt.x,Yt.y),ve=this._writeVertex(Ut,Vt,ne,ie,Yt.x,Yt.y,he.x,he.y,ce.x,ce.y,de)),zt?fe?(this._writeTriangle(xe,Pt,ge),this._writeTriangle(xe,ge,ye),this._writeTriangle(_e,me,ve),this._writeTriangle(_e,ve,qt)):(this._writeTriangle(xe,Pt,ye),this._writeTriangle(_e,me,qt)):fe?(this._writeTriangle(Et,Pt,ge),this._writeTriangle(Et,ge,ve),this._writeTriangle(Et,ve,qt)):(this._writeTriangle(Et,Pt,ye),this._writeTriangle(Et,me,qt)),J?(le=this._writeVertex(Ut,Vt,ne,ie,Yt.x,Yt.y,st.x,st.y,V.x,V.y,de),ue=qt):(le=zt?this._writeVertex(Ut,Vt,ne,ie,Yt.x,Yt.y,st.x,st.y,V.x,V.y,de):vt,this._writeTriangle(le,_e,qt),ue=qt),U){const U=le;le=ue,ue=U}break}}}}}},52988:(U,V,L)=>{L.d(V,{Y7:()=>v,HS:()=>w,mm:()=>F,A:()=>j,k2:()=>P,ZA:()=>b,E8:()=>x,hF:()=>g,C5:()=>GraphShaderModule_l,uK:()=>K,Pi:()=>GraphShaderModule_});var X=L(80671),Q=L(16842),$=L(89412),J=L(4389),et=L(4180),st=L(45981),ht=L(22650);const s=()=>$.A.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class i{constructor(){this._includedModules=new Map}include(U,V){if(this._includedModules.has(U)){const L=this._includedModules.get(U);if(L!==V){s().error("Trying to include shader module multiple times with different sets of options.");const V=new Set;for(const X of Object.keys(L))L[X]!==U[X]&&V.add(X);for(const X of Object.keys(U))L[X]!==U[X]&&V.add(X);V.forEach((V=>console.error("  ".concat(V,": current ").concat(L[V]," new ").concat(U[V]))))}}else this._includedModules.set(U,V),U(this.builder,V)}}class o extends i{constructor(){super(...arguments),this.vertex=new u,this.fragment=new u,this.attributes=new m,this.varyings=new h,this.extensions=new l,this.constants=new d}get fragmentUniforms(){return this.fragment.uniforms.entries}get builder(){return this}generate(U){let V=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const L=this.extensions.generateSource(U),X=this.attributes.generateSource(U),Q=this.varyings.generateSource(U),$="vertex"===U?this.vertex:this.fragment,J=$.uniforms.generateSource(),et=$.code.generateSource(),st="vertex"===U?_t:function _(){let U=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif\n".concat(U?"out vec4 fragColor;":"","\n")}(V),ht=this.constants.generateSource().concat($.constants.generateSource());return"".concat(V?"#version 300 es":"","\n").concat(L.join("\n"),"\n").concat(st,"\n").concat(ht.join("\n"),"\n").concat(J.join("\n"),"\n").concat(X.join("\n"),"\n").concat(Q.join("\n"),"\n").concat(et.join("\n"))}generateBindPass(U){const V=new Map;this.vertex.uniforms.entries.forEach((U=>{const L=U.bind[st.c.Pass];L&&V.set(U.name,L)})),this.fragment.uniforms.entries.forEach((U=>{const L=U.bind[st.c.Pass];L&&V.set(U.name,L)}));const L=Array.from(V.values()),X=L.length;return(V,Q)=>{for(let $=0;$<X;++$)L[$](U,V,Q)}}generateBindDraw(U){const V=new Map;this.vertex.uniforms.entries.forEach((U=>{const L=U.bind[st.c.Draw];L&&V.set(U.name,L)})),this.fragment.uniforms.entries.forEach((U=>{const L=U.bind[st.c.Draw];L&&V.set(U.name,L)}));const L=Array.from(V.values()),X=L.length;return(V,Q,$)=>{for(let J=0;J<X;++J)L[J](U,V,Q,$)}}}class a{constructor(){this._entries=new Map}add(){for(var U=arguments.length,V=new Array(U),L=0;L<U;L++)V[L]=arguments[L];for(const X of V)this._add(X)}get(U){return this._entries.get(U)}_add(U){if(null!=U){if(this._entries.has(U.name)&&!this._entries.get(U.name).equals(U))throw new et.A("Duplicate uniform name ".concat(U.name," for different uniform type"));this._entries.set(U.name,U)}else s().error("Trying to add null Uniform from ".concat((new Error).stack,"."))}generateSource(){return Array.from(this._entries.values()).map((U=>null!=U.arraySize?"uniform ".concat(U.type," ").concat(U.name,"[").concat(U.arraySize,"];"):"uniform ".concat(U.type," ").concat(U.name,";")))}get entries(){return Array.from(this._entries.values())}}class c{constructor(){this._entries=new Array}add(U){this._entries.push(U)}generateSource(){return this._entries}}class u extends i{constructor(){super(...arguments),this.uniforms=new a,this.code=new c,this.constants=new d}get builder(){return this}}class m{constructor(){this._entries=new Array}add(U,V){this._entries.push([U,V])}generateSource(U){return"fragment"===U?[]:this._entries.map((U=>"in ".concat(U[1]," ").concat(U[0],";")))}}class h{constructor(){this._entries=new Map}add(U,V){this._entries.has(U)&&(0,ht.vA)(this._entries.get(U)===V),this._entries.set(U,V)}generateSource(U){const V=new Array;return this._entries.forEach(((L,X)=>V.push("vertex"===U?"out ".concat(L," ").concat(X,";"):"in ".concat(L," ").concat(X,";")))),V}}class l{constructor(){this._entries=new Set}add(U){this._entries.add(U)}generateSource(U){const V="vertex"===U?l.ALLOWLIST_VERTEX:l.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((U=>V.includes(U))).map((U=>"#extension ".concat(U," : enable")))}}l.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],l.ALLOWLIST_VERTEX=[];class d{constructor(){this._entries=new Set}add(U,V,L){let X="ERROR_CONSTRUCTOR_STRING";switch(V){case"float":X=d._numberToFloatStr(L);break;case"int":X=d._numberToIntStr(L);break;case"bool":X=L.toString();break;case"vec2":X="vec2(".concat(d._numberToFloatStr(L[0]),",                            ").concat(d._numberToFloatStr(L[1]),")");break;case"vec3":X="vec3(".concat(d._numberToFloatStr(L[0]),",                            ").concat(d._numberToFloatStr(L[1]),",                            ").concat(d._numberToFloatStr(L[2]),")");break;case"vec4":X="vec4(".concat(d._numberToFloatStr(L[0]),",                            ").concat(d._numberToFloatStr(L[1]),",                            ").concat(d._numberToFloatStr(L[2]),",                            ").concat(d._numberToFloatStr(L[3]),")");break;case"ivec2":X="ivec2(".concat(d._numberToIntStr(L[0]),",                             ").concat(d._numberToIntStr(L[1]),")");break;case"ivec3":X="ivec3(".concat(d._numberToIntStr(L[0]),",                             ").concat(d._numberToIntStr(L[1]),",                             ").concat(d._numberToIntStr(L[2]),")");break;case"ivec4":X="ivec4(".concat(d._numberToIntStr(L[0]),",                             ").concat(d._numberToIntStr(L[1]),",                             ").concat(d._numberToIntStr(L[2]),",                             ").concat(d._numberToIntStr(L[3]),")");break;case"mat2":case"mat3":case"mat4":X="".concat(V,"(").concat(Array.prototype.map.call(L,(U=>d._numberToFloatStr(U))).join(", "),")")}return this._entries.add("const ".concat(V," ").concat(U," = ").concat(X,";")),this}static _numberToIntStr(U){return U.toFixed(0)}static _numberToFloatStr(U){return Number.isInteger(U)?U.toFixed(1):U.toString()}generateSource(){return Array.from(this._entries)}}const _t="precision highp float;\nprecision highp sampler2D;";var vt=L(42656);function t(U,V,L){const X=V.split("\n");for(const Q of X)if(Q.trim().length){{let V="";null!=L&&(V+="/*id:".concat(null!==L&&void 0!==L?L:"000","*/   ")),U.body+=V.padEnd(14)}U.body+=" ".repeat(U.indent)+Q+"\n"}}class GlslGraphWriter_r{write(U){for(const V of U.rootOutputNodes())U.shouldPruneOutputNode(V)||(V.variableName=this._write(U,V.node));return U}_createVarName(U,V){let L="";return"boolean"!=typeof V&&"number"!=typeof V&&V.debugInfo.name&&(L="".concat(V.debugInfo.name,"_")),"".concat(L,"v").concat(U.varCount++)}_write(U,V){let L=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"==typeof V)return V.toString();if("boolean"==typeof V)return V.toString();let X=U.getEmit(V);if(X)return X;switch(V.shaderType){case"scope-node":X=this._writeScopeNode(U,V);break;case"primitive-node":X=this._writePrimitveNode(U,V,L);break;case"function-node":X=this._writeFunctionNode(U,V);break;case"property-access-node":X=this._writePropertyAccessNode(U,V);break;case"text-node":X=V.text;break;case"block-node":X=this._writeBlockNode(U,V);break;case"condition-node":X=this._writeConditionNode(U,V)}return U.setEmit(V,X),X}_writeScopeNode(U,V){const L=new V.child.constructor;L.setDebugName(V.debugInfo.name);const X=this._write(U,L,!0);return t(U,"{ /*ScopeStart: ".concat(V.uid," ").concat(V.debugInfo.name,"*/")),U.indent+=2,t(U,"".concat(X," = ").concat(this._write(U,V.child),";")),U.indent-=2,t(U,"} /*ScopeEnd: ".concat(V.uid," ").concat(V.debugInfo.name,"*/")),X}_writeConditionNode(U,V){const L=new V.ifTrue.constructor,X=this._write(U,L,!0);t(U,"if (".concat(this._write(U,V.condition),") {")),U.indent+=2;const Q=U.createSubgraphContext(),$=this._write(Q,V.ifTrue);if(U.body+=Q.body,$&&t(U,"".concat(X," = ").concat($,";")),U.indent-=2,t(U,"}"),V.ifFalse){t(U,"else {"),U.indent+=2;const L=U.createSubgraphContext(),Q=this._write(L,V.ifFalse);U.body+=L.body,Q&&t(U,"".concat(X," = ").concat(Q,";")),U.indent-=2,t(U,"}")}return X}_writeBlockNode(U,V){const{captureList:L,generator:X,returnType:Q}=V,$={};for(const ht in L){if(!L[ht])continue;const V=this._write(U,L[ht]);$[ht]=V}const J=new Q,et=this._write(U,J,!0);if($.out=et,V.subgraph){const L=U.createSubgraphContext(),X=this._write(L,V.subgraph.child),Q=L.body;$.subgraph={varName:X,body:Q}}const st=X($);return t(U,"{\n"),U.indent+=2,t(U,st),U.indent-=2,t(U,"}\n"),et}_writePropertyAccessNode(U,V){const L=this._write(U,V.target);return"string"==typeof V.property&&V.property.includes("[")?"".concat(L).concat(V.property):"string"!=typeof V.property?"".concat(L,"[").concat(this._write(U,V.property),"]"):"".concat(L,".").concat(V.property)}_writeFunctionNode(U,V){const L=V.returnType.type;if(V.isInfix){const[X,Q]=V.children.map((V=>this._write(U,V))),$=this._createVarName(U,V);return t(U,"".concat(L.padEnd(5)," ").concat($," = ").concat(X," ").concat(V.token," ").concat(Q,";"),V.uid),$}const X=V.children.map((V=>this._write(U,V))).join(", "),Q=this._createVarName(U,V);return t(U,"".concat(L.padEnd(5)," ").concat(Q," = ").concat(V.token,"(").concat(X,");"),V.uid),Q}_writePrimitveNode(U,V){var L;let X=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const Q=U.getInput(V);if(Q)return Q.isUsed=!0,Q.variableName;const $=1===V.children.length&&(null===(L=V.children[0])||void 0===L?void 0:L.type)===V.type;if(V.isImplicit||$)return this._write(U,V.children[0]);const J=this._createVarName(U,V);if(X)return t(U,"".concat(V.type.padEnd(5)," ").concat(J,";"),V.uid),J;const et=!V.debugInfo.name&&!V.isMutable;if(et&&"float"===V.type&&"number"==typeof V.children[0])return Number.isInteger(V.children[0])?V.children[0].toFixed(1):V.children[0].toString();if(et&&"int"===V.type&&"number"==typeof V.children[0]&&Number.isInteger(V.children[0]))return V.children[0].toString();const st=V.children.map((V=>this._write(U,V))).join(", ");return"array"===V.type?(t(U,"".concat(V.type.padEnd(5)," ").concat(J," = [").concat(st,"];"),V.uid),J):et?"".concat(V.type,"(").concat(st,")"):(t(U,"".concat(V.type.padEnd(5)," ").concat(J," = ").concat(V.type,"(").concat(st,");"),V.uid),J)}}var Pt=L(13401);class ShaderGraphContext_t{constructor(U,V,L){this.variableName=U,this.variableInputType=V,this.node=L,this.type="shader-input",this.isUsed=!1}clone(){return new ShaderGraphContext_t(this.variableName,this.variableInputType,(0,Pt.vA)(this.node))}}class n{constructor(U,V,L){this.outVariableName=U,this.outVariableType=V,this.node=L,this.type="shader-output"}clone(){const U=new n(this.outVariableName,this.outVariableType,(0,Pt.vA)(this.node));return U.variableName=this.variableName,U}}class ShaderGraphContext_o{static createVertex(U,V,L,X,Q,$){const J=[];for(const st in U){const V=U[st],X=L.get(st);X?J.push(new ShaderGraphContext_t(X,"builtin",V)):J.push(new ShaderGraphContext_t("a_"+st,"attribute",V))}for(const st of X){const U=st.uniformHydrated;J.push(new ShaderGraphContext_t(st.uniformName,"uniform",U))}const et=[];for(const st in V){const U=V[st];"glPosition"===st?et.push(new n("gl_Position","builtin",U)):"glPointSize"===st?et.push(new n("gl_PointSize","builtin",U)):et.push(new n("v_"+st,"varying",U))}return new ShaderGraphContext_o(J,et,Q,$)}static createFragment(U,V,L,X,Q,$){const J=[],et=Array.from(Q.rootOutputNodes());for(const ht in U){const V=U[ht],X=L.get(ht);if(X){J.push(new ShaderGraphContext_t(X,"builtin",V));continue}const Q=et.find((U=>U.node===V));Q&&J.push(new ShaderGraphContext_t(Q.outVariableName,Q.outVariableType,V))}for(const ht of X){const U=ht.uniformHydrated;J.push(new ShaderGraphContext_t(ht.uniformName,"uniform",U))}const st=[];for(const ht in V){const U=V[ht],X=L.get(ht);if("discard"===ht)st.push(new n(null,"discard",U));else{if(!X)throw new Error("Member ".concat(ht," in shader fragment output shoule be tagged as builtin"));st.push(new n(X,"builtin",U))}}return new ShaderGraphContext_o(J,st,$)}constructor(U,V,L,X){this.type="shader-graph-context",this.indent=0,this.body="",this.varCount=0,this._inputShaderTypesByNodeUid=new Map,this._nodeEmitMap=new Map;for(const Q of U)this._inputShaderTypesByNodeUid.set(Q.node.uid,Q);this._outputShaderTypes=V,this._transformFeedbackBindings=L,this._transformFeedbackNames=new Set(L.map((U=>"v_"+U.propertyKey))),this._usedInFragmentShader=X}shouldPruneOutputNode(U){return!!this._usedInFragmentShader&&"builtin"!==U.outVariableType&&!this._transformFeedbackNames.has(U.outVariableName)&&!this._usedInFragmentShader.has(U.node.uid)}setEmit(U,V){this._nodeEmitMap.set(U.uid,V)}getEmit(U){return this._nodeEmitMap.get(U.uid)}inputs(){return this._inputShaderTypesByNodeUid.values()}getInput(U){return this._inputShaderTypesByNodeUid.get(U.uid)}*rootOutputNodes(){for(const U of this._outputShaderTypes)yield U}*nodes(){const U=[];for(const V of this._outputShaderTypes.values())U.push(V.node);for(;U.length;){const V=U.pop();"number"!=typeof V&&"boolean"!=typeof V&&U.push(...V.children.filter(Boolean)),yield V}}*nodesOfTypeOrFunction(){for(const U of this.nodes())"number"!=typeof U&&"boolean"!=typeof U&&(yield U)}createSubgraphContext(){const U=this.clone();return U.body="",U.indent=this.indent+2,U._nodeEmitMap=new Map(this._nodeEmitMap),U}clone(){const U=new ShaderGraphContext_o([],this._outputShaderTypes,this._transformFeedbackBindings,this._usedInFragmentShader);return U._inputShaderTypesByNodeUid=this._inputShaderTypesByNodeUid,U.indent=this.indent,U.body=this.body,U.varCount=this.varCount,U._nodeEmitMap=this._nodeEmitMap,U}insertVertexShader(U){U.vertex.code.add(""),this._insertInputs(U,"vertex"),U.vertex.code.add(""),U.vertex.code.add("// OUTPUTS: "),U.vertex.code.add("// --------------------------------------------------------- ");for(const V of this.rootOutputNodes()){const L="builtin"===V.outVariableType;this.shouldPruneOutputNode(V)||(L?U.vertex.code.add("// ".concat(V.outVariableType.padEnd(7)," ").concat(V.node.type.padEnd(9)," ").concat(V.outVariableName,";")):U.vertex.code.add("".concat(V.outVariableType.padEnd(10)," ").concat(V.node.type.padEnd(9)," ").concat(V.outVariableName,";")))}U.vertex.code.add(""),U.vertex.code.add("void main() {"),U.vertex.code.add("  "+this.body.split("\n").join("\n  "));for(const V of this.rootOutputNodes())this.shouldPruneOutputNode(V)||U.vertex.code.add("  ".concat(V.outVariableName," = ").concat(V.variableName,";"));U.vertex.code.add("}")}insertFragmentShader(U){this._insertInputs(U,"fragment"),U.fragment.code.add(""),U.fragment.code.add("void main() {"),U.fragment.code.add("  "+this.body.split("\n").join("\n  "));for(const V of this.rootOutputNodes())"discard"===V.outVariableType?(U.fragment.code.add("  // TODO: Should ensure codegen for discard appears first in fragment shader"),U.fragment.code.add("  if (".concat(V.variableName,") {")),U.fragment.code.add("    discard;"),U.fragment.code.add("  }"),U.fragment.code.add("  ")):U.fragment.code.add("  ".concat(V.outVariableName," = ").concat(V.variableName,";"));U.fragment.code.add("}")}_insertInputs(U,V){U[V].code.add("// INPUTS: "),U[V].code.add("// --------------------------------------------------------- ");for(const L of this.inputs())L.isUsed&&"builtin"!==L.variableInputType&&("array"===L.node.type?U[V].code.add("".concat(L.variableInputType.padEnd(10)," ").concat(L.node.elementType.type.padEnd(9)," ").concat(L.variableName,"[").concat(L.node.size,"];")):U[V].code.add("".concat(L.variableInputType.padEnd(10)," ").concat(L.node.type.padEnd(9)," ").concat(L.variableName,";")))}}var zt=L(65135);function GraphShaderModule_h(U){return new U}function GraphShaderModule_f(U,V,L){var X;const Q=null!==(X=U.constructor[V])&&void 0!==X?X:[];U.constructor.hasOwnProperty(V)||Object.defineProperty(U.constructor,V,{value:Q.slice()}),U.constructor[V].push(L)}function GraphShaderModule_l(U,V){return(L,X)=>{GraphShaderModule_f(L,"locations",{typeCtor:V,propertyKey:X,parameterIndex:null,index:U})}}const g=U=>(V,L,X)=>{GraphShaderModule_f(V,"inputs",{inputCtor:U,propertyKey:L,parameterIndex:X})},GraphShaderModule_=U=>(V,L)=>{GraphShaderModule_f(V,"uniforms",{typeCtor:U,propertyKey:L})},K=U=>(V,L)=>{GraphShaderModule_f(V,"options",{typeCtor:U,propertyKey:L})},x=(U,V)=>{GraphShaderModule_f(U,"defines",{propertyKey:V})};const I=(U,V)=>(L,X)=>{L.constructor.builtins.push({builtin:U,propertyKey:X,typeCtor:V})};class b{}b.builtins=[],(0,X._)([I("gl_VertexID",vt.Ai)],b.prototype,"glVertexID",void 0);class v{}class w{}w.builtins=[],(0,X._)([I("gl_FragCoord",vt.Zb)],w.prototype,"glFragCoord",void 0),(0,X._)([I("gl_PointCoord",vt.ZY)],w.prototype,"glPointCoord",void 0);class F{}(0,X._)([(U=>(V,L)=>{GraphShaderModule_f(V,"builtins",{builtin:U,propertyKey:L})})("gl_FragColor")],F.prototype,"glFragColor",void 0);class P{constructor(){this.type="uniform-group"}get _uniforms(){var U;return null!==(U=this.constructor.uniforms)&&void 0!==U?U:[]}}class j{constructor(){this.logShader=!1,this.computeAttributes={}}get vertexInput(){const U=(0,Q.Uk)(this._shaderModuleClass.inputs,(U=>"vertex"===U.propertyKey&&0===U.parameterIndex));if(!U)throw new Error("Unable to find vertex input parameter");return U}get computeInput(){return(0,Q.Uk)(this._shaderModuleClass.inputs,(U=>"vertex"===U.propertyKey&&1===U.parameterIndex))}get fragmentInput(){const U=(0,Q.Uk)(this._shaderModuleClass.inputs,(U=>"fragment"===U.propertyKey));if(!U)throw new Error("Unable to find fragment input parameter");return U}get transformFeedbackBindings(){var U;return null!==(U=this.fragmentInput.inputCtor.transformFeedbackBindings)&&void 0!==U?U:[]}get locations(){var U,V;return[...this.vertexInput.inputCtor.locations,...null!==(U=null===(V=this.computeInput)||void 0===V?void 0:V.inputCtor.locations)&&void 0!==U?U:[]]}get locationsMap(){const U=new Map,V=new Set;for(const L of this.locations)V.has(L.index)?$.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.GraphShaderModule").warnOnce("mapview-rendering","Unable to assigned attribute ".concat(L.propertyKey," to ").concat(L.index,". Index already in use"),{locationsMap:U}):(U.set(L.propertyKey,L.index),V.add(L.index));return U}get locationInfo(){if(!this._locationInfo){const U=this.locationsMap,V=Array.from(U.entries()).map((U=>{let[V,L]=U;return"".concat(V,".").concat(L)})).join("."),L=(0,J.Wm)(V);this._locationInfo={hash:L,locations:U}}return this._locationInfo}get renamedLocationsMap(){const U=new Map;for(const V of this.locations)U.set("a_"+V.propertyKey,V.index);return U}get optionPropertyKeys(){if(!this._optionPropertyKeys){const U=new Set;for(const V of this._options)U.add(V.propertyKey);this._optionPropertyKeys=U}return this._optionPropertyKeys}get _shaderModuleClass(){return this.constructor}get _defines(){var U;return null!==(U=this._shaderModuleClass.defines)&&void 0!==U?U:[]}get _options(){var U;return null!==(U=this._shaderModuleClass.options)&&void 0!==U?U:[]}get _uniforms(){var U;return null!==(U=this._shaderModuleClass.uniforms)&&void 0!==U?U:[]}getProgram(U,V,L,X){try{const{vertex:Q,fragment:$,uniformBindings:J}=this._generateShaders(U,V,L,X);return new zt.K(Q,$,this.renamedLocationsMap,this.locationInfo,J,this.transformFeedbackBindings)}catch(n){return console.error("Failed to create program",{error:n}),new zt.K("","",this.renamedLocationsMap,this.locationInfo,[],this.transformFeedbackBindings)}}getDebugUniformClassInfo(U){const V=this._options.find((V=>V.propertyKey===U));if(V)return{type:"option",className:V.typeCtor};const L=this._uniforms.find((V=>V.propertyKey===U));if(!L)throw new Error("Unable to find uniform class type for property: ".concat(U));return{type:"required",className:L.typeCtor}}getShaderKey(U,V,L,X){const Q=Object.keys(L).map((U=>"".concat(U,".").concat(L[U]))).join("."),$=Object.keys(X).map((U=>"".concat(U,".").concat(X[U]))).join("."),J=Object.keys(V).filter((U=>this.optionPropertyKeys.has(U)&&V[U])).join(".");return"".concat(this.constructor.name,".").concat(U.hash,".").concat(Q,".").concat($,".").concat(J)}_generateShaders(U,V,L,X){const Q=[];this._setDefines(L),this._setOptionalUniforms(Q,V),this._setRequiredUniforms(Q);const $=this._hydrateVertexInput(X),J=this._injectPackPrecisionFactor($,U),et=this._hydrateComputeInput(),st=et&&this._injectPackPrecisionFactor(et,U),ht=this.vertex(J,st),_t=this._hydrateFragmentInput(ht),vt=this.fragment(_t),zt=new Set;for(const Qt in vt){const U=vt[Qt];(0,Pt.rz)(zt,U)}const Et=this._getVertexInputBuiltins(),Ut=ShaderGraphContext_o.createVertex({...$,...et},ht,Et,Q,this.transformFeedbackBindings,zt);(new GlslGraphWriter_r).write(Ut);const Vt=this._getFragmentInputBuiltins(vt);Vt.set("glPointCoord","gl_PointCoord");const Lt=ShaderGraphContext_o.createFragment(_t,vt,Vt,Q,Ut,this.transformFeedbackBindings);(new GlslGraphWriter_r).write(Lt);const Ot=this._createShaderBuilder(Ut,Lt),Yt=Ot.generate("vertex",!1),qt=Ot.generate("fragment",!1);return this.logShader&&(console.log(Yt),console.log(qt)),{vertex:Yt,fragment:qt,uniformBindings:Q}}_setDefines(U){for(const V in U)this[V]=U[V]}_setOptionalUniforms(U,V){for(const L of this._options)V[L.propertyKey]?this[L.propertyKey]=this._hydrateUniformGroup(U,L):this[L.propertyKey]=null}_setRequiredUniforms(U){for(const V of this._uniforms)this[V.propertyKey]=this._hydrateUniformGroup(U,V)}_hydrateUniformGroup(U,V){const L=new(0,V.typeCtor);for(const Q of null!==(X=L._uniforms)&&void 0!==X?X:[]){var X;const $=GraphShaderModule_h(Q.typeCtor),J="u_".concat(V.propertyKey,"_").concat(Q.propertyKey),et=$.type,st=[V.propertyKey,Q.propertyKey].join(".");if("type"in Q.typeCtor&&"array"===Q.typeCtor.type){const V=$;U.push({shaderModulePath:st,uniformName:J,uniformType:et,uniformArrayLength:V.size,uniformArrayElementType:V.elementType.type,uniformHydrated:$})}else U.push({shaderModulePath:st,uniformName:J,uniformType:et,uniformHydrated:$});L[Q.propertyKey]=$}return L}_hydrateVertexInput(U){const V=this.vertexInput.inputCtor,L=V.locations.reduce(((V,L)=>!1===U[L.propertyKey]?V:{...V,[L.propertyKey]:GraphShaderModule_h(L.typeCtor)}),{});for(const{propertyKey:X,typeCtor:Q}of V.builtins){const U=GraphShaderModule_h(Q);L[X]=U}return L}_hydrateComputeInput(){return null==this.computeInput?null:this.computeInput.inputCtor.locations.reduce(((U,V)=>({...U,[V.propertyKey]:GraphShaderModule_h(V.typeCtor)})),{})}_injectPackPrecisionFactor(U,V){const L={};for(const X in U){const Q=U[X],$=V.attributes.find((U=>U.name===X));if(null!==$&&void 0!==$&&$.packPrecisionFactor){if("float"!==Q.type&&"vec2"!==Q.type&&"vec3"!==Q.type&&"vec4"!==Q.type)throw new Error("InternalError: packPrecisionFactor requires GenType, but found ".concat(Q.type));L[X]=Q.divide(new vt.nt($.packPrecisionFactor))}else L[X]=Q}return L}_hydrateFragmentInput(U){const V={};for(const L in U)V[L]=U[L];for(const{propertyKey:L,typeCtor:X}of w.builtins){const U=GraphShaderModule_h(X);V[L]=U}return V}_getVertexInputBuiltins(){const U=this.vertexInput.inputCtor,V=new Map;for(const{builtin:L,propertyKey:X}of U.builtins)V.set(X,L);return V}_getFragmentInputBuiltins(U){const V=U.constructor,L=new Map;for(const Q of null!==(X=V.builtins)&&void 0!==X?X:[]){var X;L.set(Q.propertyKey,Q.builtin)}return L}_createShaderBuilder(U,V){const L=new o;return this._insertDebugInfo(L),U.insertVertexShader(L),V.insertFragmentShader(L),L}_insertDebugInfo(U){U.vertex.code.add("// DEFINES: "),U.vertex.code.add("// --------------------------------------------------------- ");for(const V of this._defines)this[V.propertyKey]?U.vertex.code.add("//   ".concat(V.propertyKey,": true")):U.vertex.code.add("//   ".concat(V.propertyKey,": false"));U.vertex.code.add(""),U.vertex.code.add("// OPTIONS: "),U.vertex.code.add("// --------------------------------------------------------- ");for(const V of this._options)this[V.propertyKey]?U.vertex.code.add("//   ".concat(V.propertyKey,": true")):U.vertex.code.add("//   ".concat(V.propertyKey,": false"))}}},13401:(U,V,L)=>{function e(U,V){const L=[];for(L.push(V);L.length;){const V=L.pop();if("object"==typeof V&&!U.has(V.uid)){U.add(V.uid);for(const U of V.children)L.push(U)}}}L.d(V,{XL:()=>c,aw:()=>p,rR:()=>u,rz:()=>e,vA:()=>i,vL:()=>r,zg:()=>o});class s{constructor(){this.uid=s.NodeCount++,this._debugName=null,this._isMutable=!1,this.isImplicit=!1}get isMutable(){return this._isMutable}setMutable(){return this._isMutable=!0,this}setDebugName(U){return U=function t(U){return U.split(" ").map(((U,V)=>V>0?U.charAt(0).toUpperCase()+U.slice(1):U)).join("")}(U),this._debugName=U,this.isImplicit&&this.children[0]instanceof s&&this.children[0].setDebugName(U),this}get debugInfo(){var U;return{name:null!==(U=this._debugName)&&void 0!==U?U:""}}cloneInto(U){U._debugName=this._debugName,U._isMutable=this._isMutable,U.isImplicit=this.isImplicit,U.uid=this.uid}}function i(U){return"object"==typeof U?U.clone():U}s.NodeCount=0;class r extends s{constructor(){super(...arguments),this.shaderType="primitive-node"}}class n extends s{constructor(U){super(),this.child=U,this.shaderType="scope-node"}get children(){return[this.child]}clone(){const U=new n(i(this.child));return this.cloneInto(U),U}}class o extends s{constructor(U,V,L){super(),this.property=U,this.target=V,this.returnType=L,this.shaderType="property-access-node"}get children(){const U=[this.target];return"string"!=typeof this.property&&U.push(this.property),U}clone(){const U=new o(this.property,i(this.target),this.returnType);return this.cloneInto(U),U}}class c extends s{constructor(U,V,L){super(),this.condition=U,this.ifTrue=V,this.ifFalse=L,this.shaderType="condition-node"}get children(){return[this.condition,this.ifTrue,this.ifFalse]}clone(){const U=i(this.ifTrue),V=this.ifFalse?i(this.ifFalse):null,L=new c(this.condition,U,V);return this.cloneInto(L),L}}class u extends s{constructor(U,V,L,X){super(),this.captureList=U,this.returnType=V,this.generator=X,this.shaderType="block-node",L&&(this.subgraph=new n(L))}get children(){var U;return Object.keys(this.captureList).map((U=>this.captureList[U])).concat(null!==(U=this.subgraph)&&void 0!==U?U:[])}clone(){const U={};for(const L in this.captureList)U[L]=i(this.captureList[L]);const V=new u(U,this.returnType,this.subgraph?i(this.subgraph.child):this.subgraph,this.generator);return this.cloneInto(V),V}}class p extends s{constructor(U,V,L,X,Q){let $=arguments.length>5&&void 0!==arguments[5]&&arguments[5];super(),this.token=U,this._children=V,this.isInfix=L,this.isPropertyAccess=X,this.returnType=Q,this.isTernary=$,this.shaderType="function-node"}get children(){return this._children}clone(){const U=new p(this.token,this._children.map(i),this.isInfix,this.isPropertyAccess,this.returnType,this.isTernary);return this.cloneInto(U),U}}},42656:(U,V,L)=>{L.d(V,{$5:()=>jt,$I:()=>nt,AU:()=>Hn,Ai:()=>O,Bw:()=>kn,F8:()=>Wn,Io:()=>sn,LC:()=>Bt,MM:()=>Ct,My:()=>Yt,Om:()=>ln,PM:()=>ee,RI:()=>vn,S8:()=>Gn,Sj:()=>Dt,T9:()=>Bn,TF:()=>te,Tk:()=>xt,U:()=>tt,US:()=>se,Uo:()=>Rt,Wh:()=>rt,Xe:()=>St,ZY:()=>qt,Zb:()=>re,Zc:()=>it,aX:()=>Gt,eB:()=>Qt,eR:()=>ut,fV:()=>ct,gn:()=>tn,j1:()=>gt,jc:()=>bn,jh:()=>Sn,jk:()=>Un,ln:()=>ot,mk:()=>Wt,nf:()=>Nt,nt:()=>j,or:()=>Ht,qE:()=>Zt,tn:()=>Xt,w0:()=>lt,x:()=>Y,z7:()=>S,ze:()=>yt,zi:()=>jn});var X,Q,$,J,et,st,ht,_t,vt,Pt,zt,Et,Ut,Vt,Lt=L(80671),Ot=L(13401);function D(U){return new Proxy(U,{get(V,L){if("constructor"===L)return new Proxy(V.constructor,{construct:(U,V,L)=>D(new U(...V))});if(L in V)return V[L];if("string"==typeof L){const V=function z(U){const V=[["float","vec2","vec3","vec4"],["int","ivec2","ivec3","ivec4"],["uint","uvec2","uvec3","uvec4"],["bool","bvec2","bvec3","bvec4"]];for(const L of V)if(L.includes(U))return L.map((U=>fe[U]));throw new Error("Unable to find type family")}(U.type);return ft(U,L,V[L.length-1])}}})}function N(U){return new Proxy(U,{construct:(U,V,L)=>D(new U(...V))})}class B extends Error{}let Yt=X=class extends Ot.vL{constructor(U,V){super(),this.elementType=U,this.size=V,this.children=[],this.type="array"}clone(){const U=new X(this.elementType,this.size);return super.cloneInto(U),U}get(U){if("number"==typeof U){const V=new O(U);return V.isImplicit=!0,ft(this,V,this.elementType.constructor)}return ft(this,U,this.elementType.constructor)}last(){return this.get(this.size-1)}first(){return this.get(0)}findIndex(U,V,L){return function bt(U,V){let L=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,X=arguments.length>3&&void 0!==arguments[3]?arguments[3]:U.size;const Q=new O(L).setMutable().setDebugName("FindIndexIterator"),$=V(U.get(Q)).setDebugName("FindIndexPredicate"),J=mt({iter:Q},O,$,(U=>{let{out:V,iter:L,subgraph:Q}=U;return"\n".concat(V," = -1;\n\nfor (; ").concat(L," < ").concat(X,"; ").concat(L,"++) {\n\n").concat(Q.body,"\n\n  if (").concat(Q.varName,") {\n    ").concat(V," = ").concat(L,";\n    break;\n  }\n\n}\n")})).setDebugName("FindIndexBlock");return J}(this,U,V,L)}glslFindIndex(U,V,L){return function It(U,V){let L=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,X=arguments.length>3&&void 0!==arguments[3]?arguments[3]:U.size;const Q=mt({array:U},O,null,(U=>{let{out:Q,array:$}=U;return"\n".concat(Q," = -1;\nfor (int i = ").concat(L,"; i < ").concat(X,"; i++) {\n  bool condition;\n  ").concat(V({array:$,i:"i",out:"condition"}),"\n  if (condition) {\n    ").concat(Q," = i;\n    break;\n  }\n}\n")})).setDebugName("GlslFindIndexBlock");return Q}(this,U,V,L)}static ofType(U,V){const L={construct:(L,Q)=>new X(new U,V)};return new Proxy(X,L)}};Yt.type="array",Yt=X=(0,Lt._)([function q(U){return new Proxy(U,{construct:(U,V,L)=>function P(U){return new Proxy(U,{get(V,L){if(L in V)return V[L];if("string"==typeof L){const V=parseInt(L,10);if(!isNaN(V))return ft(U,"[".concat(V,"]"),U.elementType.constructor)}}})}(new U(...V))})}],Yt);class S extends Ot.vL{constructor(){super(...arguments),this.type="sampler2D",this.children=[]}clone(){const U=new S;return U.children=this.children.map(Ot.vA),super.cloneInto(U),U}}S.type="sampler2D";class j extends Ot.vL{constructor(U){super(),this.type="float",this.children=[U]}clone(){const U=new j((0,Ot.vA)(this.children[0]));return super.cloneInto(U),U}multiply(U){return Tt(this,"number"==typeof U?K(U,j):U)}divide(U){return $t(this,"number"==typeof U?K(U,j):U)}add(U){return Ft(this,"number"==typeof U?K(U,j):U)}subtract(U){return kt(this,"number"==typeof U?K(U,j):U)}}j.type="float";let qt=Q=class extends Ot.vL{constructor(U,V){super(),this.type="vec2",this.children=[U,V].filter((U=>null!=U))}clone(){const U=new Q((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]));return super.cloneInto(U),U}get 0(){return ft(this,"[0]",j)}get 1(){return ft(this,"[1]",j)}get 2(){throw new B}get 3(){throw new B}multiply(U){return Tt(this,"number"==typeof U?K(U,j):U)}divide(U){return $t(this,"number"==typeof U?K(U,j):U)}add(U){return Ft(this,"number"==typeof U?K(U,j):U)}subtract(U){return kt(this,"number"==typeof U?K(U,j):U)}};qt.type="vec2",qt=Q=(0,Lt._)([N],qt);let Qt=$=class extends Ot.vL{constructor(U,V,L){super(),this.type="vec3",this.children=[U,V,L].filter((U=>null!=U))}get 0(){return ft(this,"[0]",j)}get 1(){return ft(this,"[1]",j)}get 2(){return ft(this,"[2]",j)}get 3(){throw new B}clone(){const U=new $((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]),(0,Ot.vA)(this.children[2]));return super.cloneInto(U),U}multiply(U){return Tt(this,"number"==typeof U?K(U,j):U)}divide(U){return $t(this,"number"==typeof U?K(U,j):U)}add(U){return Ft(this,"number"==typeof U?K(U,j):U)}subtract(U){return kt(this,"number"==typeof U?K(U,j):U)}};Qt.type="vec3",Qt=$=(0,Lt._)([N],Qt);let re=J=class extends Ot.vL{constructor(U,V,L,X){super(),this.type="vec4",this.children=[U,V,L,X].filter((U=>null!=U))}clone(){const U=new J((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]),(0,Ot.vA)(this.children[2]),(0,Ot.vA)(this.children[3]));return super.cloneInto(U),U}get 0(){return ft(this,"[0]",j)}get 1(){return ft(this,"[1]",j)}get 2(){return ft(this,"[2]",j)}get 3(){return ft(this,"[3]",j)}multiply(U){return Tt(this,"number"==typeof U?K(U,j):U)}divide(U){return $t(this,"number"==typeof U?K(U,j):U)}add(U){return Ft(this,"number"==typeof U?K(U,j):U)}subtract(U){return kt(this,"number"==typeof U?K(U,j):U)}};re.type="vec4",re=J=(0,Lt._)([N],re);let ne=et=class extends Ot.vL{constructor(U){super(),this.type="uint",this.children=[U]}clone(){const U=new et((0,Ot.vA)(this.children[0]));return super.cloneInto(U),U}};ne.type="uint",ne=et=(0,Lt._)([N],ne);let ie=st=class extends Ot.vL{constructor(U,V){super(),this.type="uvec2",this.children=[U,V].filter((U=>null!=U))}clone(){const U=new st((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]));return super.cloneInto(U),U}};ie.type="uvec2",ie=st=(0,Lt._)([N],ie);let oe=ht=class extends Ot.vL{constructor(U,V,L){super(),this.type="uvec3",this.children=[U,V,L].filter((U=>null!=U))}clone(){const U=new ht((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]),(0,Ot.vA)(this.children[2]));return super.cloneInto(U),U}};oe.type="uvec3",oe=ht=(0,Lt._)([N],oe);let ae=_t=class extends Ot.vL{constructor(U,V,L,X){super(),this.type="uvec4",this.children=[U,V,L,X].filter((U=>null!=U))}clone(){const U=new _t((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]),(0,Ot.vA)(this.children[2]),(0,Ot.vA)(this.children[3]));return super.cloneInto(U),U}};ae.type="uvec4",ae=_t=(0,Lt._)([N],ae);class Y extends Ot.vL{constructor(U){super(),this.type="bool",this.children=[U]}and(U){return Rt(this,U)}or(U){return Ht(this,U)}clone(){const U=new Y((0,Ot.vA)(this.children[0]));return super.cloneInto(U),U}}Y.type="bool";let ce=vt=class extends Ot.vL{constructor(U,V){super(),this.type="bvec2",this.children=[U,V].filter((U=>null!=U))}all(){return Jt(this)}any(){return Kt(this)}clone(){const U=new vt((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]));return super.cloneInto(U),U}};ce.type="bvec2",ce=vt=(0,Lt._)([N],ce);let le=Pt=class extends Ot.vL{constructor(U,V,L){super(),this.type="bvec3",this.children=[U,V,L].filter((U=>null!=U))}all(){return Jt(this)}any(){return Kt(this)}clone(){const U=new Pt((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]),(0,Ot.vA)(this.children[2]));return super.cloneInto(U),U}};function K(U,V){return"number"==typeof U?new V(U):U}le.type="bvec3",le=Pt=(0,Lt._)([N],le);let ue=zt=class extends Ot.vL{constructor(U,V,L,X){super(),this.type="bvec4",this.children=[U,V,L,X].filter((U=>null!=U))}all(){return Jt(this)}any(){return Kt(this)}clone(){const U=new zt((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]),(0,Ot.vA)(this.children[2]),(0,Ot.vA)(this.children[3]));return super.cloneInto(U),U}};ue.type="bvec4",ue=zt=(0,Lt._)([N],ue);class O extends Ot.vL{constructor(U){super(),this.type="int",this.children=[U]}multiply(U){return Tt(this,K(U,O))}add(U){return Ft(this,K(U,O))}subtract(U){return kt(this,K(U,O))}divide(U){return $t(this,K(U,O))}clone(){const U=new O((0,Ot.vA)(this.children[0]));return super.cloneInto(U),U}}O.type="int";let he=Et=class extends Ot.vL{constructor(U,V){super(),this.type="ivec2",this.children=[U,V].filter((U=>null!=U))}clone(){const U=new Et((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]));return super.cloneInto(U),U}};he.type="ivec2",he=Et=(0,Lt._)([N],he);let de=Ut=class extends Ot.vL{constructor(U,V,L){super(),this.type="ivec3",this.children=[U,V,L].filter((U=>null!=U))}clone(){const U=new Ut((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]),(0,Ot.vA)(this.children[2]));return super.cloneInto(U),U}};de.type="ivec3",de=Ut=(0,Lt._)([N],de);let pe=Vt=class extends Ot.vL{constructor(U,V,L,X){super(),this.type="ivec4",this.children=[U,V,L,X].filter((U=>null!=U))}clone(){const U=new Vt((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]),(0,Ot.vA)(this.children[2]),(0,Ot.vA)(this.children[3]));return super.cloneInto(U),U}};pe.type="ivec4",pe=Vt=(0,Lt._)([N],pe);class Z extends Ot.vL{constructor(U,V,L,X){super(),this.type="mat2",this.children=[U,V,L,X]}clone(){const U=new Z((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]),(0,Ot.vA)(this.children[2]),(0,Ot.vA)(this.children[3]));return super.cloneInto(U),U}}Z.type="mat2";class tt extends Ot.vL{static identity(){return new tt(1,0,0,0,1,0,0,0,1)}static fromRotation(U){const V=Wn(U),L=tn(U);return new tt(L,V,0,yt(V),L,0,0,0,1)}constructor(U,V,L,X,Q,$,J,et,st){super(),this.type="mat3",this.children=[U,V,L,X,Q,$,J,et,st]}add(U){return Ft(this,U)}multiply(U){return Tt(this,U)}clone(){const U=new tt((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]),(0,Ot.vA)(this.children[2]),(0,Ot.vA)(this.children[3]),(0,Ot.vA)(this.children[4]),(0,Ot.vA)(this.children[5]),(0,Ot.vA)(this.children[6]),(0,Ot.vA)(this.children[7]),(0,Ot.vA)(this.children[8]));return super.cloneInto(U),U}}tt.type="mat3";class nt extends Ot.vL{static identity(){return new nt(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}constructor(U,V,L,X,Q,$,J,et,st,ht,_t,vt,Pt,zt,Et,Ut){super(),this.type="mat4",this.children=[U,V,L,X,Q,$,J,et,st,ht,_t,vt,Pt,zt,Et,Ut]}static fromColumns(U,V,L,X){return new nt(U.x,U.y,U.z,U.w,V.x,V.y,V.z,V.w,L.x,L.y,L.z,L.w,X.x,X.y,X.z,X.w)}multiply(U){return Tt(this,U)}clone(){const U=new nt((0,Ot.vA)(this.children[0]),(0,Ot.vA)(this.children[1]),(0,Ot.vA)(this.children[2]),(0,Ot.vA)(this.children[3]),(0,Ot.vA)(this.children[4]),(0,Ot.vA)(this.children[5]),(0,Ot.vA)(this.children[6]),(0,Ot.vA)(this.children[7]),(0,Ot.vA)(this.children[8]),(0,Ot.vA)(this.children[9]),(0,Ot.vA)(this.children[10]),(0,Ot.vA)(this.children[11]),(0,Ot.vA)(this.children[12]),(0,Ot.vA)(this.children[13]),(0,Ot.vA)(this.children[14]),(0,Ot.vA)(this.children[15]));return super.cloneInto(U),U}}nt.type="mat4";const fe={float:j,vec2:qt,vec3:Qt,vec4:re,int:O,ivec2:he,ivec3:de,ivec4:pe,uint:ne,uvec2:ie,uvec3:oe,uvec4:ae,bool:Y,bvec2:ce,bvec3:le,bvec4:ue},rt=function(){for(var U=arguments.length,V=new Array(U),L=0;L<U;L++)V[L]=arguments[L];return new O(...V)},ct=function(){for(var U=arguments.length,V=new Array(U),L=0;L<U;L++)V[L]=arguments[L];return new j(...V)},it=function(){for(var U=arguments.length,V=new Array(U),L=0;L<U;L++)V[L]=arguments[L];return new qt(...V)},ut=function(){for(var U=arguments.length,V=new Array(U),L=0;L<U;L++)V[L]=arguments[L];return new Qt(...V)},ot=function(){for(var U=arguments.length,V=new Array(U),L=0;L<U;L++)V[L]=arguments[L];return new re(...V)},lt=function(){for(var U=arguments.length,V=new Array(U),L=0;L<U;L++)V[L]=arguments[L];return new tt(...V)};function ft(U,V,L){const X=new L(new Ot.zg(V,U,L));return X.isImplicit=!0,X}function at(U,V,L){let X=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(X){const Q=new X,$=new X(new Ot.aw(U,[V,L],!0,!1,Q));return $.isImplicit=!0,$}if("float"===V.type||"int"===V.type){const X=new L.constructor(new Ot.aw(U,[V,L],!0,!1,L.constructor));return X.isImplicit=!0,X}if(("mat2"===V.type||"mat3"===V.type||"mat4"===V.type)&&"float"!==L.type){const X=new L.constructor(new Ot.aw(U,[V,L],!0,!1,L.constructor));return X.isImplicit=!0,X}const Q=new V.constructor(new Ot.aw(U,[V,L],!0,!1,V.constructor));return Q.isImplicit=!0,Q}function pt(U,V){let L=arguments.length>2&&void 0!==arguments[2]?arguments[2]:V.constructor;const X=new L(new Ot.aw(U,[V],!1,!1,L));return X.isImplicit=!0,X}function dt(U,V,L){let X=arguments.length>3&&void 0!==arguments[3]?arguments[3]:V.constructor;const Q=new X(new Ot.aw(U,[V,L],!1,!1,X));return Q.isImplicit=!0,Q}function wt(U,V,L,X){let Q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:V.constructor;const $=new Q(new Ot.aw(U,[V,L,X],!1,!1,Q));return $.isImplicit=!0,$}function yt(U){return Tt(U,ct(-1))}function mt(U,V,L,X){return new V(new Ot.rR(U,V,L,X))}function xt(U,V,L){const X="function"==typeof V?V():V,Q="function"==typeof L?L():L,$=new X.constructor(new Ot.XL(U,X,Q));return $.isImplicit=!0,$}function gt(){for(var U=arguments.length,V=new Array(U),L=0;L<U;L++)V[L]=arguments[L];const X=V.map((U=>{let[V,L]=U;return"function"==typeof L?[V,L()]:[V,L]})),Q=X[0][1].constructor,$=X.findIndex((U=>!0===U[0]));if(-1===$)throw new Error("A cond must have a fallthrough case with `true`/; ");const J=X.slice(0,$),et=X[$][1],st=new Q(J.reduceRight(((U,V)=>xt(V[0],V[1],U)),et));return st.isImplicit=!0,st}function Tt(U,V){return at("*",U,V)}function $t(U,V){return at("/",U,V)}function Ft(U,V){return at("+",U,V)}function kt(U,V){return at("-",U,V)}function Dt(U,V){return at(">>",U,V)}function Nt(U,V){return at("&",U,V)}function Bt(U,V){return at("==",U,V,Y)}function St(U,V){return at("<",U,V,Y)}function jt(U,V){return at("<=",U,V,Y)}function Ct(U,V){return at(">",U,V,Y)}function Gt(U,V){return at(">=",U,V,Y)}function Ht(){for(var U=arguments.length,V=new Array(U),L=0;L<U;L++)V[L]=arguments[L];return V.length<=1?V[0]:V.slice(1).reduce(((U,V)=>function Mt(U,V){return at("||",U,V,Y)}(U,V)),V[0])}function Rt(){for(var U=arguments.length,V=new Array(U),L=0;L<U;L++)V[L]=arguments[L];return V.length<=1?V[0]:V.slice(1).reduce(((U,V)=>function At(U,V){return at("&&",U,V,Y)}(U,V)),V[0])}function Xt(U){return pt("abs",U)}function Jt(U){return pt("all",U,Y)}function Kt(U){return pt("any",U,Y)}function Wt(U){return pt("ceil",U)}function Zt(U,V,L){return wt("clamp",U,V,L,U.constructor)}function tn(U){return pt("cos",U)}function sn(U,V){return dt("distance",U,V,j)}function ln(U,V){return dt("dot",U,V,j)}function vn(U){return pt("floor",U)}function bn(U){return pt("fract",U)}function kn(U){return pt("length",U,j)}function Bn(U,V){return dt("max",U,V)}function Un(U,V){return dt("min",U,V)}function Sn(U,V,L){return wt("mix",U,V,L)}function jn(U,V){return dt("mod",U,V)}function Gn(U){return pt("normalize",U)}function Hn(U){return"bool"===U.type?pt("!",U):pt("not",U)}function Wn(U){return pt("sin",U)}function te(U,V,L){return wt("smoothstep",U,V,L)}function ee(U,V){return dt("step",U,V,V.constructor)}function se(U,V){return dt("texture2D",U,V,re)}},19578:(U,V,L)=>{L.d(V,{c:()=>X});const X={bitset:{isSDF:0,isMapAligned:1,scaleSymbolsProportionally:2,overrideOutlineColor:3,colorLocked:4}}},14149:(U,V,L)=>{L.d(V,{Y:()=>er});var X=L(50886),Q=L(32095),$=(L(42687),L(5144)),J=L(41156),et=L(80271);function bufcut_e(U,V,L,X,Q,$,J){ht=0;const et=(X-L)*$,st=Q&&Q.length,_t=st?(Q[0]-L)*$:et;let vt,Pt,zt,Et,Ut,Vt=n(V,L,X,0,_t,$,!0);if(Vt&&Vt.next!==Vt.prev){if(st&&(Vt=f(V,L,X,Q,Vt,$)),et>80*$){vt=zt=V[0+L*$],Pt=Et=V[1+L*$];for(let U=$;U<_t;U+=$){const X=V[U+L*$],Q=V[U+1+L*$];vt=Math.min(vt,X),Pt=Math.min(Pt,Q),zt=Math.max(zt,X),Et=Math.max(Et,Q)}Ut=Math.max(zt-vt,Et-Pt),Ut=0!==Ut?1/Ut:0}x(Vt,U,$,vt,Pt,Ut,J,0)}}function n(U,V,L,X,Q,$,J){let et;if(J===function Z(U,V,L,X,Q,$){let J=0;for(let et=X,st=Q-$;et<Q;et+=$)J+=(U[st+V*$]-U[et+V*$])*(U[et+1+V*$]+U[st+1+V*$]),st=et;return J}(U,V,0,X,Q,$)>0)for(let st=X;st<Q;st+=$)et=u(st+V*$,U[st+V*$],U[st+1+V*$],et);else for(let st=Q-$;st>=X;st-=$)et=u(st+V*$,U[st+V*$],U[st+1+V*$],et);return et&&M(et,et.next)&&(o(et),et=et.next),et}function bufcut_t(U){let V=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U;if(!U)return U;let L,X=U;do{if(L=!1,X.steiner||!M(X,X.next)&&0!==s(X.prev,X,X.next))X=X.next;else{if(o(X),X=V=X.prev,X===X.next)break;L=!0}}while(L||X!==V);return V}function x(U,V,L,X,Q,$,J,et){if(!U)return;!et&&$&&(U=c(U,X,Q,$));let st=U;for(;U.prev!==U.next;){const ht=U.prev,_t=U.next;if($?i(U,X,Q,$):r(U))V.push(ht.index/L+J),V.push(U.index/L+J),V.push(_t.index/L+J),o(U),U=_t.next,st=_t.next;else if((U=_t)===st){et?1===et?x(U=b(U,V,L,J),V,L,X,Q,$,J,2):2===et&&g(U,V,L,X,Q,$,J):x(bufcut_t(U),V,L,X,Q,$,J,1);break}}}function r(U){const V=U.prev,L=U,X=U.next;if(s(V,L,X)>=0)return!1;let Q=U.next.next;const $=Q;let J=0;for(;Q!==U.prev&&(0===J||Q!==$);){if(J++,a(V.x,V.y,L.x,L.y,X.x,X.y,Q.x,Q.y)&&s(Q.prev,Q,Q.next)>=0)return!1;Q=Q.next}return!0}function i(U,V,L,X){const Q=U.prev,$=U,J=U.next;if(s(Q,$,J)>=0)return!1;const et=Q.x<$.x?Q.x<J.x?Q.x:J.x:$.x<J.x?$.x:J.x,st=Q.y<$.y?Q.y<J.y?Q.y:J.y:$.y<J.y?$.y:J.y,ht=Q.x>$.x?Q.x>J.x?Q.x:J.x:$.x>J.x?$.x:J.x,_t=Q.y>$.y?Q.y>J.y?Q.y:J.y:$.y>J.y?$.y:J.y,vt=z(et,st,V,L,X),Pt=z(ht,_t,V,L,X);let zt=U.prevZ,Et=U.nextZ;for(;zt&&zt.z>=vt&&Et&&Et.z<=Pt;){if(zt!==U.prev&&zt!==U.next&&a(Q.x,Q.y,$.x,$.y,J.x,J.y,zt.x,zt.y)&&s(zt.prev,zt,zt.next)>=0)return!1;if(zt=zt.prevZ,Et!==U.prev&&Et!==U.next&&a(Q.x,Q.y,$.x,$.y,J.x,J.y,Et.x,Et.y)&&s(Et.prev,Et,Et.next)>=0)return!1;Et=Et.nextZ}for(;zt&&zt.z>=vt;){if(zt!==U.prev&&zt!==U.next&&a(Q.x,Q.y,$.x,$.y,J.x,J.y,zt.x,zt.y)&&s(zt.prev,zt,zt.next)>=0)return!1;zt=zt.prevZ}for(;Et&&Et.z<=Pt;){if(Et!==U.prev&&Et!==U.next&&a(Q.x,Q.y,$.x,$.y,J.x,J.y,Et.x,Et.y)&&s(Et.prev,Et,Et.next)>=0)return!1;Et=Et.nextZ}return!0}function u(U,V,L,X){const Q=q.create(U,V,L);return X?(Q.next=X.next,Q.prev=X,X.next.prev=Q,X.next=Q):(Q.prev=Q,Q.next=Q),Q}function o(U){U.next.prev=U.prev,U.prev.next=U.next,U.prevZ&&(U.prevZ.nextZ=U.nextZ),U.nextZ&&(U.nextZ.prevZ=U.prevZ)}function l(U){let V=U,L=U;do{(V.x<L.x||V.x===L.x&&V.y<L.y)&&(L=V),V=V.next}while(V!==U);return L}function f(U,V,L,X,Q,$){const J=new Array;for(let et=0,st=X.length;et<st;et++){const Q=n(U,V,0,X[et]*$,et<st-1?X[et+1]*$:L*$,$,!1);Q===Q.next&&(Q.steiner=!0),J.push(l(Q))}J.sort(m);for(const et of J)Q=y(et,Q);return Q}function y(U,V){const L=function p(U,V){let L=V;const X=U.x,Q=U.y;let $,J=-1/0;do{if(Q<=L.y&&Q>=L.next.y&&L.next.y!==L.y){const U=L.x+(Q-L.y)*(L.next.x-L.x)/(L.next.y-L.y);if(U<=X&&U>J){if(J=U,U===X){if(Q===L.y)return L;if(Q===L.next.y)return L.next}$=L.x<L.next.x?L:L.next}}L=L.next}while(L!==V);if(!$)return null;if(X===J)return $.prev;const et=$,st=$.x,ht=$.y;let _t,vt=1/0;for(L=$.next;L!==et;)X>=L.x&&L.x>=st&&X!==L.x&&a(Q<ht?X:J,Q,st,ht,Q<ht?J:X,Q,L.x,L.y)&&(_t=Math.abs(Q-L.y)/(X-L.x),(_t<vt||_t===vt&&L.x>$.x)&&w(L,U)&&($=L,vt=_t)),L=L.next;return $}(U,V);if(!L)return V;const X=j(L,U);return bufcut_t(X,X.next),bufcut_t(L,L.next)}function c(U,V,L,X){let Q;for(;Q!==U;Q=Q.next){if(Q=Q||U,null===Q.z&&(Q.z=z(Q.x,Q.y,V,L,X)),Q.prev.next!==Q||Q.next.prev!==Q)return Q.prev.next=Q,Q.next.prev=Q,c(U,V,L,X);Q.prevZ=Q.prev,Q.nextZ=Q.next}return U.prevZ.nextZ=null,U.prevZ=null,function v(U){let V,L=1;for(;;){let X,Q=U;U=null,V=null;let $=0;for(;Q;){$++,X=Q;let J=0;for(;J<L&&X;J++)X=X.nextZ;let et=L;for(;J>0||et>0&&X;){let L;0===J?(L=X,X=X.nextZ,et--):0!==et&&X?Q.z<=X.z?(L=Q,Q=Q.nextZ,J--):(L=X,X=X.nextZ,et--):(L=Q,Q=Q.nextZ,J--),V?V.nextZ=L:U=L,L.prevZ=V,V=L}Q=X}if(V.nextZ=null,L*=2,$<2)return U}}(U)}function s(U,V,L){return(V.y-U.y)*(L.x-V.x)-(V.x-U.x)*(L.y-V.y)}function h(U,V,L,X){return!!(M(U,V)&&M(L,X)||M(U,X)&&M(L,V))||s(U,V,L)>0!=s(U,V,X)>0&&s(L,X,U)>0!=s(L,X,V)>0}function a(U,V,L,X,Q,$,J,et){return(Q-J)*(V-et)-(U-J)*($-et)>=0&&(U-J)*(X-et)-(L-J)*(V-et)>=0&&(L-J)*($-et)-(Q-J)*(X-et)>=0}function w(U,V){return s(U.prev,U,U.next)<0?s(U,V,U.next)>=0&&s(U,U.prev,V)>=0:s(U,V,U.prev)<0||s(U,U.next,V)<0}function z(U,V,L,X,Q){return(U=1431655765&((U=858993459&((U=252645135&((U=16711935&((U=32767*(U-L)*Q)|U<<8))|U<<4))|U<<2))|U<<1))|(V=1431655765&((V=858993459&((V=252645135&((V=16711935&((V=32767*(V-X)*Q)|V<<8))|V<<4))|V<<2))|V<<1))<<1}function M(U,V){return U.x===V.x&&U.y===V.y}function m(U,V){return U.x-V.x}function b(U,V,L,X){let Q=U;do{const $=Q.prev,J=Q.next.next;!M($,J)&&h($,Q,Q.next,J)&&w($,J)&&w(J,$)&&(V.push($.index/L+X),V.push(Q.index/L+X),V.push(J.index/L+X),o(Q),o(Q.next),Q=U=J),Q=Q.next}while(Q!==U);return Q}function g(U,V,L,X,Q,$,J){let et=U;do{let U=et.next.next;for(;U!==et.prev;){if(et.index!==U.index&&k(et,U)){let st=j(et,U);return et=bufcut_t(et,et.next),st=bufcut_t(st,st.next),x(et,V,L,X,Q,$,J,0),void x(st,V,L,X,Q,$,J,0)}U=U.next}et=et.next}while(et!==U)}function k(U,V){return U.next.index!==V.index&&U.prev.index!==V.index&&!function d(U,V){let L=U;do{if(L.index!==U.index&&L.next.index!==U.index&&L.index!==V.index&&L.next.index!==V.index&&h(L,L.next,U,V))return!0;L=L.next}while(L!==U);return!1}(U,V)&&w(U,V)&&w(V,U)&&function A(U,V){let L=U,X=!1;const Q=(U.x+V.x)/2,$=(U.y+V.y)/2;do{L.y>$!=L.next.y>$&&L.next.y!==L.y&&Q<(L.next.x-L.x)*($-L.y)/(L.next.y-L.y)+L.x&&(X=!X),L=L.next}while(L!==U);return X}(U,V)}function j(U,V){const L=q.create(U.index,U.x,U.y),X=q.create(V.index,V.x,V.y),Q=U.next,$=V.prev;return U.next=V,V.prev=U,L.next=Q,Q.prev=L,X.next=L,L.prev=X,$.next=X,X.prev=$,X}class q{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(U,V,L){const X=ht<st.length?st[ht++]:new q;return X.index=U,X.x=V,X.y=L,X.prev=null,X.next=null,X.z=null,X.prevZ=null,X.nextZ=null,X.steiner=!1,X}}const st=[];let ht=0;for(let rr=0;rr<8096;rr++)st.push(new q);const _t=new $.O3(0,0,0,1,0),vt=new $.O3(0,0,0,1,0);function templateUtils_u(U,V,L){let X=0;for(let Q=1;Q<L;Q++){const L=U[2*(V+Q-1)],$=U[2*(V+Q-1)+1];X+=(U[2*(V+Q)]-L)*(U[2*(V+Q)+1]+$)}return X}function templateUtils_h(U,V,L,X,Q){let $=0;for(let J=L;J<X;J+=3){const L=2*(U[J]-Q),X=2*(U[J+1]-Q),et=2*(U[J+2]-Q);$+=Math.abs((V[L]-V[et])*(V[X+1]-V[L+1])-(V[L]-V[X])*(V[et+1]-V[L+1]))}return $}_t.setExtent(et.CQ),vt.setExtent(et.CQ);var Pt=L(33303),zt=L(17865);let Et=null;function loadGeometryEngine_t(){return Et}var Ut=L(78844),Vt=L(26838),Lt=L(60985);function AlignedVertexSpec_s(U){switch(U){case Lt.pe.BYTE:case Lt.pe.UNSIGNED_BYTE:return 1;case Lt.pe.SHORT:case Lt.pe.UNSIGNED_SHORT:return 2;case Lt.pe.FLOAT:case Lt.pe.INT:case Lt.pe.UNSIGNED_INT:return 4}}class AlignedVertexSpec_n{static fromVertexSpec(U,V){let L,X,Q,{attributes:$}=U;const J=[];for(const zt in $){const U=$[zt];!1!==(null===V||void 0===V?void 0:V[zt])&&("position"===U.pack?L={...U,name:zt,offset:0}:"id"===U.pack?X={...U,name:zt,offset:4}:"bitset"===zt?Q={...U,name:zt,offset:7}:J.push({...U,name:zt}))}const et=function AlignedVertexSpec_o(U){const V=[],L=[],X=[];for(const Q of U){const U=AlignedVertexSpec_s(Q.type)*Q.count;switch(U%2||U%4||4){case 4:V.push(Q);continue;case 2:L.push(Q);continue;case 1:X.push(Q);continue;default:throw new Error("Found unexpected dataType byte count")}}return V.push(...L),V.push(...X),V}(J),st=[];let ht=8,_t=1;for(const zt of et)st.push({...zt,offset:ht}),ht+=AlignedVertexSpec_s(zt.type)*zt.count,zt.packAlternating&&(_t=Math.max(zt.packAlternating.count,_t));const vt=Uint32Array.BYTES_PER_ELEMENT,Pt=ht%vt;return new AlignedVertexSpec_n(L,X,Q,st,ht+(Pt?vt-Pt:0),_t)}constructor(U,V,L,X,Q,$){this.position=U,this.id=V,this.bitset=L,this.standardAttributes=X,this.stride=Q,this.packVertexCount=$,X.push(L),this._attributes=[U,V,L,...X]}get attributeLayout(){if(!this._attributeLayout){const U=(0,Vt.h)(this._attributes),V=this._attributes.map((U=>{var V;return{name:U.name,count:U.count,offset:U.offset,type:U.type,packPrecisionFactor:U.packPrecisionFactor,normalized:null!==(V=U.normalized)&&void 0!==V&&V}}));this._attributeLayout={attributes:V,hash:U,stride:this.stride}}return this._attributeLayout}}var Ot=L(88101);class MeshWriterVertexPack_i{static fromVertexSpec(U,V){const L=AlignedVertexSpec_n.fromVertexSpec(U,V);return new MeshWriterVertexPack_i(L)}constructor(U){this._spec=U,this._packed=new Uint8Array(this._spec.stride*this._spec.packVertexCount),this._packedU32View=new Uint32Array(this._packed.buffer),this._dataView=new DataView(this._packed.buffer)}get attributeLayout(){return this._spec.attributeLayout}get stride(){return this._spec.stride}writeVertex(U,V,L,X,Q,$){for(let et=0;et<this._spec.packVertexCount;et++){const U=et*this._spec.stride;this._packPosition(L,X,U),this._packId(V,U);const st=this._spec.bitset;if($){if(st.packTessellation){const V=st.packTessellation($,Q);this._pack(V,st,U)}for(const V of this._spec.standardAttributes){var J;if(null!=V.packTessellation){const L=V.packTessellation($,Q);this._pack(L,V,U)}else if(null!==(J=V.packAlternating)&&void 0!==J&&J.packTessellation){const U=V.packAlternating.packTessellation($,Q);for(let L=0;L<this._spec.packVertexCount;L++){const X=U[L];this._pack(X,V,L*this._spec.stride)}}}}}U.vertexWriteRegion(this._packedU32View)}pack(U,V){for(const X of this._spec.standardAttributes){var L;if(X.pack&&"string"!=typeof X.pack){const L=X.pack(U,V);for(let U=0;U<this._spec.packVertexCount;U++)this._pack(L,X,U*this._spec.stride)}else if(null!==(L=X.packAlternating)&&void 0!==L&&L.pack){const L=X.packAlternating.pack(U,V);for(let U=0;U<this._spec.packVertexCount;U++){const V=L[U];this._pack(V,X,U*this._spec.stride)}}}}_packPosition(U,V,L){var X;const{offset:Q}=this._spec.position,$=null!==(X=this._spec.position.packPrecisionFactor)&&void 0!==X?X:1,J=(0,Ut.M9)(U*$,V*$);this._dataView.setUint32(L+Q,J,!0)}_packId(U,V){var L;const X=U*(null!==(L=this._spec.id.packPrecisionFactor)&&void 0!==L?L:1),Q=4278190080&this._dataView.getUint32(V+this._spec.id.offset,!0);this._dataView.setUint32(V+this._spec.id.offset,X|Q,!0)}_pack(U,V,L){(0,Ot.F)(this._dataView,U,V,L)}}class MeshWriter_o{constructor(U,V,L,X){this._instanceId=U,this._evaluator=V,this._viewParams=L,this._optionalAttributes=X,this._evaluator.evaluator=U=>this.vertexSpec.createComputedParams(U)}get _vertexPack(){if(!this._cachedVertexPack){const U=MeshWriterVertexPack_i.fromVertexSpec(this.vertexSpec,this._optionalAttributes);this._evaluator.hasDynamicProperties||U.pack(this._evaluator.evaluatedMeshParams,this._viewParams),this._cachedVertexPack=U}return this._cachedVertexPack}get evaluatedMeshParams(){return this._evaluator.evaluatedMeshParams}get hasEffects(){return!!this.evaluatedMeshParams.effects}get instanceId(){return this._instanceId}get attributeLayout(){return this._vertexPack.attributeLayout}setReferences(U){this._references=U}getBoundsInfo(){return null}getTileInfo(){return this._viewParams.tileInfo}async loadDependencies(){var U;(function MeshWriter_i(U){if(!U)return!1;for(const V of U)switch(V.effect.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1})(null===(U=this._evaluator.inputMeshParams.params.effects)||void 0===U?void 0:U.effectInfos)&&await async function e(){Et=await Promise.all([L.e(8300),L.e(3901)]).then(L.bind(L,93901))}()}enqueueRequest(U,V,L){this._evaluator.hasDynamicProperties&&this._evaluator.enqueueRequest(U,V,L)}write(U,V,L,X,Q){var $;this.ensurePacked(V,L,X);const J=this.evaluatedMeshParams.effects;if(!J||0===J.length)return void this._write(U,L,void 0,Q);const et=null===($=L.readGeometryForDisplay())||void 0===$?void 0:$.clone();if(!et)return;const st=Pt.z.fromOptimizedCIM(et,L.geometryType),ht=loadGeometryEngine_t();st.invertY();const _t=U.id||"",vt=zt.V.executeEffects(J,st,_t,ht);let Et;for(;Et=vt.next();)Et.invertY(),this._write(U,L,Et,Q)}ensurePacked(U,V,L){if(!this._evaluator.hasDynamicProperties)return;const X=this._evaluator.evaluateMeshParams(U,V,L);this._vertexPack.pack(X,this._viewParams)}_writeVertex(U,V,L,X,Q){const $=this.evaluatedMeshParams;this._vertexPack.writeVertex(U,V,L,X,$,Q)}}const Yt=(0,X.A)("featurelayer-fast-triangulation-enabled");class AFillMeshWriter_a extends MeshWriter_o{async loadDependencies(){await Promise.all([super.loadDependencies(),(0,Q.F)()])}_write(U,V,L){var X;const Q=null!==(X=null===L||void 0===L?void 0:L.asOptimized())&&void 0!==X?X:V.readGeometryForDisplay(),$=this._clip(Q);$&&(U.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(U,V,$),U.recordEnd())}_clip(U){if(!U)return null;return function templateUtils_d(U,V){if(null==U)return null;if(!function templateUtils_m(U,V,L){let X=0;for(let Q=0;Q<U.lengths.length;Q++){const $=U.lengths[Q];for(let Q=0;Q<$;Q++){const $=U.coords[2*(Q+X)],J=U.coords[2*(Q+X)+1];if($<V||$>L||J<V||J>L)return!0}X+=$}return!1}(U,-128,et.CQ+128))return U;_t.setPixelMargin(V),_t.reset($.dC.Polygon);let L=0;for(let $=0;$<U.lengths.length;$++){const V=U.lengths[$];let X=U.coords[2*(0+L)],Q=U.coords[2*(0+L)+1];_t.moveTo(X,Q);for(let $=1;$<V;$++)X=U.coords[2*($+L)],Q=U.coords[2*($+L)+1],_t.lineTo(X,Q);_t.close(),L+=V}const X=_t.result(!1);if(!X)return null;const Q=[],st=[];for(const $ of X){let U=0;for(const V of $)st.push(V.x),st.push(V.y),U++;Q.push(U)}return new J.A(Q,st)}(U,this.hasEffects?256:8)}_writeGeometry(U,V,L){const X=L.maxLength>100,$=[],J=this.createTesselationParams(V);if(!X&&Yt&&function templateUtils_a(U,V){const{coords:L,lengths:X,hasIndeterminateRingOrder:Q}=V,$=U;if(Q)return!1;let J=0;for(let et=0;et<X.length;){let U=et,V=X[et],Q=templateUtils_u(L,J,V);const st=[];for(;++U<X.length;){const $=X[U],et=templateUtils_u(L,J+V,$);if(!(et>0))break;Q+=et,st.push(J+V),V+=$}const ht=$.length;bufcut_e($,L,J,J+V,st,2,0);const _t=templateUtils_h($,L,ht,$.length,0),vt=Math.abs(Q);if(Math.abs((_t-vt)/Math.max(1e-7,vt))>1e-5)return $.length=0,!1;et=U,J+=V}return!0}($,L))return void($.length&&this._writeVertices(U,V,L.coords,J,$));const et=function templateUtils_p(U){const{coords:V,lengths:L}=U,{buffer:X}=(0,Q.l)(V,L);return X}(L);this._writeVertices(U,V,et,J)}_writeVertices(U,V,L,X,Q){const $=V.getDisplayId(),J=U.vertexCount(),et=this.hasEffects;let st=0;if(Q)for(const ht of Q){const V=L[2*ht],Q=L[2*ht+1];et&&U.recordBounds(V,Q,0,0),this._writeVertex(U,$,V,Q,X),st++}else for(let ht=0;ht<L.length;ht+=2){const V=Math.round(L[ht]),Q=Math.round(L[ht+1]);et&&U.recordBounds(V,Q,0,0),this._writeVertex(U,$,V,Q,X),st++}U.indexEnsureSize(st);for(let ht=0;ht<st;ht++)U.indexWrite(ht+J)}}const qt={createComputedParams:U=>U,attributes:{id:{type:Lt.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Lt.pe.UNSIGNED_BYTE,count:1},pos:{type:Lt.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},inverseArea:{type:Lt.pe.FLOAT,count:1,packTessellation:U=>{let{inverseArea:V}=U;return V}}}};var Qt=L(62555),re=L(29457),ne=L(22123),ie=L(4180),oe=L(89412),ae=L(64032);function meshWriterUtils_m(U,V){return[!(null===U||void 0===U||!U.minScale)&&V.scaleToZoom(U.minScale)||0,!(null===U||void 0===U||!U.maxScale)&&V.scaleToZoom(U.maxScale)||100]}function meshWriterUtils_f(U){return 1<<U}function meshWriterUtils_l(U){let V=0;for(const[L,X]of U)X&&(V|=1<<L);return V}function meshWriterUtils_h(U){let V;if(!U)return[0,0,0,0];if("string"==typeof U){const L=ne.A.fromString(U);if(!L)return oe.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.meshWriterUtils").errorOnce(new ie.A("mapview:mesh-processing","Unable to parse string into color",{color:U})),[0,0,0,0];V=L.toArray()}else V=U;const[L,X,Q,$]=V;return[L*($/255),X*($/255),Q*($/255),$]}function meshWriterUtils_d(U,V){return Math.round(Math.min(Math.sqrt(U*V),255))}function meshWriterUtils_M(U,V){return Math.round(U*V)/V}function S(U,V){return Math.ceil(U*V)/V}const ce={createComputedParams:U=>U,attributes:{id:{type:Lt.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Lt.pe.UNSIGNED_BYTE,count:1},pos:{type:Lt.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},zoomRange:{type:Lt.pe.SHORT,count:2,packPrecisionFactor:et.fq,pack:(U,V)=>{let{scaleInfo:L}=U,{tileInfo:X}=V;return meshWriterUtils_m(L,X)}},color:{type:Lt.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:U=>{let{color:V}=U;return meshWriterUtils_h(V)}}}};class FillMeshWriter_i extends AFillMeshWriter_a{constructor(){super(...arguments),this.vertexSpec=ce}createTesselationParams(U){return null}}const le={createComputedParams:U=>U,attributes:{...ce.attributes,tlbr:{count:4,type:Lt.pe.UNSIGNED_SHORT,pack:U=>{let{sprite:V}=U;const{rect:L,width:X,height:Q}=V,$=L.x+et.hM,J=L.y+et.hM;return[$,J,$+X,J+Q]}},inverseRasterizationScale:{count:1,type:Lt.pe.BYTE,packPrecisionFactor:16,pack:U=>{let{sprite:V}=U;return 1/V.rasterizationScale}}}};class PatternFillMeshWriter_a extends FillMeshWriter_i{constructor(){super(...arguments),this.vertexSpec=le}_write(U,V,L){var X,Q;const $=null!==(X=null===L||void 0===L?void 0:L.asOptimized())&&void 0!==X?X:V.readGeometryForDisplay(),J=this._clip($);if(!J)return;const et=null===(Q=this.evaluatedMeshParams.sprite)||void 0===Q?void 0:Q.textureBinding;U.recordStart(this.instanceId,this.attributeLayout,et),this._writeGeometry(U,V,J),U.recordEnd()}}var ue=L(11865);function ComplexFillMeshWriter_l(U){const{sprite:V,aspectRatio:L,scaleProportionally:X}=U,Q=(0,Qt.Lz)(U.height),$=Q>0?Q:V.height;let J=Q*L;return J<=0?J=V.width:X&&(J*=V.width/V.height),{width:J,height:$}}function ComplexFillMeshWriter_m(U){const{applyRandomOffset:V,sampleAlphaOnly:L}=U,{width:X,height:Q}=ComplexFillMeshWriter_l(U);return meshWriterUtils_l([[ue.Fz,V],[ue.cn,L],[ue.A,X<et.Tv],[ue.lx,Q<et.Tv]])}function ComplexFillMeshWriter_f(U){const{width:V}=ComplexFillMeshWriter_l(U);return Math.round(V<et.Tv?V*et.bg:V)}function ComplexFillMeshWriter_d(U){const{height:V}=ComplexFillMeshWriter_l(U);return Math.round(V<et.Tv?V*et.bg:V)}const he={createComputedParams:U=>U,attributes:{...le.attributes,bitset:{count:1,type:Lt.pe.UNSIGNED_BYTE,pack:ComplexFillMeshWriter_m},width:{count:1,type:Lt.pe.UNSIGNED_SHORT,pack:ComplexFillMeshWriter_f},height:{count:1,type:Lt.pe.UNSIGNED_SHORT,pack:ComplexFillMeshWriter_d},offset:{count:2,type:Lt.pe.SHORT,pack:U=>{let{offsetX:V,offsetY:L}=U;return[(0,Qt.Lz)(V),-(0,Qt.Lz)(L)]}},scale:{count:2,type:Lt.pe.UNSIGNED_BYTE,packPrecisionFactor:16,pack:U=>{let{scaleX:V,scaleY:L}=U;return[V,L]}},angle:{count:1,type:Lt.pe.UNSIGNED_BYTE,pack:U=>{let{angle:V}=U;return(0,re.wV)(V)}}}};var de=L(11635);class LineMeshWriter_d{constructor(){this.extrusionOffsetX=0,this.extrusionOffsetY=0,this.normalX=0,this.normalY=0,this.directionX=0,this.directionY=0,this.distance=0}}const pe={createComputedParams:U=>U,attributes:{id:{type:Lt.pe.UNSIGNED_BYTE,count:3,pack:"id"},pos:{type:Lt.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},bitset:{type:Lt.pe.UNSIGNED_BYTE,count:1},zoomRange:{type:Lt.pe.SHORT,count:2,packPrecisionFactor:et.fq,pack:(U,V)=>{let{scaleInfo:L}=U,{tileInfo:X}=V;return meshWriterUtils_m(L,X)}},color:{type:Lt.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:U=>{let{color:V}=U;return meshWriterUtils_h(V)}},offset:{type:Lt.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:U=>{let{extrusionOffsetX:V,extrusionOffsetY:L}=U;return[meshWriterUtils_M(V,16),meshWriterUtils_M(L,16)]}},normal:{type:Lt.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:U=>{let{normalX:V,normalY:L}=U;return[meshWriterUtils_M(V,16),meshWriterUtils_M(L,16)]}},halfWidth:{type:Lt.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:16,pack:U=>{let{width:V}=U;return S((0,Qt.Lz)(.5*V),16)}},referenceHalfWidth:{type:Lt.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:16,pack:U=>{let{referenceWidth:V}=U;return S((0,Qt.Lz)(.5*V),16)}}}};class _{constructor(){this.id=0,this.bitset=0,this.indexCount=0,this.vertexCount=0,this.vertexFrom=0,this.vertexBounds=0}}class T extends MeshWriter_o{constructor(U,V,L,X){super(U,V,L,X),this.vertexSpec=pe,this._currentWrite=new _,this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0,wrapDistance:65535,textured:!1},this._tessParams=new LineMeshWriter_d,this._initializeTessellator()}writeLineVertices(U,V,L){const X=this._getLines(V);null!=X&&this._writeVertices(U,L,X)}_initializeTessellator(){this._lineTessellator=new de.i(this._writeTesselatedVertex.bind(this),this._writeTriangle.bind(this),!0)}_write(U,V,L){const X=null!==L&&void 0!==L?L:Pt.z.fromFeatureSetReaderCIM(V);X&&this._writeGeometry(U,V,X)}_writeGeometry(U,V,L,X){U.recordStart(this.instanceId,this.attributeLayout,X),this.writeLineVertices(U,L,V),U.recordEnd()}_getLines(U){return function templateUtils_x(U,V){vt.setPixelMargin(V);const L=vt,X=-V,Q=et.CQ+V;let J=[],st=!1;if(!U.nextPath())return null;let ht=!0;for(;ht;){U.seekPathStart();const V=[];if(!U.pathSize)return null;L.reset($.dC.LineString),U.nextPoint();let et=U.x,_t=U.y;if(st)L.moveTo(et,_t);else{if(et<X||et>Q||_t<X||_t>Q){st=!0;continue}V.push({x:et,y:_t})}let vt=!1;for(;U.nextPoint();)if(et=U.x,_t=U.y,st)L.lineTo(et,_t);else{if(et<X||et>Q||_t<X||_t>Q){vt=!0;break}V.push({x:et,y:_t})}if(vt)st=!0;else{if(st){const U=L.resultWithStarts();if(U)for(const V of U)J.push(V)}else J.push({line:V,start:0});ht=U.nextPath(),st=!1}}return J=J.filter((U=>U.line.length>1)),0===J.length?null:J}(U,this.hasEffects?256:16)}_writeVertices(U,V,L){const{_currentWrite:X,_tessellationOptions:Q,evaluatedMeshParams:$}=this,{width:J,capType:st,joinType:ht,miterLimit:_t,hasSizeVV:vt}=$,Pt=(0,Qt.Lz)(.5*J);Q.halfWidth=Pt,Q.capType=function meshWriterUtils_g(U){switch(U){case"butt":case ae.uT.Butt:return ae.xR.BUTT;case"round":case ae.uT.Round:return ae.xR.ROUND;case"square":case ae.uT.Square:return ae.xR.SQUARE}}(st),Q.joinType=function meshWriterUtils_p(U){switch(U){case"bevel":case ae.wd.Bevel:return ae.JO.BEVEL;case"miter":case ae.wd.Miter:return ae.JO.MITER;case"round":case ae.wd.Round:return ae.JO.ROUND}}(ht),Q.miterLimit=_t;const zt=!vt;X.out=U,X.id=V.getDisplayId(),X.vertexCount=0,X.indexCount=0,X.vertexFrom=U.vertexCount(),X.vertexBounds=zt&&Pt<et.Gh?0:1;for(const{line:et,start:Et}of L)Q.initialDistance=Et%65535,this._lineTessellator.tessellate(et,Q,zt)}_writeTesselatedVertex(U,V,L,X,Q,$,J,et,st,ht,_t){const{out:vt,id:Pt,vertexBounds:zt}=this._currentWrite;return this.hasEffects&&vt.recordBounds(U,V,zt,zt),this._tessParams.extrusionOffsetX=J,this._tessParams.extrusionOffsetY=et,this._tessParams.normalX=st,this._tessParams.normalY=ht,this._tessParams.directionX=Q,this._tessParams.directionY=$,this._tessParams.distance=_t,this._writeVertex(vt,Pt,U,V,this._tessParams),this._currentWrite.vertexFrom+this._currentWrite.vertexCount++}_writeTriangle(U,V,L){const{out:X}=this._currentWrite;X.indexEnsureSize(3),X.indexWrite(U),X.indexWrite(V),X.indexWrite(L),this._currentWrite.indexCount+=3}}const fe={createComputedParams:U=>U,attributes:{...pe.attributes,bitset:{type:Lt.pe.UNSIGNED_BYTE,count:1,pack:U=>0},color:{type:Lt.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:U=>{let{color:V}=U;return meshWriterUtils_h(V)}}}},ye={createComputedParams:U=>U,attributes:{...pe.attributes,bitset:{type:Lt.pe.UNSIGNED_BYTE,count:1,pack:U=>meshWriterUtils_l([[ue.Xx,!0]])},color:{type:Lt.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:U=>{let{outlineColor:V}=U;return meshWriterUtils_h(V)}}}};class OutlineFillMeshWriter_p extends T{constructor(){super(...arguments),this.vertexSpec=ye}}class OutlineFillMeshWriter_l extends FillMeshWriter_i{constructor(U,V,L,X){super(U,V,L,X),this.vertexSpec=fe,this._lineMeshWriter=this._createOutlineWriter(U,V,L,X)}_createOutlineWriter(U,V,L,X){return new OutlineFillMeshWriter_p(U,V,L,X)}_write(U,V,L){var X;const Q=null!==(X=null===L||void 0===L?void 0:L.asOptimized())&&void 0!==X?X:V.readGeometryForDisplay(),$=this._clip(Q);$&&(U.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(U,V,$),this._lineMeshWriter.writeLineVertices(U,Pt.z.fromOptimizedCIM($,"esriGeometryPolyline"),V),U.recordEnd())}ensurePacked(U,V,L){super.ensurePacked(U,V,L),this._lineMeshWriter.ensurePacked(U,V,L)}enqueueRequest(U,V,L){super.enqueueRequest(U,V,L),this._lineMeshWriter.enqueueRequest(U,V,L)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}var me=L(61332);const xe=he.attributes,_e=ye.attributes,ge={createComputedParams:U=>U,attributes:{id:xe.id,pos:xe.pos,zoomRange:xe.zoomRange,tlbr:xe.tlbr,angle:xe.angle,color:xe.color,bitset:{type:Lt.pe.UNSIGNED_BYTE,count:1,pack:U=>ComplexFillMeshWriter_m(U)},aux1:{count:1,type:Lt.pe.UNSIGNED_SHORT,pack:U=>ComplexFillMeshWriter_f(U)},aux2:{count:1,type:Lt.pe.UNSIGNED_SHORT,pack:U=>ComplexFillMeshWriter_d(U)},aux3:{count:2,type:Lt.pe.SHORT,pack:U=>{let{offsetX:V,offsetY:L}=U;return[(0,Qt.Lz)(V),(0,Qt.Lz)(L)]}},aux4:{count:2,type:Lt.pe.UNSIGNED_BYTE,pack:U=>{let{scaleX:V,scaleY:L}=U;return[V*me.cZ,L*me.cZ]}}}},ve={createComputedParams:U=>U,attributes:{id:xe.id,pos:xe.pos,zoomRange:xe.zoomRange,tlbr:xe.tlbr,angle:xe.angle,color:_e.color,bitset:{type:Lt.pe.UNSIGNED_BYTE,count:1,pack:U=>meshWriterUtils_l([[ue.Xx,!0]])},aux1:{count:1,type:Lt.pe.UNSIGNED_SHORT,pack:U=>(0,Qt.Lz)(.5*U.width)*me.cZ},aux2:{count:1,type:Lt.pe.UNSIGNED_SHORT,pack:U=>(0,Qt.Lz)(.5*U.referenceWidth)*me.cZ},aux3:{count:2,type:Lt.pe.SHORT,packTessellation:U=>{let{extrusionOffsetX:V,extrusionOffsetY:L}=U;return[V*me.cZ,L*me.cZ]}},aux4:{count:2,type:Lt.pe.UNSIGNED_BYTE,packTessellation:U=>{let{normalX:V,normalY:L}=U;return[V*me.cZ+me.v9,L*me.cZ+me.v9]}}}};class ComplexOutlineFillMeshWriter_S extends OutlineFillMeshWriter_p{constructor(){super(...arguments),this.vertexSpec=ve}}const be={createComputedParams:U=>U,attributes:{...le.attributes,...fe.attributes}},we={createComputedParams:U=>U,attributes:{...le.attributes,...ye.attributes}};class PatternOutlineFillMeshWriter_o extends OutlineFillMeshWriter_p{constructor(){super(...arguments),this.vertexSpec=we}}const Se={createComputedParams:U=>U,attributes:{pos:{type:Lt.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:Lt.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Lt.pe.UNSIGNED_BYTE,count:1},offset:{type:Lt.pe.BYTE,count:2,packAlternating:{count:4,pack:()=>[[-1,-1],[1,-1],[-1,1],[1,1]]}}}};var Me=L(69719),Pe=L(22815),Te=L(96062),ke=L(73855),Ie=L(60950),ze=L(39569),Fe=L(28155);function segmentUtils_e(U,V,L){return U[0]=V[0]-L[0],U[1]=V[1]-L[1],U}function segmentUtils_n(U,V){return Math.sqrt(U*U+V*V)}function segmentUtils_s(U){const V=segmentUtils_n(U[0],U[1]);U[0]/=V,U[1]/=V}function segmentUtils_i(U,V){return segmentUtils_n(U[0]-V[0],U[1]-V[1])}function segmentUtils_h(U){return U.length-1}function segmentUtils_a(U){let V=0;for(let L=0;L<segmentUtils_h(U);L++)V+=segmentUtils_c(U,L);return V}function segmentUtils_c(U,V){let L=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,[X,Q]=function segmentUtils_r(U,V){return U[V+1]}(U,V);return[X,Q]=[Math.round(X),Math.round(Q)],Math.sqrt(X*X+Q*Q)*L}class segmentUtils_u{constructor(U,V,L,X,Q){this._segments=U,this._index=V,this._distance=L,this._xStart=X,this._yStart=Q,this._done=!1}static create(U){return new segmentUtils_u(U,0,0,U[0][0],U[0][1])}clone(){return new segmentUtils_u(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(U){return this._index===U._index||U._index===this._index-1&&(0===this._distance||1===U._distance)||U._index===this._index+1&&(1===this._distance||0===U._distance)}leq(U){return this._index<U._index||this._index===U._index&&this._distance<=U._distance}geq(U){return this._index>U._index||this._index===U._index&&this._distance>=U._distance}get _segment(){return this._segments[this._index+1]}get angle(){const U=this.dy,V=(0*U+-1*-this.dx)/(1*this.length);let L=Math.acos(V);return U>0&&(L=2*Math.PI-L),L}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:U,dy:V}=this;return Math.sqrt(U*U+V*V)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<segmentUtils_h(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(U,V){const L=this.backwardLength;if(U<=L)return this._distance=(L-U)/this.length,this;let X=this.backwardLength;for(;this.prev();){if(X+this.length>U)return this._seekBackwards(U-X);X+=this.length}return this._distance=0,V?this:null}seek(U){let V=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(U<0)return this._seekBackwards(Math.abs(U),V);if(U<=this.remainingLength)return this._distance=(this.backwardLength+U)/this.length,this;let L=this.remainingLength;for(;this.next();){if(L+this.length>U)return this.seek(U-L,V);L+=this.length}return this._distance=1,V?this:null}}function segmentUtils_d(U,V,L){let X=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const Q=segmentUtils_a(U),$=segmentUtils_u.create(U),J=Q/2;if(!X)return $.seek(J),void(Math.abs($.x)<Fe.s&&Math.abs($.y)<Fe.s&&L($.clone(),0,J+0*V,Q));const et=Math.max((Q-V)/2,0),st=Math.floor(et/V),ht=J-st*V;$.seek(ht);for(let _t=-st;_t<=st;_t++)Math.abs($.x)<Fe.s&&Math.abs($.y)<Fe.s&&L($.clone(),_t,J+_t*V,Q),$.seek(V)}function segmentUtils_g(U,V){const L=1e-6;if(V<=0)return;const X=U.length;if(X<3)return;const Q=[];let $=0;Q.push(0);for(let vt=1;vt<X;vt++)$+=segmentUtils_i(U[vt],U[vt-1]),Q.push($);V=Math.min(V,.2*$);const J=[];J.push(U[0][0]),J.push(U[0][1]);const et=U[X-1][0],st=U[X-1][1],ht=segmentUtils_e([0,0],U[0],U[1]);segmentUtils_s(ht),U[0][0]+=V*ht[0],U[0][1]+=V*ht[1],segmentUtils_e(ht,U[X-1],U[X-2]),segmentUtils_s(ht),U[X-1][0]+=V*ht[0],U[X-1][1]+=V*ht[1];for(let vt=1;vt<X;vt++)Q[vt]+=V;Q[X-1]+=V;const _t=.5*V;for(let vt=1;vt<X-1;vt++){let $=0,et=0,st=0;for(let X=vt-1;X>=0&&!(Q[X+1]<Q[vt]-_t);X--){const J=_t+Q[X+1]-Q[vt],ht=Q[X+1]-Q[X],Pt=Q[vt]-Q[X]<_t?1:J/ht;if(Math.abs(Pt)<L)break;const zt=Pt*Pt,Et=Pt*J-.5*zt*ht,Ut=Pt*ht/V,Vt=U[X+1],Lt=U[X][0]-Vt[0],Ot=U[X][1]-Vt[1];$+=Ut/Et*(Vt[0]*Pt*J+.5*zt*(J*Lt-ht*Vt[0])-zt*Pt*ht*Lt/3),et+=Ut/Et*(Vt[1]*Pt*J+.5*zt*(J*Ot-ht*Vt[1])-zt*Pt*ht*Ot/3),st+=Ut}for(let J=vt+1;J<X&&!(Q[J-1]>Q[vt]+_t);J++){const X=_t-Q[J-1]+Q[vt],ht=Q[J]-Q[J-1],Pt=Q[J]-Q[vt]<_t?1:X/ht;if(Math.abs(Pt)<L)break;const zt=Pt*Pt,Et=Pt*X-.5*zt*ht,Ut=Pt*ht/V,Vt=U[J-1],Lt=U[J][0]-Vt[0],Ot=U[J][1]-Vt[1];$+=Ut/Et*(Vt[0]*Pt*X+.5*zt*(X*Lt-ht*Vt[0])-zt*Pt*ht*Lt/3),et+=Ut/Et*(Vt[1]*Pt*X+.5*zt*(X*Ot-ht*Vt[1])-zt*Pt*ht*Ot/3),st+=Ut}J.push($/st),J.push(et/st)}J.push(et),J.push(st);for(let vt=0,Pt=0;vt<X;vt++)U[vt][0]=J[Pt++],U[vt][1]=J[Pt++]}var Ne=L(48237),Ce=L(60072);class CIMMarkerPlacementHelper_e{static getPlacement(U,V,L,X,Q,$){const J=(0,Ce.c)(L);return J?(-1===V&&U.invertY(),J.execute(U,L,X,Q,$)):null}}var Ae=L(90624),Ee=L(3067);class TextParams_o{constructor(U){const{offsetX:V,offsetY:L,postAngle:X,fontSize:Q,scaleFactor:$,transforms:J}=U;if(this.offsetX=V,this.offsetY=L,this.postAngle=X,this.fontSize=Math.min(Q,96),this.transforms=J,J&&J.infos.length>1){const U=(0,Ee.zb)(Q,X,!1,V,L,J);this.fontSize=Math.min(U.size,96),this.postAngle=U.rotation,this.offsetX=U.offsetX,this.offsetY=U.offsetY}$&&(this.fontSize*=$,this.offsetX*=$,this.offsetY*=$)}}const Ue=[4,4],We=[16,4],De={topLeft:We,topRight:We,bottomLeft:We,bottomRight:We},Ve=[4,2],Be=[4,6],Le={topLeft:Ve,topRight:Ve,bottomLeft:Be,bottomRight:Be},Oe={topLeft:Ve,topRight:Be,bottomLeft:Ve,bottomRight:Be},Re={topLeft:Be,topRight:Be,bottomLeft:Ue,bottomRight:Ue},Ge={topLeft:Ue,topRight:Ue,bottomLeft:Be,bottomRight:Be},Ye={topLeft:Be,topRight:Ue,bottomLeft:Be,bottomRight:Ue},Ze={topLeft:Ue,topRight:Be,bottomLeft:Ue,bottomRight:Be},je={createComputedParams:U=>U,attributes:{pos:{type:Lt.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:Lt.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Lt.pe.UNSIGNED_BYTE,count:1,packTessellation:U=>{let{isBackground:V,mapAligned:L}=U;return meshWriterUtils_l([[ue.bg,V],[ue.ti,!!L]])}},zoomRange:{type:Lt.pe.UNSIGNED_SHORT,count:2,packPrecisionFactor:et.fq,packTessellation:U=>{let{minZoom:V,maxZoom:L}=U;return[V||0,L||28]}},offset:{type:Lt.pe.SHORT,count:2,packPrecisionFactor:8,packAlternating:{count:4,packTessellation:U=>{let{offsets:V}=U;const{bottomLeft:L,bottomRight:X,topLeft:Q,topRight:$}=V;return[Q,$,L,X]}}},textureUV:{type:Lt.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,packTessellation:U=>{let{texcoords:V}=U;const{bottomLeft:L,bottomRight:X,topLeft:Q,topRight:$}=V;return[Q,$,L,X]}}},color:{type:Lt.pe.UNSIGNED_BYTE,count:4,normalized:!0,packTessellation:U=>{let{color:V}=U;return V}},fontSize:{type:Lt.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,packTessellation:U=>{let{fontSize:V}=U;return(0,Qt.Lz)(V)}},referenceSize:{type:Lt.pe.UNSIGNED_BYTE,count:1,packPrecisionFactor:4,packTessellation:(U,V)=>{let{fontSize:L}=U,{referenceSize:X}=V;return(0,Qt.Lz)(null!==X&&void 0!==X?X:L)}},haloColor:{type:Lt.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:U=>{let{haloColor:V}=U;return meshWriterUtils_h(V)}},haloFontSize:{type:Lt.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,pack:U=>{let{haloFontSize:V}=U;return(0,Qt.Lz)(V)}},clipAngle:{type:Lt.pe.UNSIGNED_BYTE,count:1,packTessellation:U=>{let{clipAngle:V}=U;return G(V||0)}},referenceSymbol:{type:Lt.pe.BYTE,count:4,packPrecisionFactor:1,packTessellation:(U,V)=>{if(!U.referenceBounds)return[0,0,0,0];const L=(0,ke.iT)(V.horizontalAlignment),X=(0,ke.Dy)(V.verticalAlignment),{offsetX:Q,offsetY:$,size:J}=U.referenceBounds;return[(0,Qt.Lz)(Q),-(0,Qt.Lz)($),(0,Qt.Lz)(J),L+1<<2|X+1]}}}};class E extends MeshWriter_o{constructor(){super(...arguments),this.vertexSpec=je,this._textMeshParamsPropsInitialized=!1}ensurePacked(U,V,L){super.ensurePacked(U,V,L),this._textMeshParamsPropsInitialized&&!this._evaluator.hasDynamicProperties||(this._textMeshTransformProps=new TextParams_o(this.evaluatedMeshParams),this._textMeshParamsPropsInitialized=!0)}_write(U,V,L){const X=this._getShaping();if(!X)return;const Q=V.getDisplayId();if(null!=this.evaluatedMeshParams.placement)return this._writePlacedTextMarkers(U,V,X,L);if(L&&L.nextPath())return L.nextPoint(),this._writeGlyphs(U,Q,L.x,L.y,X,0);if("esriGeometryPolygon"===V.geometryType){const L=V.readCentroidForDisplay();if(!L)return;const[$,J]=L.coords;return this._writeGlyphs(U,Q,$,J,X,0)}if("esriGeometryMultipoint"===V.geometryType){const L=V.readGeometryForDisplay();return void(null===L||void 0===L||L.forEachVertex(((V,L)=>this._writeGlyphs(U,Q,V,L,X,0))))}const $=V.readXForDisplay(),J=V.readYForDisplay();return this._writeGlyphs(U,Q,$,J,X,0)}_writePlacedTextMarkers(U,V,L,X){const Q=null!==X&&void 0!==X?X:Pt.z.fromFeatureSetReaderCIM(V);if(!Q)return;const $=CIMMarkerPlacementHelper_e.getPlacement(Q,-1,this.evaluatedMeshParams.placement,(0,Qt.Lz)(1),U.id,loadGeometryEngine_t());if(!$)return;const J=V.getDisplayId();let et=$.next();for(;null!=et;){const V=et.tx,X=-et.ty,Q=-et.getAngle();this._writeGlyphs(U,J,V,X,L,Q),et=$.next()}}_getShaping(){var U;const V=this._textMeshTransformProps,L=this.evaluatedMeshParams;if(null===(U=L.glyphs)||void 0===U||!U.glyphs.length)return null;const X=Math.round((0,Qt.Lz)(V.fontSize)),Q=(0,Qt.Lz)(V.offsetX),$=(0,Qt.Lz)(V.offsetY),J=(0,Ne.qE)((0,Qt.Lz)(L.lineWidth),32,512),st=et.DY*(0,Ne.qE)(L.lineHeightRatio,.25,4);return(0,Ae.Tl)(L.glyphs,{scale:X/et.eG,angle:V.postAngle,xOffset:Q,yOffset:$,horizontalAlignment:L.horizontalAlignment,verticalAlignment:L.verticalAlignment,maxLineWidth:J,lineHeight:st,decoration:L.decoration,borderLineSizePx:(0,Qt.Lz)(L.boxBorderLineSize),hasBackground:!!L.boxBackgroundColor,useCIMAngleBehavior:L.useCIMAngleBehavior})}_writeGlyphs(U,V,L,X,Q,$,J){const et=this.evaluatedMeshParams,st=this._textMeshTransformProps,ht=st.fontSize,_t=(0,Qt.Lz)(st.offsetX),vt=(0,Qt.Lz)(st.offsetY);0!==$&&Q.setRotation($);const Pt=Q.bounds,zt=L+Pt.x+_t,Et=X+Pt.y-vt,Ut=2*(et.minPixelBuffer?et.minPixelBuffer/ht:1),Vt=Math.max(Pt.width,Pt.height)*Ut;Q.textBox&&(U.recordStart(this.instanceId,this.attributeLayout,Q.glyphs[0].textureBinding),U.recordBounds(zt,Et,Vt,Vt),this._writeTextBox(U,V,L,X,Q.textBox,J),U.recordEnd());for(const Lt of Q.glyphs){U.recordStart(this.instanceId,this.attributeLayout,Lt.textureBinding),U.recordBounds(zt,Et,Vt,Vt);const{texcoords:Q,offsets:$}=Lt;this._writeQuad(U,V,L,X,{texcoords:Q,offsets:$,fontSize:ht,color:meshWriterUtils_h(et.color),isBackground:!1,referenceBounds:J}),U.recordEnd()}0!==$&&Q.setRotation(-$)}_writeTextBox(U,V,L,X,Q,$,J){const et=this.evaluatedMeshParams,{fontSize:st}=this._textMeshTransformProps,{boxBackgroundColor:ht,boxBorderLineColor:_t}=et,vt={isBackground:!0,fontSize:st,referenceBounds:$,...J};ht&&(this._writeQuad(U,V,L,X,{texcoords:De,offsets:Q.main,color:meshWriterUtils_h(ht),...vt}),_t||(this._writeQuad(U,V,L,X,{texcoords:Re,offsets:Q.top,color:meshWriterUtils_h(ht),...vt}),this._writeQuad(U,V,L,X,{texcoords:Ge,offsets:Q.bot,color:meshWriterUtils_h(ht),...vt}),this._writeQuad(U,V,L,X,{texcoords:Ye,offsets:Q.left,color:meshWriterUtils_h(ht),...vt}),this._writeQuad(U,V,L,X,{texcoords:Ze,offsets:Q.right,color:meshWriterUtils_h(ht),...vt}))),_t&&(this._writeQuad(U,V,L,X,{texcoords:Le,offsets:Q.top,color:meshWriterUtils_h(_t),...vt}),this._writeQuad(U,V,L,X,{texcoords:Le,offsets:Q.bot,color:meshWriterUtils_h(_t),...vt}),this._writeQuad(U,V,L,X,{texcoords:Oe,offsets:Q.left,color:meshWriterUtils_h(_t),...vt}),this._writeQuad(U,V,L,X,{texcoords:Oe,offsets:Q.right,color:meshWriterUtils_h(_t),...vt}))}_writeQuad(U,V,L,X,Q){const $=U.vertexCount();this._writeVertex(U,V,L,X,Q),U.indexWrite($+0),U.indexWrite($+1),U.indexWrite($+2),U.indexWrite($+1),U.indexWrite($+3),U.indexWrite($+2)}}const G=U=>Math.round(U*(254/360)),He=(0,Me.Bj)((U=>{let V=0;if(0===U)return 1/0;for(;!(U%2);)V++,U/=2;return V}));const Ke={createComputedParams:U=>U,attributes:{...pe.attributes,bitset:{type:Lt.pe.UNSIGNED_BYTE,count:1,pack:U=>{let{shouldSampleAlphaOnly:V,shouldScaleDash:L,isSDF:X}=U;return meshWriterUtils_l([[ue.cn,V],[ue.kx,L],[ue.b5,X]])}},tlbr:{type:Lt.pe.UNSIGNED_SHORT,count:4,pack:U=>{let{sprite:V}=U;const{rect:L,width:X,height:Q}=V,$=L.x+et.hM,J=L.y+et.hM;return[$,J,$+X,J+Q]}},accumulatedDistance:{type:Lt.pe.UNSIGNED_SHORT,count:1,packTessellation:U=>{let{distance:V}=U;return V}},segmentDirection:{type:Lt.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:U=>{let{directionX:V,directionY:L}=U;return[V,L]}}}};var qe=L(37131);class ComputedMarkerParams_h{static from(U){return"width"in U?this.fromSimpleMeshParams(U):this.fromComplexMeshParams(U)}static fromSimpleMeshParams(U){const V=new ComputedMarkerParams_h(U.sprite,U.color,U.outlineColor,U.minPixelBuffer,U.placement,U.scaleInfo,U.effects),{type:L,width:X,height:Q,angle:$,outlineSize:J,referenceSize:et,sprite:st,overrideOutlineColor:ht}=U;V.rawWidth=(0,Qt.Lz)(X),V.rawHeight=(0,Qt.Lz)(Q),V.angle=$,V.outlineSize=(0,Qt.Lz)(J),V.referenceSize=(0,Qt.Lz)(et),V.overrideOutlineColor=ht,V.offsetX=(0,Qt.Lz)(U.offsetX),V.offsetY=(0,Qt.Lz)(U.offsetY),"simple"!==L||st.sdf||(V.rawWidth=st.width,V.rawHeight=st.height);return V.sizeRatio=st.sdf?2:1,V._computeSize(U,!1),V}static fromComplexMeshParams(U){const V=new ComputedMarkerParams_h(U.sprite,U.color,U.outlineColor,U.minPixelBuffer,U.placement,U.scaleInfo,U.effects);let{alignment:L,transforms:X,size:Q,scaleX:$,anchorX:J,anchorY:et,angle:st,colorLocked:ht,frameHeight:_t,widthRatio:vt,offsetX:Pt,offsetY:zt,outlineSize:Et,referenceSize:Ut,scaleFactor:Vt,sizeRatio:Lt,isAbsoluteAnchorPoint:Ot,rotateClockwise:Yt,scaleSymbolsProportionally:qt,sprite:re}=U;if(X&&X.infos.length>0){const U=(0,Ee.zb)(Q,st,Yt,Pt,zt,X);Q=U.size,st=U.rotation,Pt=U.offsetX,zt=U.offsetY,Yt=!1}Vt&&(Q*=Vt,Pt*=Vt,zt*=Vt);const ne=$*(re.width/re.height);V.alignment=L,V.rawHeight=(0,Qt.Lz)(Q),V.rawWidth=V.rawHeight*ne,V.referenceSize=(0,Qt.Lz)(Ut),V.sizeRatio=Lt,V.angle=st,V.rotateClockwise=Yt,V.anchorX=J,V.anchorY=et,V.offsetX=(0,Qt.Lz)(Pt),V.offsetY=(0,Qt.Lz)(zt),Ot&&Q&&(re.sdf?V.anchorX=J/(Q*vt):V.anchorX=J/(Q*ne),V.anchorY=et/Q);const ie=qt&&_t?Q/_t:1;return V.outlineSize=0===Et||isNaN(Et)?0:(0,Qt.Lz)(Et)*ie,V.scaleSymbolsProportionally=qt,V.colorLocked=ht,V._computeSize(U,!0),V}constructor(U,V,L,X,Q,$,J){this.sprite=U,this.color=V,this.outlineColor=L,this.minPixelBuffer=X,this.placement=Q,this.scaleInfo=$,this.effects=J,this.rawWidth=0,this.rawHeight=0,this.angle=0,this.outlineSize=0,this.referenceSize=0,this.sizeRatio=1,this.alignment=ae.C1.SCREEN,this.scaleSymbolsProportionally=!1,this.overrideOutlineColor=!1,this.colorLocked=!1,this.anchorX=0,this.anchorY=0,this.computedWidth=0,this.computedHeight=0,this.texXmin=0,this.texYmin=0,this.texXmax=0,this.texYmax=0,this.offsetX=0,this.offsetY=0,this.rotateClockwise=!0}get boundsInfo(){return{size:Math.max(this.computedHeight,this.computedWidth),offsetX:this.offsetX,offsetY:this.offsetY}}_computeSize(U,V){const{sprite:L,hasSizeVV:X}=U,Q=!!L.sdf,{rawWidth:$,rawHeight:J,sizeRatio:st,outlineSize:ht}=this,_t=$*st,vt=J*st;if(Q&&!X){const U=V&&$>J?_t:$,L=J,X=ht+2;this.computedWidth=Math.min(U+X,_t),this.computedHeight=Math.min(L+X,vt)}else this.computedWidth=_t,this.computedHeight=vt;const Pt=Q?et._j/Math.max(_t,vt):1,zt=.5*(_t-this.computedWidth)*Pt,Et=.5*(vt-this.computedHeight)*Pt,Ut=L.rect.x+et.hM+zt,Vt=L.rect.y+et.hM+Et,Lt=Ut+L.width-2*zt,Ot=Vt+L.height-2*Et;this.texXmin=Math.floor(Ut),this.texYmin=Math.floor(Vt),this.texXmax=Math.ceil(Lt),this.texYmax=Math.ceil(Ot),this.computedWidth*=(this.texXmax-this.texXmin)/(Lt-Ut),this.computedHeight*=(this.texYmax-this.texYmin)/(Ot-Vt),this.anchorX*=_t/this.computedWidth,this.anchorY*=vt/this.computedHeight}}var Xe=L(19578);const Qe=3.14159265359/180,$e=128/Math.PI;function I(U){return function MarkerMeshWriter_S(U,V){return U%=V,Math.abs(U>=0?U:U+V)}(U*$e,256)}const Je={createComputedParams:U=>ComputedMarkerParams_h.from(U),attributes:{pos:{type:Lt.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:Lt.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Lt.pe.UNSIGNED_BYTE,count:1,pack:U=>{let{sprite:V,alignment:L,scaleSymbolsProportionally:X,overrideOutlineColor:Q,colorLocked:$}=U,J=0;return V.sdf&&(J|=meshWriterUtils_f(Xe.c.bitset.isSDF)),L===ae.C1.MAP&&(J|=meshWriterUtils_f(Xe.c.bitset.isMapAligned)),X&&(J|=meshWriterUtils_f(Xe.c.bitset.scaleSymbolsProportionally)),Q&&(J|=meshWriterUtils_f(Xe.c.bitset.overrideOutlineColor)),$&&(J|=meshWriterUtils_f(Xe.c.bitset.colorLocked)),J}},zoomRange:{type:Lt.pe.SHORT,count:2,packPrecisionFactor:et.fq,pack:(U,V)=>{let{scaleInfo:L}=U,{tileInfo:X}=V;return meshWriterUtils_m(L,X)}},offset:{type:Lt.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:U=>{let{angle:V,computedWidth:L,computedHeight:X,anchorX:Q,anchorY:$,offsetX:J,offsetY:et,rotateClockwise:st}=U;const ht=function MarkerMeshWriter_(U,V,L,X){let Q=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const $=(0,Te.vt)(),J=Q?1:-1;return U?(0,Pe.$0)($,J*Qe*U):(0,Pe.D_)($),(V||L)&&(0,Pe.Tl)($,$,[V,-L]),X&&(0,Pe.e$)($,$,J*Qe*-X),$}(0,J,et,-V,st),_t=-(.5+Q)*L,vt=-(.5-$)*X,Pt=[_t,vt],zt=[_t+L,vt],Et=[_t,vt+X],Ut=[_t+L,vt+X];return(0,qe.l0)(Pt,Pt,ht),(0,qe.l0)(zt,zt,ht),(0,qe.l0)(Et,Et,ht),(0,qe.l0)(Ut,Ut,ht),[Pt,zt,Et,Ut]}}},textureUV:{type:Lt.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:U=>{let{texXmax:V,texXmin:L,texYmax:X,texYmin:Q}=U;return[[L,Q],[V,Q],[L,X],[V,X]]}}},color:{type:Lt.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:U=>{let{color:V}=U;return meshWriterUtils_h(V)}},outlineColor:{type:Lt.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:U=>{let{outlineColor:V}=U;return meshWriterUtils_h(V)}},sizing:{type:Lt.pe.UNSIGNED_BYTE,count:4,pack:U=>{let{rawWidth:V,rawHeight:L,outlineSize:X,referenceSize:Q}=U;return[meshWriterUtils_d(Math.max(V,L),128),meshWriterUtils_d(X,128),meshWriterUtils_d(Q,128),0]}},placementAngle:{type:Lt.pe.UNSIGNED_BYTE,count:1,packTessellation:U=>{let{placementAngle:V}=U;return I(V)}},sizeRatio:{type:Lt.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:64,pack:U=>{let{sizeRatio:V}=U;return V}}}};const tr={createComputedParams:U=>U,attributes:{pos:{type:Lt.pe.SHORT,count:2,packPrecisionFactor:10,pack:"position"},id:{type:Lt.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:Lt.pe.UNSIGNED_BYTE,count:1,pack:U=>0},offset:{type:Lt.pe.SHORT,count:2,packPrecisionFactor:16,packAlternating:{count:4,pack:U=>{let{size:V}=U;const L=(0,Qt.Lz)(V),X=-L/2,Q=-L/2;return[[X,Q],[X+L,Q],[X,Q+L],[X+L,Q+L]]}}},texCoords:{type:Lt.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:()=>[[0,1],[1,1],[0,0],[1,0]]}},size:{type:Lt.pe.UNSIGNED_BYTE,count:2,pack:U=>{let{size:V}=U;return[V,V]}},referenceSize:{type:Lt.pe.UNSIGNED_BYTE,count:1,pack:U=>{let{size:V}=U;return(0,Qt.Lz)(V)}},zoomRange:{type:Lt.pe.UNSIGNED_BYTE,count:2,pack:(U,V)=>{let{scaleInfo:L}=U,{tileInfo:X}=V;return meshWriterUtils_m(L,X)}}}};const er=function MeshWriterRegistry_j(U){const V={};for(const L in U){const X={name:L,constructor:U[L]};V[L]=X}return V}({FillMeshWriter:FillMeshWriter_i,DotDensityMeshWriter:class DotDensityMeshWriter_s extends AFillMeshWriter_a{constructor(){super(...arguments),this.vertexSpec=qt}createTesselationParams(U){return{inverseArea:1/U.readGeometryArea()}}},ComplexFillMeshWriter:class ComplexFillMeshWriter_y extends PatternFillMeshWriter_a{constructor(){super(...arguments),this.vertexSpec=he}},PatternFillMeshWriter:PatternFillMeshWriter_a,OutlineFillMeshWriter:OutlineFillMeshWriter_l,PatternOutlineFillMeshWriter:class PatternOutlineFillMeshWriter_c extends OutlineFillMeshWriter_l{constructor(){super(...arguments),this.vertexSpec=be}_createOutlineWriter(U,V,L,X){return new PatternOutlineFillMeshWriter_o(U,V,L,X)}_write(U,V,L){var X,Q;const $=null!==(X=null===L||void 0===L?void 0:L.asOptimized())&&void 0!==X?X:V.readGeometryForDisplay(),J=this._clip($);if(!J)return;const et=null===(Q=this.evaluatedMeshParams.sprite)||void 0===Q?void 0:Q.textureBinding;U.recordStart(this.instanceId,this.attributeLayout,et),this._writeGeometry(U,V,J),this._lineMeshWriter.writeLineVertices(U,Pt.z.fromOptimizedCIM(J,"esriGeometryPolyline"),V),U.recordEnd()}ensurePacked(U,V,L){super.ensurePacked(U,V,L),this._lineMeshWriter.ensurePacked(U,V,L)}enqueueRequest(U,V,L){super.enqueueRequest(U,V,L),this._lineMeshWriter.enqueueRequest(U,V,L)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}},ComplexOutlineFillMeshWriter:class N extends OutlineFillMeshWriter_l{constructor(){super(...arguments),this.vertexSpec=ge}_createOutlineWriter(U,V,L,X){return new ComplexOutlineFillMeshWriter_S(U,V,L,X)}_write(U,V,L){var X,Q;const $=null!==(X=null===L||void 0===L?void 0:L.asOptimized())&&void 0!==X?X:V.readGeometryForDisplay(),J=this._clip($);if(!J)return;const et=null===(Q=this.evaluatedMeshParams.sprite)||void 0===Q?void 0:Q.textureBinding;U.recordStart(this.instanceId,this.attributeLayout,et),this._writeGeometry(U,V,J),this._lineMeshWriter.writeLineVertices(U,Pt.z.fromOptimizedCIM(J,"esriGeometryPolyline"),V),U.recordEnd()}ensurePacked(U,V,L){super.ensurePacked(U,V,L),this._lineMeshWriter.ensurePacked(U,V,L)}enqueueRequest(U,V,L){super.enqueueRequest(U,V,L),this._lineMeshWriter.enqueueRequest(U,V,L)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}},MarkerMeshWriter:class MarkerMeshWriter_E extends MeshWriter_o{constructor(){super(...arguments),this.vertexSpec=Je}getBoundsInfo(){return this.evaluatedMeshParams.boundsInfo}_write(U,V,L){var X;const Q=null===(X=this.evaluatedMeshParams.sprite)||void 0===X?void 0:X.textureBinding,$=V.getDisplayId();U.recordStart(this.instanceId,this.attributeLayout,Q);const J=this.evaluatedMeshParams.minPixelBuffer,et=Math.max(this.evaluatedMeshParams.computedWidth,J),st=Math.max(this.evaluatedMeshParams.computedHeight,J),ht=this.evaluatedMeshParams.offsetX,_t=-this.evaluatedMeshParams.offsetY;if(null!=this.evaluatedMeshParams.placement)this._writePlacedMarkers(U,V,L,et,st);else if(L&&L.nextPath()){L.nextPoint();const V=L.x,X=L.y;U.recordBounds(V+ht,X+_t,et,st),this._writeQuad(U,$,V,X)}else if("esriGeometryPolygon"===V.geometryType){const L=V.readCentroidForDisplay();if(!L)return;const[X,Q]=L.coords;U.recordBounds(X+ht,Q+_t,et,st),this._writeQuad(U,$,X,Q)}else if("esriGeometryPoint"===V.geometryType){const L=V.readXForDisplay(),X=V.readYForDisplay();U.recordBounds(L+ht,X+_t,et,st),this._writeQuad(U,$,L,X)}else{const L=V.readGeometryForDisplay();null===L||void 0===L||L.forEachVertex(((V,L)=>{U.recordBounds(V+ht,L+_t,et,st),Math.abs(V)>Fe.s||Math.abs(L)>Fe.s||this._writeQuad(U,$,V,L)}))}U.recordEnd()}_writePlacedMarkers(U,V,L,X,Q){var $;const J=null!==L&&void 0!==L?L:null===($=Pt.z.fromFeatureSetReaderCIM(V))||void 0===$?void 0:$.clone();if(!J)return;const et=CIMMarkerPlacementHelper_e.getPlacement(J,-1,this.evaluatedMeshParams.placement,(0,Qt.Lz)(1),U.id,loadGeometryEngine_t());if(!et)return;const st=V.getDisplayId();let ht=et.next();const _t=this.evaluatedMeshParams.offsetX,vt=-this.evaluatedMeshParams.offsetY;for(;null!=ht;){const V=ht.tx,L=-ht.ty;if(Math.abs(V)>Fe.s||Math.abs(L)>Fe.s){ht=et.next();continue}const $=-ht.getAngle();U.recordBounds(V+_t,L+vt,X,Q),this._writeQuad(U,st,V,L,$),ht=et.next()}}_writeQuad(U,V,L,X,Q){const $=U.vertexCount(),J=null==Q?null:{placementAngle:Q};this._writeVertex(U,V,L,X,J),U.indexWrite($+0),U.indexWrite($+1),U.indexWrite($+2),U.indexWrite($+1),U.indexWrite($+3),U.indexWrite($+2)}},PieChartMeshWriter:class PieChartMeshWriter_s extends MeshWriter_o{constructor(){super(...arguments),this.vertexSpec=tr}_write(U,V){const L=V.getDisplayId(),X=this.evaluatedMeshParams.minPixelBuffer,Q=Math.max((0,Qt.Lz)(this.evaluatedMeshParams.size),X);let $,J;if("esriGeometryPoint"===V.geometryType)$=V.readXForDisplay(),J=V.readYForDisplay();else{const U=V.readCentroidForDisplay();if(!U)return;$=null===U||void 0===U?void 0:U.coords[0],J=null===U||void 0===U?void 0:U.coords[1]}U.recordStart(this.instanceId,this.attributeLayout),U.recordBounds($,J,Q,Q);const et=U.vertexCount();this._writeVertex(U,L,$,J),U.indexWrite(et+0),U.indexWrite(et+1),U.indexWrite(et+2),U.indexWrite(et+1),U.indexWrite(et+3),U.indexWrite(et+2),U.recordEnd()}},TextMeshWriter:E,LineMeshWriter:T,TexturedLineMeshWriter:class TexturedLineMeshWriter_p extends T{constructor(U,V,L,X){super(U,V,L,X),this.vertexSpec=Ke,this._tessellationOptions.textured=!0}_write(U,V,L){const X=null!==L&&void 0!==L?L:Pt.z.fromFeatureSetReaderCIM(V);if(!X)return;const{sprite:Q}=this.evaluatedMeshParams;this._writeGeometry(U,V,X,null===Q||void 0===Q?void 0:Q.textureBinding)}},HeatmapMeshWriter:class HeatmapMeshWriter_i extends MeshWriter_o{constructor(){super(...arguments),this.vertexSpec=Se}_write(U,V){U.recordStart(this.instanceId,this.attributeLayout);const L=V.getDisplayId();if("esriGeometryPoint"===V.geometryType){const X=V.readXForDisplay(),Q=V.readYForDisplay();this._writeQuad(U,L,X,Q)}else if("esriGeometryMultipoint"===V.geometryType){const X=V.readGeometryForDisplay();null===X||void 0===X||X.forEachVertex(((V,X)=>{V>=0&&V<=512&&X>=0&&X<=512&&this._writeQuad(U,L,V,X)}))}U.recordEnd()}_writeQuad(U,V,L,X){const Q=U.vertexCount();this._writeVertex(U,V,L,X),U.indexWrite(Q+0),U.indexWrite(Q+1),U.indexWrite(Q+2),U.indexWrite(Q+1),U.indexWrite(Q+3),U.indexWrite(Q+2)}},LabelMeshWriter:class LabelMeshWriter_x extends E{constructor(){super(...arguments),this._zoomLevel=0}_write(U,V,L,X){if(this._zoomLevel=X||0,null!=L)throw new Error("InternalError: EffectGeometry not support for LabelMeshWriter");switch(V.geometryType){case"esriGeometryPoint":{const L=V.readXForDisplay(),X=V.readYForDisplay();return this._writePoint(U,L,X,V)}case"esriGeometryEnvelope":case"esriGeometryPolygon":case"esriGeometryMultipoint":{const L=V.readCentroidForDisplay();if(!L)return;const[X,Q]=L.coords;return this._writePoint(U,X,Q,V)}case"esriGeometryPolyline":{const L=V.readLegacyGeometryForDisplay();this._writeLines(U,V,L)}}}_writePoint(U,V,L,X){var Q,$,J,et;const st=this._getShaping();if(!st)return;let ht=this._getPointReferenceBounds();ht||(ht={offsetX:0,offsetY:0,size:0});const _t=st.boundsT,vt=(0,ke.xy)(this.evaluatedMeshParams.horizontalAlignment),Pt=(0,ke.UD)(this.evaluatedMeshParams.verticalAlignment),zt=null!==(Q=null===($=this.evaluatedMeshParams.scaleInfo)||void 0===$?void 0:$.maxScale)&&void 0!==Q?Q:0,Et=null!==(J=null===(et=this.evaluatedMeshParams.scaleInfo)||void 0===et?void 0:et.minScale)&&void 0!==J?J:0,Ut=(0,Ie.Q4)(X.getDisplayId());U.metricStart(new ze.f(Ut,V,L,vt,Pt,zt,Et,ht)),U.metricBoxWrite(_t),this._writeGlyphs(U,X.getDisplayId(),V,L,st,0,ht),U.metricEnd()}_getPointReferenceBounds(){if(!this._references)return null;for(const U of this._references){const V=U.getBoundsInfo();if(V)return V}return null}_writeLines(U,V,L){const{repeatLabel:X,scaleInfo:Q}=this.evaluatedMeshParams,$=this.evaluatedMeshParams.repeatLabelDistance||128,J=this._getShaping();if(!J)return;this._current={out:U,id:V.getDisplayId(),shaping:J,zoomRange:meshWriterUtils_m(Q,this.getTileInfo()),referenceBounds:this._getPointReferenceBounds()||{offsetX:0,offsetY:0,size:0}};const et=function segmentUtils_l(U,V){const L=V;for(let X=0;X<U.length;X++){let V=U[X];segmentUtils_g(V,L);const Q=[];Q.push(V[0]);for(let U=1;U<V.length;U++){const[L,X]=V[U-1],[$,J]=V[U],et=$-L,st=J-X;Q.push([et,st])}U[X]=Q,V=Q}return U}(L.paths,J.bounds.width),st=this._placeSubdivGlyphs.bind(this),ht=(J.bounds.width+$)/2;for(const _t of et)segmentUtils_d(_t,ht,st,!!X)}_placeSubdivGlyphs(U,V,L,X){const{allowOverrun:Q,labelPosition:$,repeatLabelDistance:J}=this.evaluatedMeshParams,et=this._current.zoomRange[0],st=He(V),ht=this._current.shaping.bounds.width/2,_t=Math.sqrt(J||128)/2,vt=Math.min(L,X-L),Pt=this._current.shaping.isMultiline?28:Math.log2(vt/(_t+ht/2)),zt=0===V?Pt:Math.min(st,Pt),Et=Math.max(et,this._zoomLevel+1-zt),Ut=this._zoomLevel-Et,Vt=this._current.shaping.bounds.width/2*2**Ut;this._current.shaping.isMultiline?0===V&&this._placeStraight(U,Et):Q&&Ut<0?this._placeStraightAlong(U,et):"parallel"===$?this._placeStraightAlong(U,Et):"curved"===$&&this._placeCurved(U,Et,Vt)}_placeStraight(U,V){var L,X,Q,$;const{out:J,id:et,shaping:st,zoomRange:ht,referenceBounds:_t}=this._current,{x:vt,y:Pt}=U,zt=U.angle*(180/Math.PI)%360,Et=(U.angle*(180/Math.PI)+180)%360;if(st.textBox){const L=Math.max(V,ht[0],0),X=Math.min(28,ht[1]),Q=(0,Pe.$0)((0,Te.vt)(),-U.angle),[$,vt]=st.shapeBackground(Q),Pt={minZoom:L,maxZoom:X,clipAngle:zt,mapAligned:!0,isLineLabel:!0};J.recordStart(this.instanceId,this.attributeLayout,st.glyphs[0].textureBinding),this._writeTextBox(J,et,U.x,U.y,vt,_t,Pt),J.recordEnd(),Pt.clipAngle=Et,J.recordStart(this.instanceId,this.attributeLayout,st.glyphs[0].textureBinding),this._writeTextBox(J,et,U.x,U.y,vt,_t,Pt),J.recordEnd()}const Ut=(0,Ie.Q4)(et),Vt=null!==(L=null===(X=this.evaluatedMeshParams.scaleInfo)||void 0===X?void 0:X.maxScale)&&void 0!==L?L:0,Lt=null!==(Q=null===($=this.evaluatedMeshParams.scaleInfo)||void 0===$?void 0:$.minScale)&&void 0!==Q?Q:0;J.metricStart(new ze.f(Ut,U.x,U.y,0,0,Vt,Lt,null)),J.metricBoxWrite(st.bounds);for(const Ot of st.glyphs)Ot.minZoom=V,Ot.maxZoom=ht[1],Ot.angle=U.angle,this._writeLineGlyph(J,et,vt,Pt,st.bounds,Ot,zt,_t,!0),Ot.angle=U.angle+Math.PI,this._writeLineGlyph(J,et,vt,Pt,st.bounds,Ot,Et,_t,!0);J.metricEnd()}_placeCurved(U,V,L){var X,Q,$,J;const{out:et,id:st}=this._current,ht=U.clone(),_t=U.angle*(180/Math.PI)%360,vt=(U.angle*(180/Math.PI)+180)%360,Pt=(0,Ie.Q4)(st),zt=null!==(X=null===(Q=this.evaluatedMeshParams.scaleInfo)||void 0===Q?void 0:Q.maxScale)&&void 0!==X?X:0,Et=null!==($=null===(J=this.evaluatedMeshParams.scaleInfo)||void 0===J?void 0:J.minScale)&&void 0!==$?$:0;et.metricStart(new ze.f(Pt,U.x,U.y,0,0,zt,Et,null)),this._placeFirst(ht,V,1,_t),this._placeBack(U,ht,V,L,1,_t),this._placeForward(U,ht,V,L,1,_t),this._placeFirst(ht,V,0,vt),this._placeBack(U,ht,V,L,0,vt),this._placeForward(U,ht,V,L,0,vt),et.metricEnd()}_placeStraightAlong(U,V){var L,X,Q,$;const{out:J,id:et,shaping:st,zoomRange:ht,referenceBounds:_t}=this._current,{boxBorderLineColor:vt,boxBackgroundColor:Pt}=this.evaluatedMeshParams,zt=U.clone(),Et=U.angle*(180/Math.PI)%360,Ut=(U.angle*(180/Math.PI)+180)%360;if(st.glyphs.length>0&&(vt||Pt)){const L=Math.max(V,ht[0],0),X=Math.min(28,ht[1]),Q=(0,Pe.$0)((0,Te.vt)(),-U.angle),[$,vt]=st.shapeBackground(Q),Pt={minZoom:L,maxZoom:X,clipAngle:Et,mapAligned:!0,isLineLabel:!0};J.recordStart(this.instanceId,this.attributeLayout,st.glyphs[0].textureBinding),this._writeTextBox(J,et,U.x,U.y,vt,_t,Pt),J.recordEnd(),Pt.clipAngle=Ut,J.recordStart(this.instanceId,this.attributeLayout,st.glyphs[0].textureBinding),this._writeTextBox(J,et,U.x,U.y,vt,_t,Pt),J.recordEnd()}const Vt=(0,Ie.Q4)(et),Lt=null!==(L=null===(X=this.evaluatedMeshParams.scaleInfo)||void 0===X?void 0:X.maxScale)&&void 0!==L?L:0,Ot=null!==(Q=null===($=this.evaluatedMeshParams.scaleInfo)||void 0===$?void 0:$.minScale)&&void 0!==Q?Q:0;J.metricStart(new ze.f(Vt,U.x,U.y,0,0,Lt,Ot,null)),this._placeFirst(zt,V,1,Et,!0),this._placeFirst(zt,V,0,Ut,!0),J.metricEnd()}_placeBack(U,V,L,X,Q,$){const J=U.clone();let et=U.backwardLength+0;for(;J.prev()&&!(et>=X);)this._placeOnSegment(J,V,et,L,-1,Q,$),et+=J.length+0}_placeForward(U,V,L,X,Q,$){const J=U.clone();let et=U.remainingLength+0;for(;J.next()&&!(et>=X);)this._placeOnSegment(J,V,et,L,1,Q,$),et+=J.length+0}_placeFirst(U,V,L,X){let Q=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const $=U,{out:J,id:et,shaping:st,zoomRange:ht,referenceBounds:_t}=this._current,vt=st.glyphs;for(const Pt of vt){const vt=Pt.x>st.bounds.x?L:1-L,zt=vt*U.remainingLength+(1-vt)*U.backwardLength,Et=Math.abs(Pt.x+Pt.width/2-st.bounds.x),Ut=Math.max(0,this._zoomLevel+Math.log2(Et/(zt+0))),Vt=Math.max(V,Q?0:Ut);Pt.maxZoom=Math.min(ht[1],28),Pt.angle=U.angle+(1-L)*Math.PI,Pt.minZoom=Math.max(ht[0],Vt),J.metricBoxWrite(Pt.bounds),this._writeLineGlyph(J,et,$.x,$.y,st.bounds,Pt,X,_t,!0)}}_placeOnSegment(U,V,L,X,Q,$,J){const{out:et,id:st,shaping:ht,referenceBounds:_t}=this._current,vt=ht.glyphs,Pt=U.dx/U.length,zt=U.dy/U.length,Et={x:U.x+L*-Q*Pt,y:U.y+L*-Q*zt};for(const Ut of vt){const V=Ut.x>ht.bounds.x?$:1-$;if(!(V&&1===Q||!V&&-1===Q))continue;const vt=Math.abs(Ut.x+Ut.width/2-ht.bounds.x),Pt=Math.max(0,this._zoomLevel+Math.log2(vt/L)-.1),zt=Math.max(X,this._zoomLevel+Math.log2(vt/(L+U.length+0)));0!==Pt&&(Ut.angle=U.angle+(1-$)*Math.PI,Ut.minZoom=zt,Ut.maxZoom=Pt,this._writeLineGlyph(et,st,Et.x,Et.y,ht.bounds,Ut,J,_t,!0))}}_writeLineGlyph(U,V,L,X,Q,$,J,et,st){const ht=L+Q.x,_t=X+Q.y,vt=2*(this.evaluatedMeshParams.minPixelBuffer?this.evaluatedMeshParams.minPixelBuffer/this._textMeshTransformProps.fontSize:1),Pt=Math.max(Q.width,Q.height)*vt;U.recordStart(this.instanceId,this.attributeLayout,$.textureBinding),U.recordBounds(ht,_t,Pt,Pt);const{texcoords:zt,offsets:Et}=$,Ut=this._textMeshTransformProps.fontSize;this._writeQuad(U,V,L,X,{texcoords:zt,offsets:Et,fontSize:Ut,color:meshWriterUtils_h(this.evaluatedMeshParams.color),isBackground:!1,referenceBounds:et,minZoom:Math.max(this._current.zoomRange[0],$.minZoom),maxZoom:Math.min(this._current.zoomRange[1],$.maxZoom),clipAngle:J,mapAligned:st,isLineLabel:!0}),U.recordEnd()}}})},84792:(U,V,L)=>{function n(U){return U}function r(U){return U}L.d(V,{P:()=>n,U:()=>r})},80804:(U,V,L)=>{L.d(V,{f_:()=>P,$Z:()=>q,DM:()=>F,rz:()=>S});var X=L(80671),Q=L(80050),$=L(52988),J=L(42656),et=L(50886),st=L(58909);class p extends $.k2{getVisualVariableData(U){if(!this._vvData){const V=this.getAttributeDataCoords(U);this._vvData=(0,J.US)(this.visualVariableData,V).setDebugName("storage2")}return this._vvData}getAttributeDataCoords(U){if(!this._uv){const V=(0,st.Kt)(U),L=this.size,X=(0,J.Wh)(V.x),Q=(0,J.Wh)(V.y).multiply((0,J.Wh)(256)),$=(0,J.Wh)(V.z).multiply((0,J.Wh)(256)).multiply((0,J.Wh)(256)),et=(0,J.fV)(X.add(Q).add($)),ht=(0,J.zi)(et,L),_t=et.subtract(ht).divide(L);this._uv=new J.ZY(ht,_t).add(.5).divide(L)}return this._uv}getFilterData(U){const V=this.getAttributeDataCoords(U);return(0,J.US)(this.filterFlags,V).setDebugName("storage0")}getAnimationData(U){const V=this.getAttributeDataCoords(U);return(0,J.US)(this.animation,V).setDebugName("storage1")}getVVData(U){return this.getVisualVariableData(U)}getDataDrivenData0(U){const V=this.getAttributeDataCoords(U);return(0,J.US)(this.dataDriven0,V).setDebugName("storage30")}getDataDrivenData1(U){const V=this.getAttributeDataCoords(U);return(0,J.US)(this.dataDriven1,V).setDebugName("storage31")}getDataDrivenData2(U){const V=this.getAttributeDataCoords(U);return(0,J.US)(this.dataDriven2,V).setDebugName("storage32")}getGPGPUData(U){const V=this.getAttributeDataCoords(U);return(0,J.US)(this.gpgpu,V).setDebugName("storage4")}getFilterFlags(U){return(0,et.A)("webgl-ignores-sampler-precision")?(0,J.mk)(this.getFilterData(U).x.multiply((0,J.fV)(255))):this.getFilterData(U).x.multiply((0,J.fV)(255))}getAnimationValue(U){return this.getAnimationData(U).x}getSizeValue(U){return this.getVisualVariableData(U).x}getColorValue(U){return this.getVisualVariableData(U).y}getOpacityValue(U){return this.getVisualVariableData(U).z}getRotationValue(U){return this.getVisualVariableData(U).w}}(0,X._)([(0,$.Pi)(J.z7)],p.prototype,"filterFlags",void 0),(0,X._)([(0,$.Pi)(J.z7)],p.prototype,"animation",void 0),(0,X._)([(0,$.Pi)(J.z7)],p.prototype,"gpgpu",void 0),(0,X._)([(0,$.Pi)(J.z7)],p.prototype,"visualVariableData",void 0),(0,X._)([(0,$.Pi)(J.z7)],p.prototype,"dataDriven0",void 0),(0,X._)([(0,$.Pi)(J.z7)],p.prototype,"dataDriven1",void 0),(0,X._)([(0,$.Pi)(J.z7)],p.prototype,"dataDriven2",void 0),(0,X._)([(0,$.Pi)(J.nt)],p.prototype,"size",void 0);class e extends $.k2{}(0,X._)([(0,$.Pi)(J.nt)],e.prototype,"activeReasons",void 0),(0,X._)([(0,$.Pi)(J.nt)],e.prototype,"highlightAll",void 0);class ShaderHittest_e extends $.k2{}(0,X._)([(0,$.Pi)(J.ZY)],ShaderHittest_e.prototype,"position",void 0),(0,X._)([(0,$.Pi)(J.nt)],ShaderHittest_e.prototype,"distance",void 0),(0,X._)([(0,$.Pi)(J.nt)],ShaderHittest_e.prototype,"smallSymbolDistance",void 0),(0,X._)([(0,$.Pi)(J.nt)],ShaderHittest_e.prototype,"smallSymbolSizeThreshold",void 0);var ht=L(85439);class S extends $.ZA{}(0,X._)([(0,$.C5)(0,J.eB)],S.prototype,"id",void 0),(0,X._)([(0,$.C5)(1,J.nt)],S.prototype,"bitset",void 0),(0,X._)([(0,$.C5)(2,J.ZY)],S.prototype,"pos",void 0);class q extends $.Y7{}(0,X._)([(0,$.C5)(14,J.ZY)],q.prototype,"nextPos1",void 0),(0,X._)([(0,$.C5)(15,J.ZY)],q.prototype,"nextPos2",void 0);class F extends $.HS{}class P extends $.A{clip(U,V){let L=new J.nt(0);const X=this.storage.getFilterFlags(U);if(L=L.add((0,J.fV)(2).multiply((0,J.fV)(1).subtract((0,st.i6)(X,0)))),this.inside?L=L.add((0,J.fV)(2).multiply((0,J.fV)(1).subtract((0,st.i6)(X,1)))):this.outside?L=L.add((0,J.fV)(2).multiply((0,st.i6)(X,1))):this.highlight&&(L=L.add((0,J.fV)(2).multiply((0,J.fV)(1).subtract(this._checkHighlight(X))))),null!=V){const U=new J.nt(1).subtract((0,J.PM)(V.x,this.view.currentZoom)),X=(0,J.PM)(V.y,this.view.currentZoom);L=L.add(new J.nt(2).multiply(U.add(X)))}return L}getFragmentOutput(U,V){var L,X;let Q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new J.nt(1/255);const et=new $.mm;return et.glFragColor=null!==(L=null!==(X=this._maybeWriteHittest(V))&&void 0!==X?X:this._maybeHighlight(U,Q))&&void 0!==L?L:U,et}_maybeHighlight(U,V){return this.highlight?new J.Zb(U.rgb,(0,J.PM)(V,U.a)):null}_checkHighlight(U){let V=this._checkHighlightBit(U,0);for(let L=1;L<Q.M$.length;L++)V=V.add(this._checkHighlightBit(U,L));return(0,J.PM)(new J.nt(.1),V.add(this.highlight.highlightAll))}_checkHighlightBit(U,V){return(0,st.yS)(U,V).multiply((0,st.mh)(this.highlight.activeReasons,V))}maybeRunHittest(U,V,L){if(null==this.hittestRequest)return null;const X=this.hittest(U,V,L);let Q=(0,J.Tk)((0,J.MM)(X,this.hittestRequest.distance),new J.nt(2),new J.nt(0));const $=this.storage.getAttributeDataCoords(U.id),et=(0,st.nb)($);Q=Q.add(this.clip(U.id,U.zoomRange));const ht=new J.Zb(new J.nt(1/255),0,0,0);return{glPointSize:new J.nt(1),glPosition:new J.Zb(et,Q,1),color:ht}}_maybeWriteHittest(U){return null!=this.hittestRequest?U.color:null}}(0,X._)([$.E8],P.prototype,"inside",void 0),(0,X._)([$.E8],P.prototype,"outside",void 0),(0,X._)([(0,$.uK)(e)],P.prototype,"highlight",void 0),(0,X._)([(0,$.Pi)(p)],P.prototype,"storage",void 0),(0,X._)([(0,$.Pi)(ht.o)],P.prototype,"view",void 0),(0,X._)([(0,$.uK)(ShaderHittest_e)],P.prototype,"hittestRequest",void 0)},30824:(U,V,L)=>{L.d(V,{Bh:()=>D,KP:()=>B,Ps:()=>E});var X=L(80671),Q=L(80271),$=L(52988),J=L(42656),et=L(80804),st=L(11865),ht=L(66374),_t=L(2344),vt=L(37006),Pt=L(58909);class P extends ht._{}(0,X._)([(0,$.C5)(5,J.Zb)],P.prototype,"tlbr",void 0),(0,X._)([(0,$.C5)(6,J.nt)],P.prototype,"width",void 0),(0,X._)([(0,$.C5)(7,J.nt)],P.prototype,"height",void 0),(0,X._)([(0,$.C5)(8,J.ZY)],P.prototype,"offset",void 0),(0,X._)([(0,$.C5)(9,J.ZY)],P.prototype,"scale",void 0),(0,X._)([(0,$.C5)(10,J.nt)],P.prototype,"angle",void 0);class Z extends et.DM{}function B(U,V){const L=(0,J.jh)(new J.ZY(1),new J.ZY(1/Q.bg),new J.ZY((0,Pt.mh)(V.bitset,st.A),(0,Pt.mh)(V.bitset,st.lx))),X=U.view.requiredZoomFactor,$=new J.ZY(V.width,V.height).multiply(L),et=$.multiply(V.scale).multiply(X),ht=V.angle.multiply(st.rp),_t=(0,J.F8)(ht),vt=(0,J.gn)(ht),zt=function _(U,V,L,X,Q){const $=(0,J.LC)((0,Pt.mh)(Q,st.Fz),(0,J.fV)(1)),et=(0,Pt.Rj)(new J.Zb(U,0));return(0,J.Tk)($,(0,J.w0)(X.divide(V.x),L.divide(V.y),0,(0,J.ze)(L.divide(V.x)),X.divide(V.y),0,(0,Pt._9)((0,J.Zc)(et,0)),(0,Pt._9)((0,J.Zc)(0,et)),1),(0,J.w0)(X.divide(V.x),L.divide(V.y),0,(0,J.ze)(L.divide(V.x)),X.divide(V.y),0,0,0,1))}(V.id,et,_t,vt,V.bitset),Et=U.localTileOffset.getPatternOffsetAtTileOrigin($,_t,vt),Ut=X.multiply(V.scale).multiply(V.offset.subtract(Et)).divide(et),Vt=new J.eB(V.pos,1),Lt=zt.multiply(Vt).xy.subtract(Ut),Ot=V.tlbr.divide(U.mosaicInfo.size.xyxy);let Yt=(0,Pt.mh)(V.bitset,st.cn);return null!=U.visualVariableColor&&(Yt=(0,J.Tk)((0,Pt.M8)(U.storage.getColorValue(V.id)),new J.nt(0),Yt)),{tileTextureCoord:Lt,tlbr:Ot,sampleAlphaOnly:Yt}}function D(U,V){const L=(0,J.zi)(V.tileTextureCoord,new J.nt(1)),X=(0,J.jh)(V.tlbr.xy,V.tlbr.zw,L);let Q=(0,J.US)(U.mosaicInfo.texture,X);return Q=(0,J.Tk)((0,J.MM)(V.sampleAlphaOnly,new J.nt(.5)),Q.aaaa,Q),V.color.multiply(Q)}class E extends ht.z{vertex(U,V){return{...super.vertex(U,V),...B(this,U)}}fragment(U){const V=D(this,U);return this.getFragmentOutput(V,U,new J.nt(0))}}(0,X._)([(0,$.Pi)(vt.b)],E.prototype,"mosaicInfo",void 0),(0,X._)([(0,$.Pi)(_t.P)],E.prototype,"localTileOffset",void 0),(0,X._)([(0,X.a)(0,(0,$.hF)(P)),(0,X.a)(1,(0,$.hF)(et.$Z))],E.prototype,"vertex",null),(0,X._)([(0,X.a)(0,(0,$.hF)(Z))],E.prototype,"fragment",null)},61332:(U,V,L)=>{L.d(V,{RH:()=>C,cZ:()=>Et,v9:()=>Vt});var X=L(80671),Q=L(52988),$=L(42656),J=L(80804),et=L(30824),st=L(91352),ht=L(98345),_t=L(2344),vt=L(37006),Pt=L(56398),zt=L(81834);const Et=16,Ut=1/Et,Vt=128;class F extends J.rz{}(0,X._)([(0,Q.C5)(3,$.Zb)],F.prototype,"color",void 0),(0,X._)([(0,Q.C5)(4,$.Zb)],F.prototype,"tlbr",void 0),(0,X._)([(0,Q.C5)(5,$.nt)],F.prototype,"angle",void 0),(0,X._)([(0,Q.C5)(6,$.nt)],F.prototype,"aux1",void 0),(0,X._)([(0,Q.C5)(7,$.nt)],F.prototype,"aux2",void 0),(0,X._)([(0,Q.C5)(8,$.ZY)],F.prototype,"aux3",void 0),(0,X._)([(0,Q.C5)(9,$.ZY)],F.prototype,"aux4",void 0),(0,X._)([(0,Q.C5)(10,$.ZY)],F.prototype,"zoomRange",void 0);class R extends zt.A1{}class C extends Pt.My{vertex(U,V){const{aux1:L,aux2:X,aux3:Q,aux4:J}=U,st={...U,width:L,height:X,offset:Q,scale:J.multiply(Ut)},ht={...U,halfWidth:L.multiply(Ut),referenceHalfWidth:X.multiply(Ut),offset:Q.multiply(Ut),normal:J.subtract(Vt).multiply(Ut)},_t=(0,Pt.Yb)(this,ht),vt=(0,et.KP)(this,st),zt=(0,$.MM)(_t.isOutline,new $.nt(.5));return{..._t,...vt,...this.maybeRunHittest(U,V,zt)}}fragment(U){const{isOutline:V}=U,L=(0,$.MM)(V,new $.nt(.5)),X=(0,ht.o7)(U,this.antialiasingControls.blur),Q=(0,et.Bh)(this,U),J=(0,$.Tk)(L,X,Q),st=(0,$.Tk)(L,new $.nt(1/255),new $.nt(0));return this.getFragmentOutput(J,U,st)}hittest(U,V,L){return(0,$.Tk)(L,(0,st.My)(this.hittestRequest),(0,st.Lq)(this,U,V))}}(0,X._)([(0,Q.Pi)(vt.b)],C.prototype,"mosaicInfo",void 0),(0,X._)([(0,Q.Pi)(_t.P)],C.prototype,"localTileOffset",void 0),(0,X._)([(0,X.a)(0,(0,Q.hF)(F)),(0,X.a)(1,(0,Q.hF)(J.$Z))],C.prototype,"vertex",null),(0,X._)([(0,X.a)(0,(0,Q.hF)(R))],C.prototype,"fragment",null)},66374:(U,V,L)=>{L.d(V,{_:()=>g,z:()=>x});var X=L(80671),Q=L(52988),$=L(42656),J=L(80804),et=L(91352),st=L(51679),ht=L(66865),_t=L(6901);class g extends J.rz{}(0,X._)([(0,Q.C5)(3,$.Zb)],g.prototype,"color",void 0),(0,X._)([(0,Q.C5)(4,$.ZY)],g.prototype,"zoomRange",void 0);class x extends J.f_{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(U,V){const L=(0,_t.cF)(this,U.id),X=(0,_t.G7)(this,U.id,U.color).multiply(L),Q=this.view.displayViewScreenMat3.multiply(new $.eB(U.pos.xy,1)),J=this.clip(U.id,U.zoomRange);return{glPosition:new $.Zb(Q.xy,J,1),color:X,...this.maybeRunHittest(U,V,null)}}fragment(U){return this.getFragmentOutput(U.color,U,new $.nt(0))}hittest(U,V){return(0,et.Lq)(this,U,V)}}(0,X._)([(0,Q.uK)(st._)],x.prototype,"visualVariableColor",void 0),(0,X._)([(0,Q.uK)(ht.i)],x.prototype,"visualVariableOpacity",void 0),(0,X._)([(0,X.a)(0,(0,Q.hF)(g)),(0,X.a)(1,(0,Q.hF)(J.$Z))],x.prototype,"vertex",null),(0,X._)([(0,X.a)(0,(0,Q.hF)(J.DM))],x.prototype,"fragment",null)},98345:(U,V,L)=>{L.d(V,{$0:()=>T,Xc:()=>q,cM:()=>B,fF:()=>A,fg:()=>F,o7:()=>_,xw:()=>D});var X=L(80671),Q=L(52988),$=L(42656),J=L(80804),et=L(11865),st=L(91352),ht=L(51679),_t=L(66865),vt=L(81580),Pt=L(94692),zt=L(21326),Et=L(11088),Ut=L(6901);class q extends J.rz{}(0,X._)([(0,Q.C5)(3,$.Zb)],q.prototype,"color",void 0),(0,X._)([(0,Q.C5)(4,$.ZY)],q.prototype,"offset",void 0),(0,X._)([(0,Q.C5)(5,$.ZY)],q.prototype,"normal",void 0),(0,X._)([(0,Q.C5)(6,$.nt)],q.prototype,"halfWidth",void 0),(0,X._)([(0,Q.C5)(7,$.nt)],q.prototype,"referenceHalfWidth",void 0),(0,X._)([(0,Q.C5)(8,$.ZY)],q.prototype,"zoomRange",void 0);class A extends J.DM{}class F extends Q.k2{}function k(U){return(0,$.T9)(new $.nt(et.Fb).multiply((0,$.PM)(U,new $.nt(et.J5))),new $.nt(1))}function D(U,V){const{halfWidth:L,normal:X}=U,Q=k(L),J=(0,$.Bw)(X).multiply(L);return(0,$.qE)(Q.multiply(L.subtract(J)).divide(V.add(Q).subtract(new $.nt(1))),new $.nt(0),new $.nt(1))}function T(U,V){const{id:L,offset:X,pos:Q,normal:J,zoomRange:st}=V,{displayViewScreenMat3:ht,displayViewMat3:_t}=U.view,vt=(0,Ut.G7)(U,L,V.color),Pt=(0,Ut.cF)(U,L),zt=function G(U,V){const{id:L,halfWidth:X,referenceHalfWidth:Q}=V;if((0,Ut.G5)(U)){const V=new $.nt(2).multiply(Q),J=(0,Ut.Mg)(U,L,V);return new $.nt(.5).multiply(X.divide((0,$.T9)(Q,new $.nt(et.Ni)))).multiply(J)}return X}(U,V),Et=new $.nt(.5).multiply(U.antialiasingControls.antialiasing),Vt=(0,$.T9)(zt.add(Et),new $.nt(.45)).add(new $.nt(.1).multiply(Et)),Lt=k(Vt).multiply(Vt).multiply(X),Ot=_t.multiply(new $.eB(Lt,new $.nt(0))),Yt=ht.multiply(new $.eB(Q,new $.nt(1))).add(Ot),qt=new $.nt(2).multiply((0,$.PM)(zt,new $.nt(0))).add(U.clip(L,st)),Qt=new $.Zb(Yt.xy,qt,1);return{color:vt,opacity:Pt,halfWidth:Vt,normal:J,scaledOffset:Lt,scaledHalfWidth:zt,glPosition:new $.Zb(Qt.xy,qt,1)}}function _(U,V){const{opacity:L,color:X}=U,Q=D(U,V);return L.multiply(X).multiply(Q)}(0,X._)([(0,Q.Pi)($.nt)],F.prototype,"antialiasing",void 0),(0,X._)([(0,Q.Pi)($.nt)],F.prototype,"blur",void 0);class B extends J.f_{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(U,V){const L=T(this,U);return{...L,...this.maybeRunHittest(U,V,L.halfWidth)}}fragment(U){const V=_(U,this.antialiasingControls.blur);return this.getFragmentOutput(V,U)}hittest(U,V,L){const{viewMat3:X,tileMat3:Q}=this.view,J=X.multiply(Q),et=J.multiply(new $.eB(U.pos,1)),ht=J.multiply(new $.eB(V.nextPos1,1)),_t=J.multiply(new $.eB(V.nextPos2,1)),{distance:vt,smallSymbolDistance:Pt,smallSymbolSizeThreshold:zt}=this.hittestRequest,Et=(0,$.PM)(L,zt.multiply(.5)).multiply(vt.subtract(Pt)),Ut=this.hittestRequest.position;return(0,$.jk)((0,st.E2)(Ut,et.xy,ht.xy),(0,st.E2)(Ut,et.xy,_t.xy)).subtract(L).add(Et)}}(0,X._)([(0,Q.Pi)(F)],B.prototype,"antialiasingControls",void 0),(0,X._)([(0,Q.uK)(ht._)],B.prototype,"visualVariableColor",void 0),(0,X._)([(0,Q.uK)(_t.i)],B.prototype,"visualVariableOpacity",void 0),(0,X._)([(0,Q.uK)(vt.n)],B.prototype,"visualVariableSizeMinMaxValue",void 0),(0,X._)([(0,Q.uK)(Pt.F)],B.prototype,"visualVariableSizeScaleStops",void 0),(0,X._)([(0,Q.uK)(zt.N)],B.prototype,"visualVariableSizeStops",void 0),(0,X._)([(0,Q.uK)(Et.d)],B.prototype,"visualVariableSizeUnitValue",void 0),(0,X._)([(0,X.a)(0,(0,Q.hF)(q)),(0,X.a)(1,(0,Q.hF)(J.$Z))],B.prototype,"vertex",null),(0,X._)([(0,X.a)(0,(0,Q.hF)(A))],B.prototype,"fragment",null)},2344:(U,V,L)=>{L.d(V,{P:()=>n});var X=L(80671),Q=L(52988),$=L(42656),J=L(11865);class n extends Q.k2{getPatternOffsetAtTileOrigin(U){let V=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $.nt(0),L=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new $.nt(1);const X=new $.ZY(J.YV).divide(U);let Q=U.multiply((0,$.jc)(this.maxIntsToLocalOrigin.multiply(X))).add(this.tileOffsetFromLocalOrigin).subtract(new $.nt(.5).multiply(U));return Q=new $.ZY(Q.x.multiply(L).subtract(Q.y.multiply(V)),Q.x.multiply(V).add(Q.y.multiply(L))),(0,$.zi)(Q,U)}}(0,X._)([(0,Q.Pi)($.ZY)],n.prototype,"tileOffsetFromLocalOrigin",void 0),(0,X._)([(0,Q.Pi)($.ZY)],n.prototype,"maxIntsToLocalOrigin",void 0)},37006:(U,V,L)=>{L.d(V,{b:()=>p});var X=L(80671),Q=L(52988),$=L(42656);class p extends Q.k2{}(0,X._)([(0,Q.Pi)($.ZY)],p.prototype,"size",void 0),(0,X._)([(0,Q.Pi)($.z7)],p.prototype,"texture",void 0)},56398:(U,V,L)=>{L.d(V,{A7:()=>R,My:()=>F,Yb:()=>A,nj:()=>H,wG:()=>W});var X=L(80671),Q=L(52988),$=L(42656),J=L(80804),et=L(11865),st=L(91352),ht=L(98345),_t=L(58909),vt=L(51679),Pt=L(66865),zt=L(81580),Et=L(94692),Ut=L(21326),Vt=L(11088),Lt=L(6901);class W extends J.rz{}(0,X._)([(0,Q.C5)(3,$.ZY)],W.prototype,"offset",void 0),(0,X._)([(0,Q.C5)(4,$.Zb)],W.prototype,"color",void 0),(0,X._)([(0,Q.C5)(5,$.ZY)],W.prototype,"normal",void 0),(0,X._)([(0,Q.C5)(6,$.nt)],W.prototype,"halfWidth",void 0),(0,X._)([(0,Q.C5)(7,$.nt)],W.prototype,"referenceHalfWidth",void 0),(0,X._)([(0,Q.C5)(8,$.ZY)],W.prototype,"zoomRange",void 0);class R extends ht.fF{}function A(U,V,L){const{id:X,bitset:Q}=V,J=(0,_t.mh)(Q,et.Xx),st=(0,$.MM)(J,new $.nt(.5)),vt=(0,ht.$0)(U,V),Pt=(0,$.Tk)(st,vt.halfWidth,new $.nt(0)),zt=(0,Lt.cF)(U,X),Et=(0,Lt.G7)(U,X,V.color),Ut=(0,$.Tk)(st,V.color,Et.multiply(zt)),Vt=U.view.displayViewScreenMat3.multiply(new $.eB(V.pos.xy,1)),Ot=U.clip(V.id),Yt=new $.Zb(Vt.xy,Ot,1),qt=(0,$.Tk)(st,vt.glPosition,Yt),Qt=L&&U.maybeRunHittest(V,L,st);return{isOutline:J,color:Ut,opacity:new $.nt(1),halfWidth:Pt,normal:vt.normal,glPosition:qt,...Qt}}class F extends J.f_{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}}(0,X._)([(0,Q.Pi)(ht.fg)],F.prototype,"antialiasingControls",void 0),(0,X._)([(0,Q.uK)(vt._)],F.prototype,"visualVariableColor",void 0),(0,X._)([(0,Q.uK)(Pt.i)],F.prototype,"visualVariableOpacity",void 0),(0,X._)([(0,Q.uK)(zt.n)],F.prototype,"visualVariableSizeMinMaxValue",void 0),(0,X._)([(0,Q.uK)(Et.F)],F.prototype,"visualVariableSizeScaleStops",void 0),(0,X._)([(0,Q.uK)(Ut.N)],F.prototype,"visualVariableSizeStops",void 0),(0,X._)([(0,Q.uK)(Vt.d)],F.prototype,"visualVariableSizeUnitValue",void 0);class H extends F{vertex(U,V){return A(this,U,V)}fragment(U){const{color:V,isOutline:L}=U,X=(0,$.MM)(L,new $.nt(.5)),Q=(0,ht.o7)(U,this.antialiasingControls.blur),J=(0,$.Tk)(X,Q,V),et=(0,$.Tk)(X,new $.nt(1/255),new $.nt(0));return this.getFragmentOutput(J,U,et)}hittest(U,V,L){return(0,$.Tk)(L,(0,st.My)(this.hittestRequest),(0,st.Lq)(this,U,V))}}(0,X._)([(0,X.a)(0,(0,Q.hF)(W)),(0,X.a)(1,(0,Q.hF)(J.$Z))],H.prototype,"vertex",null),(0,X._)([(0,X.a)(0,(0,Q.hF)(R))],H.prototype,"fragment",null)},8570:(U,V,L)=>{L.d(V,{_u:()=>O,dW:()=>T,vx:()=>z});var X=L(80671),Q=L(52988),$=L(42656),J=L(80804),et=L(66374),st=L(2344),ht=L(37006);class h extends et._{}(0,X._)([(0,Q.C5)(5,$.Zb)],h.prototype,"tlbr",void 0),(0,X._)([(0,Q.C5)(6,$.nt)],h.prototype,"inverseRasterizationScale",void 0);class g extends J.DM{}function O(U,V){const L=V.tlbr.xy,X=V.tlbr.zw,Q=X.x.subtract(L.x),J=L.y.subtract(X.y),et=new $.ZY(Q,J).multiply(V.inverseRasterizationScale),st=et.multiply(U.view.requiredZoomFactor),ht=function j(U){const V=new $.nt(1),L=new $.nt(0);return new $.U(V.divide(U.x),L.divide(U.y),0,(0,$.ze)(L.divide(U.x)),V.divide(U.y),0,0,0,1)}(st),_t=U.localTileOffset.getPatternOffsetAtTileOrigin(et).divide(st),vt=new $.eB(V.pos,1);return{tileTextureCoord:ht.multiply(vt).xy.subtract(_t),tlbr:V.tlbr.divide(U.mosaicInfo.size.xyxy)}}function T(U,V){const L=(0,$.zi)(U.tileTextureCoord,new $.nt(1)),X=(0,$.jh)(U.tlbr.xy,U.tlbr.zw,L),Q=(0,$.US)(V.texture,X);return U.color.multiply(Q)}class z extends et.z{vertex(U,V){return{...super.vertex(U,V),...O(this,U)}}fragment(U){const V=T(U,this.mosaicInfo);return this.getFragmentOutput(V,U,new $.nt(0))}}(0,X._)([(0,Q.Pi)(ht.b)],z.prototype,"mosaicInfo",void 0),(0,X._)([(0,Q.Pi)(st.P)],z.prototype,"localTileOffset",void 0),(0,X._)([(0,X.a)(0,(0,Q.hF)(h)),(0,X.a)(1,(0,Q.hF)(J.$Z))],z.prototype,"vertex",null),(0,X._)([(0,X.a)(0,(0,Q.hF)(g))],z.prototype,"fragment",null)},81834:(U,V,L)=>{L.d(V,{A1:()=>y,tA:()=>S});var X=L(80671),Q=L(52988),$=L(42656),J=L(80804),et=L(98345),st=L(2344),ht=L(37006),_t=L(56398),vt=L(8570);class x extends _t.wG{}(0,X._)([(0,Q.C5)(9,$.Zb)],x.prototype,"tlbr",void 0),(0,X._)([(0,Q.C5)(10,$.nt)],x.prototype,"inverseRasterizationScale",void 0);class y extends _t.A7{}class S extends _t.nj{vertex(U,V){return{...(0,_t.Yb)(this,U,V),...(0,vt._u)(this,U)}}fragment(U){const{isOutline:V}=U,L=(0,$.MM)(V,new $.nt(.5)),X=(0,et.o7)(U,this.antialiasingControls.blur),Q=(0,vt.dW)(U,this.mosaicInfo),J=(0,$.Tk)(L,X,Q),st=(0,$.Tk)(L,new $.nt(1/255),new $.nt(0));return this.getFragmentOutput(J,U,st)}}(0,X._)([(0,Q.Pi)(ht.b)],S.prototype,"mosaicInfo",void 0),(0,X._)([(0,Q.Pi)(st.P)],S.prototype,"localTileOffset",void 0),(0,X._)([(0,X.a)(0,(0,Q.hF)(x)),(0,X.a)(1,(0,Q.hF)(J.$Z))],S.prototype,"vertex",null),(0,X._)([(0,X.a)(0,(0,Q.hF)(y))],S.prototype,"fragment",null)},85439:(U,V,L)=>{L.d(V,{o:()=>d});var X=L(80671),Q=L(52988),$=L(42656);class d extends Q.k2{}(0,X._)([(0,Q.Pi)($.U)],d.prototype,"displayViewScreenMat3",void 0),(0,X._)([(0,Q.Pi)($.U)],d.prototype,"displayViewMat3",void 0),(0,X._)([(0,Q.Pi)($.U)],d.prototype,"displayMat3",void 0),(0,X._)([(0,Q.Pi)($.U)],d.prototype,"viewMat3",void 0),(0,X._)([(0,Q.Pi)($.U)],d.prototype,"tileMat3",void 0),(0,X._)([(0,Q.Pi)($.nt)],d.prototype,"displayZoomFactor",void 0),(0,X._)([(0,Q.Pi)($.nt)],d.prototype,"requiredZoomFactor",void 0),(0,X._)([(0,Q.Pi)($.ZY)],d.prototype,"tileOffset",void 0),(0,X._)([(0,Q.Pi)($.nt)],d.prototype,"currentScale",void 0),(0,X._)([(0,Q.Pi)($.nt)],d.prototype,"currentZoom",void 0),(0,X._)([(0,Q.Pi)($.nt)],d.prototype,"metersPerSRUnit",void 0),(0,X._)([(0,Q.Pi)($.nt)],d.prototype,"rotation",void 0),(0,X._)([(0,Q.Pi)($.nt)],d.prototype,"pixelRatio",void 0)},51679:(U,V,L)=>{L.d(V,{_:()=>f});var X=L(80671),Q=L(52988),$=L(42656),J=L(58909);class f extends Q.k2{getColor(U,V,L){return(0,$.j1)([(0,$.or)((0,J.M8)(U),L),V],[(0,$.$5)(U,this.values.first()),this.colors.first()],[(0,$.aX)(U,this.values.last()),this.colors.last()],[!0,()=>{const V=this.values.findIndex((V=>(0,$.MM)(V,U))),L=this.values.get(V),X=V.subtract(1),Q=this.values.get(X),J=U.subtract(Q).divide(L.subtract(Q));return(0,$.jh)(this.colors.get(X),this.colors.get(V),J)}])}}(0,X._)([(0,Q.Pi)($.My.ofType($.Zb,8))],f.prototype,"colors",void 0),(0,X._)([(0,Q.Pi)($.My.ofType($.nt,8))],f.prototype,"values",void 0)},66865:(U,V,L)=>{L.d(V,{i:()=>h});var X=L(80671),Q=L(52988),$=L(42656),J=L(58909);class h extends Q.k2{getOpacity(U){return(0,$.j1)([(0,J.M8)(U),new $.nt(1)],[(0,$.$5)(U,this.opacityValues.first()),this.opacities.first()],[(0,$.aX)(U,this.opacityValues.last()),this.opacities.last()],[!0,()=>{const V=this.opacityValues.findIndex((V=>(0,$.MM)(V,U))),L=this.opacityValues.get(V),X=V.subtract(1),Q=this.opacityValues.get(X),J=U.subtract(Q).divide(L.subtract(Q));return(0,$.jh)(this.opacities.get(X),this.opacities.get(V),J)}])}}(0,X._)([(0,Q.Pi)($.My.ofType($.nt,8))],h.prototype,"opacities",void 0),(0,X._)([(0,Q.Pi)($.My.ofType($.nt,8))],h.prototype,"opacityValues",void 0)},81580:(U,V,L)=>{L.d(V,{n:()=>m});var X=L(80671),Q=L(52988),$=L(42656),J=L(58909);class m extends Q.k2{getSize(U,V){const L=this.minMaxValueAndSize.xy,X=this.minMaxValueAndSize.zw;return(0,$.Tk)((0,J.M8)(U),V,(()=>{const V=U.subtract(L.x).divide(L.y.subtract(L.x)),Q=(0,$.qE)(V,new $.nt(0),new $.nt(1));return X.x.add(Q.multiply(X.y.subtract(X.x)))}))}}(0,X._)([(0,Q.Pi)($.Zb)],m.prototype,"minMaxValueAndSize",void 0)},94692:(U,V,L)=>{L.d(V,{F:()=>p});var X=L(80671),Q=L(52988),$=L(42656);class p extends Q.k2{getSizeForViewScale(U){return(0,$.j1)([(0,$.$5)(U,this.values.first()),this.sizes.first()],[(0,$.aX)(U,this.values.last()),this.sizes.last()],[!0,()=>{const V=this.values.findIndex((V=>(0,$.MM)(V,U))),L=this.values.get(V),X=V.subtract(1),Q=this.values.get(X),J=U.subtract(Q).divide(L.subtract(Q));return(0,$.jh)(this.sizes.get(X),this.sizes.get(V),J)}])}}(0,X._)([(0,Q.Pi)($.My.ofType($.nt,8))],p.prototype,"sizes",void 0),(0,X._)([(0,Q.Pi)($.My.ofType($.nt,8))],p.prototype,"values",void 0)},21326:(U,V,L)=>{L.d(V,{N:()=>f});var X=L(80671),Q=L(52988),$=L(42656),J=L(58909);class f extends Q.k2{getSize(U,V){const L=(0,$.j1)([(0,J.M8)(U),V],[(0,$.$5)(U,this.values.first()),this.sizes.first()],[(0,$.aX)(U,this.values.last()),this.sizes.last()],[!0,()=>{const V=this.values.findIndex((V=>(0,$.MM)(V,U))),L=this.values.get(V),X=V.subtract(1),Q=this.values.get(X),J=U.subtract(Q).divide(L.subtract(Q));return(0,$.jh)(this.sizes.get(X),this.sizes.get(V),J)}]);return(0,$.Tk)((0,J.M8)(L),V,L)}}(0,X._)([(0,Q.Pi)($.My.ofType($.nt,8))],f.prototype,"sizes",void 0),(0,X._)([(0,Q.Pi)($.My.ofType($.nt,8))],f.prototype,"values",void 0)},11088:(U,V,L)=>{L.d(V,{d:()=>l});var X=L(80671),Q=L(52988),$=L(42656),J=L(58909);class l extends Q.k2{getSize(U,V){return(0,$.Tk)((0,J.M8)(U),V,U.multiply(this.unitValueToPixelsRatio))}}(0,X._)([(0,Q.Pi)($.nt)],l.prototype,"unitValueToPixelsRatio",void 0)},11865:(U,V,L)=>{var X;L.d(V,{$w:()=>_t,A:()=>Ot,Fb:()=>et,Fz:()=>Vt,H_:()=>X,J5:()=>st,M:()=>Pt,Ni:()=>vt,V5:()=>J,Xx:()=>Ut,YV:()=>ne,au:()=>ht,b5:()=>qt,bg:()=>Qt,cn:()=>Et,kx:()=>Yt,lx:()=>Lt,os:()=>Q,qM:()=>zt,rp:()=>$,ti:()=>re}),function(U){U[U.Geographic=0]="Geographic",U[U.Arithmatic=1]="Arithmatic"}(X||(X={}));const Q=3.14159265359/180,$=3.14159265359/128,J=1,et=1.1,st=1,ht=24,_t=8,vt=1e-5,Pt=.05,zt=1e-30,Et=4,Ut=0,Vt=2,Lt=5,Ot=6,Yt=2,qt=3,Qt=0,re=3,ne=16777216},91352:(U,V,L)=>{L.d(V,{Bo:()=>P,Bs:()=>h,E2:()=>j,Lq:()=>z,My:()=>q,g$:()=>R,kW:()=>g});var X=L(42656),Q=L(11865),$=L(58909);function j(U,V,L){const Q=L.subtract(V),$=function v(U,V){return(0,X.Om)(U,(0,X.S8)(V))}(U.subtract(V),Q),J=(0,X.qE)($.divide((0,X.Bw)(Q)),new X.nt(0),new X.nt(1));return(0,X.Io)(U,V.add(J.multiply(L.subtract(V))))}function g(U){const V=(0,X.tn)(U);return(0,X.PM)(V.x.add(V.y).add(V.z),new X.nt(1.05))}function h(U,V,L,Q){const $=new X.U(L.x.multiply(Q.y).subtract(Q.x.multiply(L.y)),Q.x.multiply(V.y).subtract(V.x.multiply(Q.y)),V.x.multiply(L.y).subtract(L.x.multiply(V.y)),L.y.subtract(Q.y),Q.y.subtract(V.y),V.y.subtract(L.y),Q.x.subtract(L.x),V.x.subtract(Q.x),L.x.subtract(V.x)),J=V.x.multiply(L.y.subtract(Q.y)),et=L.x.multiply(Q.y.subtract(V.y)),st=Q.x.multiply(V.y.subtract(L.y)),ht=J.add(et).add(st);return new X.nt(1).divide(ht).multiply($.multiply(new X.eB(1,U)))}function M(U,V,L,Q){return(0,X.LC)(g(h(U,V,L,Q)),new X.nt(1))}function P(U,V,L,J){const et=L.subtract(V),st=J.subtract(V),ht=(0,$.tL)(et,st),_t=(0,X.Uo)((0,X.Xe)(ht,new X.nt(Q.M)),(0,X.MM)(ht,new X.nt(-Q.M)));return(0,X.j1)([(0,X.Uo)((0,X.AU)(_t),M(U.xy,V,L,J)),new X.nt(-1)],[!0,()=>{const Q=j(U,V,L),$=j(U,L,J),et=j(U,J,V);return(0,X.jk)((0,X.jk)(Q,$),et)}])}function q(U){return U.distance.add(1)}function z(U,V,L){const{viewMat3:Q,tileMat3:$}=U.view,J=Q.multiply($),et=J.multiply(new X.eB(V.pos,1)),st=J.multiply(new X.eB(L.nextPos1,1)),ht=J.multiply(new X.eB(L.nextPos2,1));return P(U.hittestRequest.position,et.xy,st.xy,ht.xy)}function R(U,V,L){return(0,X.Io)(U,L).subtract(V)}},58909:(U,V,L)=>{L.d(V,{K5:()=>z,Kt:()=>R,M8:()=>h,Rj:()=>k,_9:()=>g,i6:()=>v,mh:()=>j,nb:()=>d,tL:()=>b,xf:()=>q,yS:()=>w});var X=L(80050),Q=L(42656),$=L(11865);function g(U){const V=(0,Q.fV)(12.9898),L=(0,Q.fV)(78.233),X=(0,Q.fV)(43758.5453),$=(0,Q.Om)(U,(0,Q.Zc)(V,L)),J=(0,Q.zi)($,(0,Q.fV)(3.14));return(0,Q.jc)((0,Q.F8)(J).multiply(X))}function h(U){return(0,Q.LC)(U,(0,Q.fV)($.qM))}function b(U,V){return U.x.multiply(V.y).subtract(V.x.multiply(U.y))}function d(U){return U.multiply(2).subtract(1)}function j(U,V){const L=(0,Q.fV)(2**V);return(0,Q.zi)((0,Q.RI)(U.divide(L)),(0,Q.fV)(2))}function z(U,V){return(0,Q.MM)(j(U,V),(0,Q.fV)(.5))}function v(U,V){return j(U,V+X.M$.length)}function w(U,V){return j(U,V)}function R(U){const V=j(U.z,7),L=(0,Q.fV)(1).subtract(V),X=U.xyz.subtract((0,Q.eR)(0,0,(0,Q.fV)(128)));return L.multiply(U).add(V.multiply(X))}function k(U){const V=(0,Q.ln)(255/256,255/65536,255/16777216,255/4294967296);return(0,Q.Om)(U,V)}function q(U){return(0,Q.T9)((0,Q.T9)((0,Q.T9)(U.x,U.y),U.z),U.w)}},6901:(U,V,L)=>{L.d(V,{G5:()=>l,G7:()=>r,Mg:()=>t,TL:()=>n,cF:()=>u});var X=L(42656);function l(U){return null!=U.visualVariableSizeMinMaxValue||null!=U.visualVariableSizeScaleStops||null!=U.visualVariableSizeStops||null!=U.visualVariableSizeUnitValue}function t(U,V,L){if(l(U)){var X,Q,$,J,et,st,ht;const _t=U.storage.getSizeValue(V);return null!==(X=null!==(Q=null!==($=null===(J=U.visualVariableSizeMinMaxValue)||void 0===J?void 0:J.getSize(_t,L))&&void 0!==$?$:null===(et=U.visualVariableSizeScaleStops)||void 0===et?void 0:et.getSizeForViewScale(U.view.currentScale))&&void 0!==Q?Q:null===(st=U.visualVariableSizeStops)||void 0===st?void 0:st.getSize(_t,L))&&void 0!==X?X:null===(ht=U.visualVariableSizeUnitValue)||void 0===ht?void 0:ht.getSize(_t,L)}return L}function r(U,V,L){let Q=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new X.x(!1);if(null==U.visualVariableColor)return L;const $=U.storage.getColorValue(V);return U.visualVariableColor.getColor($,L,Q)}function u(U,V){if(null==U.visualVariableOpacity)return new X.nt(1);const L=U.storage.getOpacityValue(V);return U.visualVariableOpacity.getOpacity(L)}function n(U,V){if(null==U.visualVariableRotation)return X.U.identity();const L=U.storage.getRotationValue(V);return U.visualVariableRotation.getVVRotationMat3(L)}},65135:(U,V,L)=>{L.d(V,{K:()=>a});var X=L(4180),Q=L(89412),$=L(2395),J=(L(76761),L(50886),L(71014),L(60985),L(50707),L(76073)),et=(L(87107),L(83663),L(82380));function n(U,V,L){const $=V.length;if($!==L){const J=new X.A("Invalid Uniform","Invalid length, expected ".concat(L," but got ").concat($),{uniformName:U,values:V});Q.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.typed.TypedShaderProgram").errorOnce(J)}}class a{constructor(U,V,L,X,Q,$){this._program=null,this._vao=null,this._temporaryTextures=[],this.vertexShader=U,this.fragmentShader=V,this._locations=L,this._locationInfo=X,this._uniformBindings=Q,this._transformFeedbackBindings=$}destroy(){this._program&&this._program.dispose(),this.cleanupTemporaryTextures()}get locations(){return this._locations}get locationInfo(){return this._locationInfo}setUniforms(U){this._uniforms=U}cleanupTemporaryTextures(){for(const U of this._temporaryTextures)U.dispose();this._temporaryTextures=[]}bind(U){const V=this._uniforms;if(!this._program){const V=new Map;for(const[U,L]of this._locations)V.set(U,L);const X=[];for(const U of null!==(L=this._transformFeedbackBindings)&&void 0!==L?L:[]){var L;const{index:V,propertyKey:Q}=U;X[V]="v_".concat(Q)}this._program=new J.B(U,this.vertexShader,this.fragmentShader,V,new Map,X)}const X=this._program;U.useProgram(X);for(const Q of this._uniformBindings){const{shaderModulePath:L,uniformName:J,uniformType:st,uniformArrayLength:ht}=Q,_t=(0,$.wc)(L,V);if(null==_t){if("sampler2D"===st)continue;throw new Error("Failed to find uniform value for ".concat(L))}switch("array"===st?Q.uniformArrayElementType:st){case"sampler2D":{const{unit:V,texture:L}=_t;if(X.setUniform1i(J,V),"type"in L)U.bindTexture(L,V);else{const X=(0,et.sZ)(U,L.descriptor,L.data);U.bindTexture(X,V)}break}case"int":if(!ht){X.setUniform1i(J,_t);break}n(Q.uniformName,_t,ht),X.setUniform1iv(J,_t);break;case"float":if(!ht){X.setUniform1f(J,_t);break}n(Q.uniformName,_t,ht),X.setUniform1fv(J,_t);break;case"vec2":if(!ht){X.setUniform2f(J,_t[0],_t[1]);break}n(Q.uniformName,_t,ht),X.setUniform2fv(J,_t.flat());break;case"vec3":if(!ht){X.setUniform3f(J,_t[0],_t[1],_t[2]);break}n(Q.uniformName,_t,ht),X.setUniform3fv(J,_t.flat());break;case"vec4":if(!ht){X.setUniform4f(J,_t[0],_t[1],_t[2],_t[3]);break}n(Q.uniformName,_t,ht),X.setUniform4fv(J,_t.flat());break;case"mat3":X.setUniformMatrix3fv(J,_t.flat());break;case"mat4":X.setUniformMatrix4fv(J,_t.flat());break;default:throw new Error("Unable to set uniform for type ".concat(st))}}}}},72593:(U,V,L)=>{L.d(V,{F:()=>vt});var X=L(80671),Q=L(18763),$=L(50886),J=L(76193),et=L(63390),st=L(57453),ht=(L(89412),L(76761),L(68682)),_t=L(31059);let vt=class extends Q.A{constructor(U){super(U),this.debugName="",this._updatingHandles=new _t.U,this._idToUpdatingState=new J.A}get updating(){const U=this._updatingHandles.updating||Array.from(this._idToUpdatingState.values()).some((U=>U));if((0,$.A)("esri-2d-log-updating")){const V=Array.from(this._idToUpdatingState.entries()).map((U=>{let[V,L]=U;return"-> ".concat(V,": ").concat(L)})).join("\n");console.log("".concat(this.debugName,": Updating: ").concat(U,"\n-> Handles: ").concat(this._updatingHandles.updating,"\n").concat(V))}return U}addUpdateTracking(U,V){const L=(0,et.wB)((()=>V.updating),(V=>this._idToUpdatingState.set(U,V)),{sync:!0});this.addHandles(L)}addPromise(U){return this._updatingHandles.addPromise(U)}};(0,X._)([(0,st.MZ)({constructOnly:!0})],vt.prototype,"debugName",void 0),(0,X._)([(0,st.MZ)({readOnly:!0})],vt.prototype,"updating",null),vt=(0,X._)([(0,ht.$)("esri.view.2d.layers.support.UpdateTracking2D")],vt)},45981:(U,V,L)=>{var X;L.d(V,{c:()=>X}),function(U){U[U.Pass=0]="Pass",U[U.Draw=1]="Draw"}(X||(X={}))},22650:(U,V,L)=>{L.d(V,{L:()=>f,MX:()=>c,M_:()=>l,O_:()=>i,kL:()=>u,vA:()=>s,zH:()=>m});var X=L(52273);L(14223);(0,L(40727).vt)();class o{constructor(U){this.message=U}toString(){return"AssertException: ".concat(this.message)}}function s(U,V){if(!U){V=V||"Assertion";const U=new Error(V).stack;throw new o("".concat(V," at ").concat(U))}}function c(U,V){U||(V=V||"",console.warn("Verify failed: "+V+"\n"+new Error("verify").stack))}function i(U,V,L,X){let Q,$=(L[0]-U[0])/V[0],J=(X[0]-U[0])/V[0];$>J&&(Q=$,$=J,J=Q);let et=(L[1]-U[1])/V[1],st=(X[1]-U[1])/V[1];if(et>st&&(Q=et,et=st,st=Q),$>st||et>J)return!1;et>$&&($=et),st<J&&(J=st);let ht=(L[2]-U[2])/V[2],_t=(X[2]-U[2])/V[2];return ht>_t&&(Q=ht,ht=_t,_t=Q),!($>_t||ht>J)&&(_t<J&&(J=_t),!(J<0))}function f(U,V,L,Q,$){let J=arguments.length>5&&void 0!==arguments[5]?arguments[5]:(0,X.vt)();const et=(Q[$]-L[$])*(V[0]-U[0])-(Q[0]-L[0])*(V[$]-U[$]),st=(Q[0]-L[0])*(U[$]-L[$])-(Q[$]-L[$])*(U[0]-L[0]);if(0===et)return!1;const ht=st/et;return J[0]=U[0]+ht*(V[0]-U[0]),J[1]=U[$]+ht*(V[$]-U[$]),!0}function u(U,V){return Math.log(U)/Math.log(V)}function l(U,V,L,X){U[12]=V,U[13]=L,U[14]=X}function m(U){return 1===U[0]&&0===U[1]&&0===U[2]&&0===U[3]&&0===U[4]&&1===U[5]&&0===U[6]&&0===U[7]&&0===U[8]&&0===U[9]&&1===U[10]&&0===U[11]&&1===U[15]}}}]);
//# sourceMappingURL=1624.e264ca2c.chunk.js.map