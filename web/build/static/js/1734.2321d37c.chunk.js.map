{"version":3,"file":"static/js/1734.2321d37c.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/libs/i3s/enums.js","../node_modules/@arcgis/core/views/3d/layers/i3s/I3SNode.js","../node_modules/@arcgis/core/libs/i3s/I3SModule.js","../node_modules/@arcgis/core/views/3d/layers/SceneLayerWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nvar n,e;!function(n){n[n.None=0]=\"None\",n[n.Int16=1]=\"Int16\",n[n.Int32=2]=\"Int32\"}(n||(n={})),function(n){n[n.Replace=0]=\"Replace\",n[n.Outside=1]=\"Outside\",n[n.Inside=2]=\"Inside\",n[n.Finished=3]=\"Finished\"}(e||(e={}));export{n as IndexType,e as ModificationType};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{fromValues as e}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{f as i}from\"../../../../chunks/sphere.js\";import{invalidateMbs as n}from\"./I3SUtil.js\";import{ElevationRange as t}from\"../../support/ElevationRange.js\";class s extends t{constructor(e,n){super(NaN,NaN),this.id=e,this.serviceMbsInIndexSR=n,this.serviceMbsInRenderSR=i(0,0,0,-1)}invalidateServiceBVsInRenderSR(){n(this.serviceMbsInRenderSR),this.serviceObbInRenderSR?.invalidate()}shareServiceBVsInRenderSRWith(e){this.serviceObbInRenderSR=e.serviceObbInRenderSR,this.serviceMbsInRenderSR=e.serviceMbsInRenderSR}}var o,r,a,d,c;!function(e){e[e.Unmodified=0]=\"Unmodified\",e[e.Culled=1]=\"Culled\",e[e.NotChecked=2]=\"NotChecked\"}(o||(o={})),function(e){e[e.Unmodified=0]=\"Unmodified\",e[e.PotentiallyModified=1]=\"PotentiallyModified\",e[e.Culled=2]=\"Culled\",e[e.Unknown=3]=\"Unknown\",e[e.NotChecked=4]=\"NotChecked\"}(r||(r={}));class h extends s{constructor(i,n,t,s,o,d,c,h,l,u){super(i,t),this.index=n,this.childCount=s,this.level=o,this.resources=d,this.version=c,this.lodMetric=h,this.maxError=l,this.numFeatures=u,this.failed=!1,this.cacheState=a.Unknown,this.vertexCount=0,this.memory=0,this.childrenLoaded=0,this.hasModifications=!1,this.imModificationImpact=r.NotChecked,this.elevationAgnosticBoundingVolume=e(0,0,0,-1)}invalidateServiceBVsInRenderSR(){super.invalidateServiceBVsInRenderSR(),this.elevationAgnosticBoundingVolume[3]=-1}}!function(e){e[e.Unknown=0]=\"Unknown\",e[e.Uncached=1]=\"Uncached\",e[e.Cached=2]=\"Cached\"}(a||(a={})),function(e){e[e.None=0]=\"None\",e[e.MaxScreenThreshold=1]=\"MaxScreenThreshold\",e[e.ScreenSpaceRelative=2]=\"ScreenSpaceRelative\",e[e.RemovedFeatureDiameter=3]=\"RemovedFeatureDiameter\",e[e.DistanceRangeFromDefaultCamera=4]=\"DistanceRangeFromDefaultCamera\"}(d||(d={})),function(e){e[e.Hole=0]=\"Hole\",e[e.Leaf=1]=\"Leaf\"}(c||(c={}));class l{constructor(e,i,n,t){this.nodeHasLOD=e,this.isChosen=i,this.lodLevel=n,this.version=t}}export{a as CacheState,d as LodMetric,h as Node,s as NodeBase,o as NodeFilterImpact,r as NodeIMModificationImpact,c as NodeState,l as NodeTraversalState};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{getAssetUrl as t}from\"../../assets.js\";function e(){return n||(n=new Promise((t=>import(\"../../chunks/i3s.js\").then((t=>t.i)).then((({default:e})=>{const n=e({locateFile:i,onRuntimeInitialized:()=>t(n)});delete n.then})))).catch((t=>{throw t}))),n}function i(e){return t(`esri/libs/i3s/${e}`)}let n;export{e as get};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{hasScaling as e}from\"../../../core/mathUtils.js\";import r from\"../../../geometry/SpatialReference.js\";import{toFloat64Array as t}from\"../../../geometry/support/DoubleArray.js\";import o from\"../../../geometry/support/MeshGeoreferencedVertexSpace.js\";import n from\"../../../geometry/support/MeshLocalVertexSpace.js\";import{t as s,n as i}from\"../../../chunks/vec3.js\";import{IndexType as a}from\"../../../libs/i3s/enums.js\";import{get as f}from\"../../../libs/i3s/I3SModule.js\";import{NodeIMModificationImpact as c}from\"./i3s/I3SNode.js\";async function l(e){w=await x();const r=[e.geometryBuffer];return{result:j(w,e,r),transferList:r}}async function u(e){w=await x();const r=[e.geometryBuffer],{geometryBuffer:t}=e,o=t.byteLength,n=w._malloc(o),s=new Uint8Array(w.HEAPU8.buffer,n,o);s.set(new Uint8Array(t));const i=w.dracoDecompressPointCloudData(n,s.byteLength);if(w._free(n),i.error.length>0)throw new Error(`i3s.wasm: ${i.error}`);const a=i.featureIds?.length>0?i.featureIds.slice():null,f=i.positions.slice();return a&&r.push(a.buffer),r.push(f.buffer),{result:{positions:f,featureIds:a},transferList:r}}async function m(e){await x(),L(e);const r={buffer:e.buffer};return{result:r,transferList:[r.buffer]}}async function y(e){await x(),E(e)}async function p(e){w=await x(),w.setLegacySchema(e.context,e.jsonSchema)}async function d(e){const{localMatrix:s,origin:i,positions:a,vertexSpace:f,localMode:c}=e,l=r.fromJSON(e.inSpatialReference),u=r.fromJSON(e.outSpatialReference);let m;const[{projectBuffer:y},{initializeProjection:p}]=await Promise.all([import(\"../../../geometry/projection/projectBuffer.js\"),import(\"../../../geometry/projection.js\")]);await p(l,u);const d=[0,0,0];if(!y(i,l,0,d,u,0,1))throw new Error(\"Failed to project\");if(\"georeferenced\"===f.type&&null==f.origin){if(m=new Float64Array(a.length),!y(a,l,0,m,u,0,m.length/3))throw new Error(\"Failed to project\")}else{const e=\"georeferenced\"===f.type?o.fromJSON(f):n.fromJSON(f),{project:r}=await import(\"../../../geometry/support/meshUtils/projection.js\"),i=r({positions:a,transform:s?{localMatrix:s}:void 0,vertexSpace:e,inSpatialReference:l,outSpatialReference:u,localMode:c});if(!i)throw new Error(\"Failed to project\");m=t(i)}const b=m.length,[h,g,w]=d;for(let r=0;r<b;r+=3)m[r]-=h,m[r+1]-=g,m[r+2]-=w;return{result:{projected:m,original:a,projectedOrigin:d},transferList:[m.buffer,a.buffer]}}async function b({normalMatrix:r,normals:t}){const o=new Float32Array(t.length);return s(o,t,r),e(r)&&i(o,o),{result:{transformed:o,original:t},transferList:[o.buffer,t.buffer]}}function h(e){I(e)}let g,w;function E(e){if(!w)return;const r=e.modifications,t=w._malloc(8*r.length),o=new Float64Array(w.HEAPU8.buffer,t,r.length);for(let n=0;n<r.length;++n)o[n]=r[n];w.setModifications(e.context,t,r.length,e.isGeodetic),w._free(t)}function j(e,r,t){const{context:o,globalTrafo:n,mbs:s,obbData:i,elevationOffset:f,geometryBuffer:c,geometryDescriptor:l,indexToVertexProjector:u,vertexToRenderProjector:m}=r,y=e._malloc(c.byteLength),p=33,d=e._malloc(p*Float64Array.BYTES_PER_ELEMENT),b=new Uint8Array(e.HEAPU8.buffer,y,c.byteLength);b.set(new Uint8Array(c));const h=new Float64Array(e.HEAPU8.buffer,d,p);S(h,[NaN,NaN,NaN]);let g=h.byteOffset+3*h.BYTES_PER_ELEMENT,w=new Float64Array(h.buffer,g);S(w,n),g+=16*h.BYTES_PER_ELEMENT,w=new Float64Array(h.buffer,g),S(w,s),g+=4*h.BYTES_PER_ELEMENT,i&&(w=new Float64Array(h.buffer,g),S(w,i));const E=l,j={isDraco:!1,isLegacy:!1,color:r.layouts.some((e=>e.some((e=>\"color\"===e.name)))),normal:r.needNormals&&r.layouts.some((e=>e.some((e=>\"normalCompressed\"===e.name)))),uv0:r.layouts.some((e=>e.some((e=>\"uv0\"===e.name)))),uvRegion:r.layouts.some((e=>e.some((e=>\"uvRegion\"===e.name)))),featureIndex:E.featureIndex},A=e.process(o,!!r.obbData,y,b.byteLength,E,j,d,f,u,m,r.normalReferenceFrame);if(e._free(d),e._free(y),A.error.length>0)throw new Error(`i3s.wasm: ${A.error}`);if(A.discarded)return null;const L=A.componentOffsets.length>0?A.componentOffsets.slice():null,I=A.featureIds.length>0?A.featureIds.slice():null,_=A.anchorIds.length>0?Array.from(A.anchorIds):null,x=A.anchors.length>0?Array.from(A.anchors):null,M=A.interleavedVertedData.slice().buffer,N=A.indicesType===a.Int16?new Uint16Array(A.indices.buffer,A.indices.byteOffset,A.indices.byteLength/2).slice():new Uint32Array(A.indices.buffer,A.indices.byteOffset,A.indices.byteLength/4).slice(),P=A.positions.slice(),U=A.positionIndicesType===a.Int16?new Uint16Array(A.positionIndices.buffer,A.positionIndices.byteOffset,A.positionIndices.byteLength/2).slice():new Uint32Array(A.positionIndices.buffer,A.positionIndices.byteOffset,A.positionIndices.byteLength/4).slice(),T={layout:r.layouts[0],interleavedVertexData:M,indices:N,hasColors:A.hasColors,hasModifications:A.hasModifications,positionData:{data:P,indices:U}};return I&&t.push(I.buffer),L&&t.push(L.buffer),t.push(M),t.push(N.buffer),t.push(P.buffer),t.push(U.buffer),{componentOffsets:L,featureIds:I,anchorIds:_,anchors:x,transformedGeometry:T,obb:A.obb,globalTrafo:n}}function A(e){return 0===e?c.Unmodified:1===e?c.PotentiallyModified:2===e?c.Culled:c.Unknown}function L(e){if(!w)return;const{context:r,buffer:t}=e,o=w._malloc(t.byteLength),n=t.byteLength/Float64Array.BYTES_PER_ELEMENT,s=new Float64Array(w.HEAPU8.buffer,o,n),i=new Float64Array(t);s.set(i),w.filterOBBs(r,o,n),i.set(s),w._free(o)}function I(e){w&&0===w.destroy(e)&&(w=null)}function S(e,r){for(let t=0;t<r.length;++t)e[t]=r[t]}async function _(){w||await x()}function x(){return w?Promise.resolve(w):(g||(g=f().then((e=>(w=e,g=null,w)))),g)}const M={transform:(e,r)=>w&&j(w,e,r),destroy:I};export{h as destroyContext,u as dracoDecompressPointCloudData,m as filterObbsForModifications,L as filterObbsForModificationsSync,_ as initialize,A as interpretObbModificationResults,l as process,d as project,p as setLegacySchema,y as setModifications,E as setModificationsSync,M as test,b as transformNormals};\n"],"names":["n","e","None","Int16","Int32","Replace","Outside","Inside","Finished","o","r","a","d","c","s","t","constructor","super","NaN","this","id","serviceMbsInIndexSR","serviceMbsInRenderSR","i","invalidateServiceBVsInRenderSR","serviceObbInRenderSR","invalidate","shareServiceBVsInRenderSRWith","Unmodified","Culled","NotChecked","PotentiallyModified","Unknown","h","l","u","index","childCount","level","resources","version","lodMetric","maxError","numFeatures","failed","cacheState","vertexCount","memory","childrenLoaded","hasModifications","imModificationImpact","elevationAgnosticBoundingVolume","Uncached","Cached","MaxScreenThreshold","ScreenSpaceRelative","RemovedFeatureDiameter","DistanceRangeFromDefaultCamera","Hole","Leaf","nodeHasLOD","isChosen","lodLevel","async","w","x","geometryBuffer","result","j","transferList","byteLength","_malloc","Uint8Array","HEAPU8","buffer","set","dracoDecompressPointCloudData","_free","error","length","Error","featureIds","slice","f","positions","push","m","L","y","E","p","setLegacySchema","context","jsonSchema","localMatrix","origin","vertexSpace","localMode","fromJSON","inSpatialReference","outSpatialReference","projectBuffer","initializeProjection","Promise","all","type","Float64Array","project","transform","b","g","projected","original","projectedOrigin","_ref","normalMatrix","normals","Float32Array","transformed","I","modifications","setModifications","isGeodetic","globalTrafo","mbs","obbData","elevationOffset","geometryDescriptor","indexToVertexProjector","vertexToRenderProjector","BYTES_PER_ELEMENT","S","byteOffset","isDraco","isLegacy","color","layouts","some","name","normal","needNormals","uv0","uvRegion","featureIndex","A","process","normalReferenceFrame","discarded","componentOffsets","_","anchorIds","Array","from","anchors","M","interleavedVertedData","N","indicesType","Uint16Array","indices","Uint32Array","P","U","positionIndicesType","positionIndices","T","layout","interleavedVertexData","hasColors","positionData","data","transformedGeometry","obb","filterOBBs","destroy","resolve","then","default","locateFile","onRuntimeInitialized","catch"],"sourceRoot":""}