{"version":3,"file":"static/js/4881.5cd24346.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/widgets/Editor/Upload.js","../node_modules/@arcgis/core/layers/graphics/sources/support/uploadProgressWeights.js","../node_modules/@arcgis/core/support/progressUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{createTask as o}from\"../../core/asyncUtils.js\";import s from\"../../core/Error.js\";import{on as t}from\"../../core/events.js\";import{throwIfAborted as i,createResolver as l}from\"../../core/promiseUtils.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as n}from\"../../core/accessorSupport/decorators/subclass.js\";import p from\"../../geometry/Point.js\";import{uploadProgressWeights as c}from\"../../layers/graphics/sources/support/uploadProgressWeights.js\";import{getSupportedExtensions as u}from\"../../layers/support/infoFor3D.js\";import{makeProgressManager as d,estimatedTransferTime as m}from\"../../support/progressUtils.js\";let h=class extends r{constructor(){super({}),this.files=[],this.progress=0,this._uploadTask=null,this._layer=null}destroy(){this.cancel(),this.files=[],this._layer=null,this._uploadTask=null}get state(){const e=this._uploadTask;return e&&0!==this.files.length?e.finished?e.error?\"error\":\"success\":\"pending\":\"default\"}get result(){return this._uploadTask?.value??null}get error(){return this._uploadTask?.error??null}uploadTo(e){this.cancel(),this.files=[],this._layer=e,this._uploadTask=o((async r=>{const o=await y(e);i(r),this.progress=0,this.files=o;const t=d(c.upload,(e=>{this.progress=e}),\"Upload.uploadTo\");if(0===o.length)return null;i(r);const l=await e.extractAndFilterFiles(o);i(r),l.length>0&&(this.files=l);const a=new p({x:0,y:0,z:0,spatialReference:e.spatialReference}),n=await e.convertMesh(l,{location:a,signal:r,onProgress:t.makeOnProgress(\"createFromFiles\")});if(i(r),!n)throw new s(\"editor:upload\",\"could not upload or convert model\");const u=l.reduce(((e,r)=>e+r.size),0),h=t.simulate(\"loadMesh\",m(u));try{await n.load()}finally{h.remove()}return n}))}retry(){this._layer&&this.uploadTo(this._layer)}cancel(){this._uploadTask?.abort()}};e([a()],h.prototype,\"files\",void 0),e([a()],h.prototype,\"progress\",void 0),e([a()],h.prototype,\"state\",null),e([a()],h.prototype,\"result\",null),e([a()],h.prototype,\"error\",null),e([a()],h.prototype,\"_uploadTask\",void 0),e([a()],h.prototype,\"_layer\",void 0),h=e([n(\"esri.widgets.Editor.Upload\")],h);let f=null;async function y(e){const{resolve:r,promise:o}=l(),s=document.createElement(\"input\");s.type=\"file\",s.multiple=!1,s.accept=[...u(e.infoFor3D),\".zip\"].join(\",\"),s.style.display=\"none\",document.body.appendChild(s);const i=t(s,\"change\",(()=>r(s.files?Array.from(s.files):[])));return f?f(s):s.click(),o.finally((()=>{i.remove(),s.remove()}))}function g(e){f=r=>{Promise.resolve().then((()=>e)).then((e=>{if(!f)return;const o=new DataTransfer;e.forEach((e=>o.items.add(e))),r.files=o.files,r.dispatchEvent(new Event(\"change\"))}))}}function j(){f=null}export{h as Upload,j as clearPromptForFilesStub,g as stubFilePickerToSelect};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nconst e={upload:{createFromFiles:.8,loadMesh:.2},uploadAssetBlobs:{prepareAssetItems:.9,uploadAssetItems:.1},uploadConvertibleSource:{uploadEditSource:.5,serviceAssetsToGlb:.5},uploadLocalMesh:{meshToAssetBlob:.5,uploadAssetBlobs:.5}};export{e as uploadProgressWeights};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{makeHandle as s}from\"../core/handleUtils.js\";import has from\"../core/has.js\";import{getOrCreateMapValue as t}from\"../core/MapUtils.js\";import{millisecondsFromSeconds as e,Seconds as r,Milliseconds as o}from\"../core/time.js\";function i(s,t=(s=>{}),e){return new n(s,t,e)}class n{constructor(s,t=(s=>{}),e){if(this.onProgress=t,this.taskName=e,this._progressMap=new Map,this._startTime=void 0,this._timingsMap=new Map,\"number\"==typeof s){this._weights={};for(let t=0;t<s;t++){const e=t,r=1/s;this._weights[e]=r,this._progressMap.set(e,0)}}else this._weights=s;this.emitProgress()}emitProgress(){let s=0;for(const[t,e]of this._progressMap.entries()){s+=e*this._weights[t]}if(1===s&&has(\"enable-feature:esri-3dofl-upload-timings\")){const s=Math.round(performance.now()-(this._startTime??0))/1e3;console.log(`${this.taskName} done in ${s} sec`);for(const[t,e]of this._timingsMap){const r=Math.round(e.end-e.start)/1e3,o=Math.round(r/s*100);console.log(this.taskName??\"Task\",{stepKey:t,stepTime:r,relativeTime:o})}}this.onProgress(s)}setProgress(s,e){if(this._progressMap.set(s,e),has(\"enable-feature:esri-3dofl-upload-timings\")){const r=performance.now();this._startTime??=r;const o=t(this._timingsMap,s,(()=>({start:r,end:0})));1===e&&(o.end=r)}this.emitProgress()}simulate(s,t){return a((t=>this.setProgress(s,t)),t)}makeOnProgress(s){return t=>this.setProgress(s,t)}}function a(t=(s=>{}),e=l){const r=performance.now();t(0);const o=setInterval((()=>{const s=performance.now()-r,o=1-Math.exp(-s/e);t(o)}),g);return s((()=>{clearInterval(o),t(1)}))}function h(s,t=c){return e(r(s*f/t))}function m(s,t=p){return e(r(s*f/t))}const c=10,p=10,f=8e-6,g=o(50),l=o(1e3);export{n as ProgressManager,m as estimatedConversionTime,h as estimatedTransferTime,i as makeProgressManager,a as simulateProgress};\n"],"names":["h","r","constructor","super","this","files","progress","_uploadTask","_layer","destroy","cancel","state","e","length","finished","error","result","value","uploadTo","o","async","resolve","promise","l","s","document","createElement","type","multiple","accept","u","infoFor3D","join","style","display","body","appendChild","i","t","Array","from","f","click","finally","remove","y","d","c","upload","extractAndFilterFiles","a","p","x","z","spatialReference","n","convertMesh","location","signal","onProgress","makeOnProgress","reduce","size","simulate","m","load","retry","abort","prototype","createFromFiles","loadMesh","uploadAssetBlobs","prepareAssetItems","uploadAssetItems","uploadConvertibleSource","uploadEditSource","serviceAssetsToGlb","uploadLocalMesh","meshToAssetBlob","arguments","undefined","taskName","_progressMap","Map","_startTime","_timingsMap","_weights","set","emitProgress","entries","has","Math","round","performance","now","console","log","end","start","stepKey","stepTime","relativeTime","setProgress","setInterval","exp","g","clearInterval"],"sourceRoot":""}